<html lang="ru"><head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    
    
    <link rel="shortcut icon" href="/images/5eedfeb39d15b.png" type="image/png">     


    
  
  <title>Политика Конфиденциальности сайта nyamkin.ru	</title>
  <meta name="description" content="Описание Политики Конфиденциальности сайта nyamkin.ru	">
    
  <meta property="og:title" content="Политика Конфиденциальности сайта nyamkin.ru	">
  <meta property="og:description" content="Описание Политики Конфиденциальности сайта nyamkin.ru	">
    <meta property="og:type" content="website">
  <meta property="og:url" content="https://nyamkin.ru/policy">
  <link rel="canonical" href="https://nyamkin.ru/policy">


<meta name="csrf-param" content="_csrf">
    <meta name="csrf-token" content="4UATDtXBXfIq2h8FkcZQZreun2zTnl90RhIxfU3NG_WwIV1Fv_YtoXyoaD2hsGAI1unLGZnWLz4wXmszJJt_gg==">

<link href="/assets/23ff8788/css/bootstrap.css" rel="stylesheet">
<link href="/css/site23.css" rel="stylesheet">
   
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/frontend/web/css/colorbox.css">
    <link rel="stylesheet" href="/frontend/web/css/rte.css">
        <link rel="stylesheet" href="/frontend/web/css/jquery.emojipicker.css">
        <link rel="stylesheet" href="/frontend/web/css/jquery.formstyler.theme.css">
    <link rel="stylesheet" href="/frontend/web/css/jquery.formstyler.css">
    <link rel="stylesheet" href="/frontend/web/css/trumbowyg.min.css">
    <link rel="stylesheet" href="/frontend/web/css/jquery-ui.css">
    <link rel="stylesheet" href="/frontend/web/css/jquery-ui.theme.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/suggestions-jquery@latest/dist/css/suggestions.min.css">
    
    <link rel="stylesheet" href="/frontend/web/css/select2.css">
    
    <link rel="stylesheet" href="/frontend/web/css/imgareaselect-default.css">
    <!-- <link rel="stylesheet" href="/frontend/web/css/imgareaselect-deprecated.css" /> -->
    <!-- <link rel="stylesheet" href="/frontend/web/css/imgareaselect-animated.css" /> -->
    

<link href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i&amp;subset=cyrillic-ext&amp;display=swap" rel="stylesheet">  
<script type="text/javascript" async="" id="topmailru-code" src="https://top-fwz1.mail.ru/js/code.js"></script><script type="text/javascript" async="" src="https://www.gstatic.com/recaptcha/releases/tNAc29ZZrpcOCErva2nr4BS9/recaptcha__en.js" crossorigin="anonymous" integrity="sha384-VQkqyzWECBbjdnrmLsMeQdf0TTXr6rfxgJXnIIszVBecGcFa03Tl4VBO4n2inOOm"></script><script type="text/javascript" async="" src="https://st.top100.ru/top100/3.13.8/usability.js"></script><script type="text/javascript" async="" src="https://st.top100.ru/top100/top100.js"></script><script async="" src="https://mc.yandex.ru/metrika/tag.js"></script><script>

  var editable_avatar;
  
  function get_dimensions(el) {
    // Браузер с поддержкой naturalWidth/naturalHeight
    if (el.naturalWidth!=undefined) {
        return { 'real_width':el.naturalWidth,
                 'real_height':el.naturalHeight,
                 'client_width':el.width,
                 'client_height':el.height };
    }
    // Устаревший браузер
    else if (el.tagName.toLowerCase()=='img') {
        var img=new Image();
        img.src=el.src;
        var real_w=img.width;
        var real_h=img.height;
        return { 'real_width':real_w,
                 'real_height':real_h,
                 'client_width':el.width,
                 'client_height':el.height };
    }
    // Что-то непонятное
    else {
        return false;
    }
  } 

</script> 

<!-- Quantcast Choice. Consent Manager Tag v2.0 (for TCF 2.0) -->
<!--
<script type="text/javascript" async="true">
(function() {
    var host = 'www.themoneytizer.com';
    var element = document.createElement('script');
    var firstScript = document.getElementsByTagName('script')[0];
    var url = 'https://quantcast.mgr.consensu.org'
        .concat('/choice/', '6Fv0cGNfc_bw8', '/', host, '/choice.js');
    var uspTries = 0;
    var uspTriesLimit = 3;
    element.async = true;
    element.type = 'text/javascript';
    element.src = url;

    firstScript.parentNode.insertBefore(element, firstScript);

    function makeStub() {
        var TCF_LOCATOR_NAME = '__tcfapiLocator';
        var queue = [];
        var win = window;
        var cmpFrame;

        function addFrame() {
            var doc = win.document;
            var otherCMP = !!(win.frames[TCF_LOCATOR_NAME]);

            if (!otherCMP) {
                if (doc.body) {
                    var iframe = doc.createElement('iframe');

                    iframe.style.cssText = 'display:none';
                    iframe.name = TCF_LOCATOR_NAME;
                    doc.body.appendChild(iframe);
                } else {
                    setTimeout(addFrame, 5);
                }
            }
            return !otherCMP;
        }

        function tcfAPIHandler() {
            var gdprApplies;
            var args = arguments;

            if (!args.length) {
                return queue;
            } else if (args[0] === 'setGdprApplies') {
                if (
                    args.length > 3 &&
                    args[2] === 2 &&
                    typeof args[3] === 'boolean'
                ) {
                    gdprApplies = args[3];
                    if (typeof args[2] === 'function') {
                        args[2]('set', true);
                    }
                }
            } else if (args[0] === 'ping') {
                var retr = {
                    gdprApplies: gdprApplies,
                    cmpLoaded: false,
                    cmpStatus: 'stub'
                };

                if (typeof args[2] === 'function') {
                    args[2](retr);
                }
            } else {
                queue.push(args);
            }
        }

        function postMessageEventHandler(event) {
            var msgIsString = typeof event.data === 'string';
            var json = {};

            try {
                if (msgIsString) {
                    json = JSON.parse(event.data);
                } else {
                    json = event.data;
                }
            } catch (ignore) {}

            var payload = json.__tcfapiCall;

            if (payload) {
                window.__tcfapi(
                    payload.command,
                    payload.version,
                    function(retValue, success) {
                        var returnMsg = {
                            __tcfapiReturn: {
                                returnValue: retValue,
                                success: success,
                                callId: payload.callId
                            }
                        };
                        if (msgIsString) {
                            returnMsg = JSON.stringify(returnMsg);
                        }
                        event.source.postMessage(returnMsg, '*');
                    },
                    payload.parameter
                );
            }
        }

        while (win) {
            try {
                if (win.frames[TCF_LOCATOR_NAME]) {
                    cmpFrame = win;
                    break;
                }
            } catch (ignore) {}

            if (win === window.top) {
                break;
            }
            win = win.parent;
        }
        if (!cmpFrame) {
            addFrame();
            win.__tcfapi = tcfAPIHandler;
            win.addEventListener('message', postMessageEventHandler, false);
        }
    };

    if (typeof module !== 'undefined') {
        module.exports = makeStub;
    } else {
        makeStub();
    }

    var uspStubFunction = function() {
        var arg = arguments;
        if (typeof window.__uspapi !== uspStubFunction) {
            setTimeout(function() {
                if (typeof window.__uspapi !== 'undefined') {
                    window.__uspapi.apply(window.__uspapi, arg);
                }
            }, 500);
        }
    };

    var checkIfUspIsReady = function() {
        uspTries++;
        if (window.__uspapi === uspStubFunction && uspTries < uspTriesLimit) {
            console.warn('USP is not accessible');
        } else {
            clearInterval(uspInterval);
        }
    };

    if (typeof window.__uspapi === 'undefined') {
        window.__uspapi = uspStubFunction;
        var uspInterval = setInterval(checkIfUspIsReady, 6000);
    }
})();
</script> -->
<!-- End Quantcast Choice. Consent Manager Tag v2.0 (for TCF 2.0) -->


<!-- Yandex.RTB -->
<script>window.yaContextCb=window.yaContextCb||[]</script>
<script src="https://yandex.ru/ads/system/context.js" async=""></script>


<style type="text/css">.ck.ck-placeholder:before,.ck .ck-placeholder:before{content:attr(data-placeholder);pointer-events:none;cursor:text;color:var(--ck-color-engine-placeholder-text)}.ck-hidden{display:none!important}.ck.ck-reset,.ck.ck-reset_all,.ck.ck-reset_all *{box-sizing:border-box;width:auto;height:auto;position:static}:root{--ck-z-default:1;--ck-z-modal:calc(var(--ck-z-default) + 999);--ck-color-base-foreground:#fafafa;--ck-color-base-background:#fff;--ck-color-base-border:#c4c4c4;--ck-color-base-action:#61b045;--ck-color-base-focus:#6cb5f9;--ck-color-base-text:#333;--ck-color-base-active:#198cf0;--ck-color-base-active-focus:#0e7fe1;--ck-color-base-error:#db3700;--ck-color-focus-border:#47a4f5;--ck-color-focus-shadow:rgba(119,186,248,0.5);--ck-color-focus-disabled-shadow:rgba(119,186,248,0.3);--ck-color-focus-error-shadow:rgba(255,64,31,0.3);--ck-color-text:var(--ck-color-base-text);--ck-color-shadow-drop:rgba(0,0,0,0.15);--ck-color-shadow-drop-active:rgba(0,0,0,0.2);--ck-color-shadow-inner:rgba(0,0,0,0.1);--ck-color-button-default-background:transparent;--ck-color-button-default-hover-background:#e6e6e6;--ck-color-button-default-active-background:#d9d9d9;--ck-color-button-default-active-shadow:#bfbfbf;--ck-color-button-default-disabled-background:transparent;--ck-color-button-on-background:#dedede;--ck-color-button-on-hover-background:#c4c4c4;--ck-color-button-on-active-background:#bababa;--ck-color-button-on-active-shadow:#a1a1a1;--ck-color-button-on-disabled-background:#dedede;--ck-color-button-action-background:var(--ck-color-base-action);--ck-color-button-action-hover-background:#579e3d;--ck-color-button-action-active-background:#53973b;--ck-color-button-action-active-shadow:#498433;--ck-color-button-action-disabled-background:#7ec365;--ck-color-button-action-text:var(--ck-color-base-background);--ck-color-button-save:#008a00;--ck-color-button-cancel:#db3700;--ck-color-switch-button-off-background:#b0b0b0;--ck-color-switch-button-off-hover-background:#a3a3a3;--ck-color-switch-button-on-background:var(--ck-color-button-action-background);--ck-color-switch-button-on-hover-background:#579e3d;--ck-color-switch-button-inner-background:var(--ck-color-base-background);--ck-color-switch-button-inner-shadow:rgba(0,0,0,0.1);--ck-color-dropdown-panel-background:var(--ck-color-base-background);--ck-color-dropdown-panel-border:var(--ck-color-base-border);--ck-color-input-background:var(--ck-color-base-background);--ck-color-input-border:#c7c7c7;--ck-color-input-error-border:var(--ck-color-base-error);--ck-color-input-text:var(--ck-color-base-text);--ck-color-input-disabled-background:#f2f2f2;--ck-color-input-disabled-border:#c7c7c7;--ck-color-input-disabled-text:#5c5c5c;--ck-color-list-background:var(--ck-color-base-background);--ck-color-list-button-hover-background:var(--ck-color-button-default-hover-background);--ck-color-list-button-on-background:var(--ck-color-base-active);--ck-color-list-button-on-background-focus:var(--ck-color-base-active-focus);--ck-color-list-button-on-text:var(--ck-color-base-background);--ck-color-panel-background:var(--ck-color-base-background);--ck-color-panel-border:var(--ck-color-base-border);--ck-color-toolbar-background:var(--ck-color-base-foreground);--ck-color-toolbar-border:var(--ck-color-base-border);--ck-color-tooltip-background:var(--ck-color-base-text);--ck-color-tooltip-text:var(--ck-color-base-background);--ck-color-engine-placeholder-text:#707070;--ck-color-upload-bar-background:#6cb5f9;--ck-color-upload-infinite-background:rgba(0,0,0,0.1);--ck-color-link-default:#0000f0;--ck-color-link-selected-background:rgba(31,177,255,0.1);--ck-disabled-opacity:.5;--ck-focus-outer-shadow-geometry:0 0 0 3px;--ck-focus-outer-shadow:var(--ck-focus-outer-shadow-geometry) var(--ck-color-focus-shadow);--ck-focus-disabled-outer-shadow:var(--ck-focus-outer-shadow-geometry) var(--ck-color-focus-disabled-shadow);--ck-focus-error-outer-shadow:var(--ck-focus-outer-shadow-geometry) var(--ck-color-focus-error-shadow);--ck-focus-ring:1px solid var(--ck-color-focus-border);--ck-font-size-base:13px;--ck-line-height-base:1.84615;--ck-font-face:Helvetica,Arial,Tahoma,Verdana,Sans-Serif;--ck-font-size-tiny:0.7em;--ck-font-size-small:0.75em;--ck-font-size-normal:1em;--ck-font-size-big:1.4em;--ck-font-size-large:1.8em;--ck-ui-component-min-height:2.3em}.ck.ck-reset,.ck.ck-reset_all,.ck.ck-reset_all *{margin:0;padding:0;border:0;background:transparent;text-decoration:none;vertical-align:middle;transition:none;word-wrap:break-word}.ck.ck-reset_all,.ck.ck-reset_all *{border-collapse:collapse;font:normal normal normal var(--ck-font-size-base)/var(--ck-line-height-base) var(--ck-font-face);color:var(--ck-color-text);text-align:left;white-space:nowrap;cursor:auto;float:none}.ck.ck-reset_all .ck-rtl *{text-align:right}.ck.ck-reset_all iframe{vertical-align:inherit}.ck.ck-reset_all textarea{white-space:pre-wrap}.ck.ck-reset_all input[type=password],.ck.ck-reset_all input[type=text],.ck.ck-reset_all textarea{cursor:text}.ck.ck-reset_all input[type=password][disabled],.ck.ck-reset_all input[type=text][disabled],.ck.ck-reset_all textarea[disabled]{cursor:default}.ck.ck-reset_all fieldset{padding:10px;border:2px groove #dfdee3}.ck.ck-reset_all button::-moz-focus-inner{padding:0;border:0}:root{--ck-border-radius:2px;--ck-inner-shadow:2px 2px 3px var(--ck-color-shadow-inner) inset;--ck-drop-shadow:0 1px 2px 1px var(--ck-color-shadow-drop);--ck-drop-shadow-active:0 3px 6px 1px var(--ck-color-shadow-drop-active);--ck-spacing-unit:0.6em;--ck-spacing-large:calc(var(--ck-spacing-unit)*1.5);--ck-spacing-standard:var(--ck-spacing-unit);--ck-spacing-medium:calc(var(--ck-spacing-unit)*0.8);--ck-spacing-small:calc(var(--ck-spacing-unit)*0.5);--ck-spacing-tiny:calc(var(--ck-spacing-unit)*0.3);--ck-spacing-extra-tiny:calc(var(--ck-spacing-unit)*0.16)}.ck.ck-editor__editable:not(.ck-editor__nested-editable){border-radius:0}.ck-rounded-corners .ck.ck-editor__editable:not(.ck-editor__nested-editable),.ck.ck-editor__editable:not(.ck-editor__nested-editable).ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-editor__editable:not(.ck-editor__nested-editable).ck-focused{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-inner-shadow),0 0}.ck.ck-editor__editable_inline{overflow:auto;padding:0 var(--ck-spacing-standard);border:1px solid transparent}.ck.ck-editor__editable_inline>:first-child{margin-top:var(--ck-spacing-large)}.ck.ck-editor__editable_inline>:last-child{margin-bottom:var(--ck-spacing-large)}.ck.ck-balloon-panel.ck-toolbar-container[class*=arrow_n]:after{border-bottom-color:var(--ck-color-base-foreground)}.ck.ck-balloon-panel.ck-toolbar-container[class*=arrow_s]:after{border-top-color:var(--ck-color-base-foreground)}.ck.ck-label{display:block}.ck.ck-voice-label{display:none}.ck.ck-label{font-weight:700}.ck.ck-sticky-panel .ck-sticky-panel__content_sticky{z-index:var(--ck-z-modal);position:fixed;top:0}.ck.ck-sticky-panel .ck-sticky-panel__content_sticky_bottom-limit{top:auto;position:absolute}.ck.ck-sticky-panel .ck-sticky-panel__content_sticky{box-shadow:var(--ck-drop-shadow),0 0;border-width:0 1px 1px;border-top-left-radius:0;border-top-right-radius:0}.ck.ck-toolbar{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;display:flex;flex-flow:row wrap;align-items:center}.ck.ck-toolbar.ck-toolbar_vertical{flex-direction:column}.ck.ck-toolbar.ck-toolbar_floating{flex-wrap:nowrap}.ck.ck-toolbar__separator{display:inline-block}.ck.ck-toolbar__newline{display:block;width:100%}.ck.ck-toolbar{border-radius:0}.ck-rounded-corners .ck.ck-toolbar,.ck.ck-toolbar.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-toolbar{background:var(--ck-color-toolbar-background);padding:0 var(--ck-spacing-small);border:1px solid var(--ck-color-toolbar-border)}.ck.ck-toolbar>*{margin-right:var(--ck-spacing-small);margin-top:var(--ck-spacing-small);margin-bottom:var(--ck-spacing-small)}.ck.ck-toolbar.ck-toolbar_vertical{padding:0}.ck.ck-toolbar.ck-toolbar_vertical>.ck{width:100%;margin:0;border-radius:0;border:0}.ck.ck-toolbar>:last-child{margin-right:0}.ck-toolbar-container .ck.ck-toolbar{border:0}.ck.ck-toolbar__separator{align-self:stretch;width:1px;margin-top:0;margin-bottom:0;background:var(--ck-color-toolbar-border)}.ck.ck-toolbar__newline{margin:0}.ck.ck-editor{position:relative}.ck.ck-editor .ck-editor__top .ck-sticky-panel .ck-toolbar{z-index:var(--ck-z-modal)}.ck.ck-editor__top .ck-sticky-panel .ck-toolbar{border-radius:0}.ck-rounded-corners .ck.ck-editor__top .ck-sticky-panel .ck-toolbar,.ck.ck-editor__top .ck-sticky-panel .ck-toolbar.ck-rounded-corners{border-radius:var(--ck-border-radius);border-bottom-left-radius:0;border-bottom-right-radius:0}.ck.ck-editor__top .ck-sticky-panel .ck-toolbar{border-bottom-width:0}.ck.ck-editor__top .ck-sticky-panel .ck-sticky-panel__content_sticky .ck-toolbar{border-bottom-width:1px;border-radius:0}.ck-rounded-corners .ck.ck-editor__top .ck-sticky-panel .ck-sticky-panel__content_sticky .ck-toolbar,.ck.ck-editor__top .ck-sticky-panel .ck-sticky-panel__content_sticky .ck-toolbar.ck-rounded-corners{border-radius:var(--ck-border-radius);border-radius:0}.ck.ck-editor__main>.ck-editor__editable{background:var(--ck-color-base-background);border-radius:0}.ck-rounded-corners .ck.ck-editor__main>.ck-editor__editable,.ck.ck-editor__main>.ck-editor__editable.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0;border-top-right-radius:0}.ck.ck-editor__main>.ck-editor__editable:not(.ck-focused){border-color:var(--ck-color-base-border)}.ck.ck-icon{vertical-align:middle}:root{--ck-icon-size:calc(var(--ck-line-height-base)*var(--ck-font-size-normal))}.ck.ck-icon{width:var(--ck-icon-size);height:var(--ck-icon-size);font-size:.8333350694em;will-change:transform}.ck.ck-icon,.ck.ck-icon *{color:inherit;cursor:inherit}.ck.ck-icon :not([fill]){fill:currentColor}.ck.ck-tooltip,.ck.ck-tooltip .ck-tooltip__text:after{position:absolute;pointer-events:none;-webkit-backface-visibility:hidden}.ck-tooltip{visibility:hidden;opacity:0;display:none;z-index:var(--ck-z-modal)}.ck-tooltip .ck-tooltip__text{display:inline-block}.ck-tooltip .ck-tooltip__text:after{content:"";width:0;height:0}:root{--ck-tooltip-arrow-size:5px}.ck.ck-tooltip{left:50%;top:0}.ck.ck-tooltip.ck-tooltip_s{bottom:calc(-1*var(--ck-tooltip-arrow-size));transform:translateY(100%)}.ck.ck-tooltip.ck-tooltip_s .ck-tooltip__text:after{top:calc(-1*var(--ck-tooltip-arrow-size));transform:translateX(-50%);border-left-color:transparent;border-bottom-color:var(--ck-color-tooltip-background);border-right-color:transparent;border-top-color:transparent;border-left-width:var(--ck-tooltip-arrow-size);border-bottom-width:var(--ck-tooltip-arrow-size);border-right-width:var(--ck-tooltip-arrow-size);border-top-width:0}.ck.ck-tooltip.ck-tooltip_n{top:calc(-1*var(--ck-tooltip-arrow-size));transform:translateY(-100%)}.ck.ck-tooltip.ck-tooltip_n .ck-tooltip__text:after{bottom:calc(-1*var(--ck-tooltip-arrow-size));transform:translateX(-50%);border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent;border-top-color:var(--ck-color-tooltip-background);border-left-width:var(--ck-tooltip-arrow-size);border-bottom-width:0;border-right-width:var(--ck-tooltip-arrow-size);border-top-width:var(--ck-tooltip-arrow-size)}.ck.ck-tooltip .ck-tooltip__text{border-radius:0}.ck-rounded-corners .ck.ck-tooltip .ck-tooltip__text,.ck.ck-tooltip .ck-tooltip__text.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-tooltip .ck-tooltip__text{font-size:.9em;line-height:1.5;color:var(--ck-color-tooltip-text);padding:var(--ck-spacing-small) var(--ck-spacing-medium);background:var(--ck-color-tooltip-background);position:relative;left:-50%}.ck.ck-tooltip .ck-tooltip__text:after{border-style:solid;left:50%}.ck.ck-tooltip,.ck.ck-tooltip .ck-tooltip__text:after{transition:opacity .2s ease-in-out .2s}.ck.ck-button,a.ck.ck-button{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.ck.ck-button .ck-tooltip,a.ck.ck-button .ck-tooltip{display:block}@media (hover:none){.ck.ck-button .ck-tooltip,a.ck.ck-button .ck-tooltip{display:none}}.ck.ck-button,a.ck.ck-button{position:relative;display:inline-flex;align-items:center;justify-content:left}.ck.ck-button.ck-button_with-text .ck-button__label,a.ck.ck-button.ck-button_with-text .ck-button__label{display:inline-block}.ck.ck-button:not(.ck-button_with-text),a.ck.ck-button:not(.ck-button_with-text){justify-content:center}.ck.ck-button:hover .ck-tooltip,a.ck.ck-button:hover .ck-tooltip{visibility:visible;opacity:1}.ck.ck-button .ck-button__label,.ck.ck-button:focus:not(:hover) .ck-tooltip,a.ck.ck-button .ck-button__label,a.ck.ck-button:focus:not(:hover) .ck-tooltip{display:none}.ck.ck-button,a.ck.ck-button{background:var(--ck-color-button-default-background)}.ck.ck-button:not(.ck-disabled):hover,a.ck.ck-button:not(.ck-disabled):hover{background:var(--ck-color-button-default-hover-background)}.ck.ck-button:not(.ck-disabled):active,a.ck.ck-button:not(.ck-disabled):active{background:var(--ck-color-button-default-active-background);box-shadow:inset 0 2px 2px var(--ck-color-button-default-active-shadow)}.ck.ck-button.ck-disabled,a.ck.ck-button.ck-disabled{background:var(--ck-color-button-default-disabled-background)}.ck.ck-button,a.ck.ck-button{border-radius:0}.ck-rounded-corners .ck.ck-button,.ck-rounded-corners a.ck.ck-button,.ck.ck-button.ck-rounded-corners,a.ck.ck-button.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-button,a.ck.ck-button{white-space:nowrap;cursor:default;vertical-align:middle;padding:var(--ck-spacing-tiny);text-align:center;min-width:var(--ck-ui-component-min-height);min-height:var(--ck-ui-component-min-height);line-height:1;font-size:inherit;border:1px solid transparent;transition:box-shadow .2s ease-in-out;-webkit-appearance:none}.ck.ck-button:active,.ck.ck-button:focus,a.ck.ck-button:active,a.ck.ck-button:focus{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-focus-outer-shadow),0 0;border-color:transparent}.ck.ck-button.ck-disabled:active,.ck.ck-button.ck-disabled:focus,a.ck.ck-button.ck-disabled:active,a.ck.ck-button.ck-disabled:focus{box-shadow:var(--ck-focus-disabled-outer-shadow),0 0}.ck.ck-button.ck-disabled .ck-button__icon,a.ck.ck-button.ck-disabled .ck-button__icon{opacity:var(--ck-disabled-opacity)}.ck.ck-button.ck-disabled .ck-button__label,a.ck.ck-button.ck-disabled .ck-button__label{opacity:var(--ck-disabled-opacity)}.ck.ck-button.ck-button_with-text,a.ck.ck-button.ck-button_with-text{padding:var(--ck-spacing-tiny) var(--ck-spacing-standard)}.ck.ck-button.ck-button_with-text .ck-button__icon,a.ck.ck-button.ck-button_with-text .ck-button__icon{margin-left:calc(-1*var(--ck-spacing-small));margin-right:var(--ck-spacing-small)}.ck.ck-button.ck-on,a.ck.ck-button.ck-on{background:var(--ck-color-button-on-background)}.ck.ck-button.ck-on:not(.ck-disabled):hover,a.ck.ck-button.ck-on:not(.ck-disabled):hover{background:var(--ck-color-button-on-hover-background)}.ck.ck-button.ck-on:not(.ck-disabled):active,a.ck.ck-button.ck-on:not(.ck-disabled):active{background:var(--ck-color-button-on-active-background);box-shadow:inset 0 2px 2px var(--ck-color-button-on-active-shadow)}.ck.ck-button.ck-on.ck-disabled,a.ck.ck-button.ck-on.ck-disabled{background:var(--ck-color-button-on-disabled-background)}.ck.ck-button.ck-button-save,a.ck.ck-button.ck-button-save{color:var(--ck-color-button-save)}.ck.ck-button.ck-button-cancel,a.ck.ck-button.ck-button-cancel{color:var(--ck-color-button-cancel)}.ck.ck-button .ck-button__icon use,.ck.ck-button .ck-button__icon use *,a.ck.ck-button .ck-button__icon use,a.ck.ck-button .ck-button__icon use *{color:inherit}.ck.ck-button .ck-button__label,a.ck.ck-button .ck-button__label{font-size:inherit;font-weight:inherit;color:inherit;cursor:inherit;vertical-align:middle}.ck.ck-button-action,a.ck.ck-button-action{background:var(--ck-color-button-action-background)}.ck.ck-button-action:not(.ck-disabled):hover,a.ck.ck-button-action:not(.ck-disabled):hover{background:var(--ck-color-button-action-hover-background)}.ck.ck-button-action:not(.ck-disabled):active,a.ck.ck-button-action:not(.ck-disabled):active{background:var(--ck-color-button-action-active-background);box-shadow:inset 0 2px 2px var(--ck-color-button-action-active-shadow)}.ck.ck-button-action.ck-disabled,a.ck.ck-button-action.ck-disabled{background:var(--ck-color-button-action-disabled-background)}.ck.ck-button-action,a.ck.ck-button-action{color:var(--ck-color-button-action-text)}.ck.ck-button-bold,a.ck.ck-button-bold{font-weight:700}.ck-content blockquote{overflow:hidden;padding-right:1.5em;padding-left:1.5em;margin-left:0;font-style:italic;border-left:5px solid #ccc}.ck .ck-widget.ck-widget_with-selection-handler{position:relative}.ck .ck-widget.ck-widget_with-selection-handler .ck-widget__selection-handler{visibility:hidden;position:absolute}.ck .ck-widget.ck-widget_with-selection-handler .ck-widget__selection-handler .ck-icon{display:block}.ck .ck-widget.ck-widget_with-selection-handler.ck-widget_selected .ck-widget__selection-handler,.ck .ck-widget.ck-widget_with-selection-handler:hover .ck-widget__selection-handler{visibility:visible}:root{--ck-widget-outline-thickness:3px;--ck-widget-handler-icon-size:16px;--ck-widget-handler-animation-duration:200ms;--ck-widget-handler-animation-curve:ease;--ck-color-widget-blurred-border:#dedede;--ck-color-widget-hover-border:#ffc83d;--ck-color-widget-editable-focus-background:var(--ck-color-base-background);--ck-color-widget-drag-handler-icon-color:var(--ck-color-base-background)}.ck .ck-widget{outline-width:var(--ck-widget-outline-thickness);outline-style:solid;outline-color:transparent;transition:outline-color var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve)}.ck .ck-widget.ck-widget_selected,.ck .ck-widget.ck-widget_selected:hover{outline:var(--ck-widget-outline-thickness) solid var(--ck-color-focus-border)}.ck .ck-widget:hover{outline-color:var(--ck-color-widget-hover-border)}.ck .ck-editor__nested-editable{border:1px solid transparent}.ck .ck-editor__nested-editable.ck-editor__nested-editable_focused,.ck .ck-editor__nested-editable:focus{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-inner-shadow),0 0;background-color:var(--ck-color-widget-editable-focus-background)}.ck-editor__editable>.ck-widget.ck-widget_with-selection-handler:first-child,.ck-editor__editable blockquote>.ck-widget.ck-widget_with-selection-handler:first-child{margin-top:calc(1em + var(--ck-widget-handler-icon-size))}.ck .ck-widget.ck-widget_with-selection-handler .ck-widget__selection-handler{padding:4px;box-sizing:border-box;background-color:transparent;opacity:0;transition:background-color var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve),visibility var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve),opacity var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve);border-radius:var(--ck-border-radius) var(--ck-border-radius) 0 0;transform:translateY(-100%);left:calc(0px - var(--ck-widget-outline-thickness))}.ck .ck-widget.ck-widget_with-selection-handler .ck-widget__selection-handler:hover .ck-icon .ck-icon__selected-indicator{opacity:1}.ck .ck-widget.ck-widget_with-selection-handler .ck-widget__selection-handler .ck-icon{width:var(--ck-widget-handler-icon-size);height:var(--ck-widget-handler-icon-size);color:var(--ck-color-widget-drag-handler-icon-color)}.ck .ck-widget.ck-widget_with-selection-handler .ck-widget__selection-handler .ck-icon .ck-icon__selected-indicator{opacity:0;transition:opacity .3s var(--ck-widget-handler-animation-curve)}.ck .ck-widget.ck-widget_with-selection-handler.ck-widget_selected .ck-widget__selection-handler,.ck .ck-widget.ck-widget_with-selection-handler.ck-widget_selected:hover .ck-widget__selection-handler{opacity:1;background-color:var(--ck-color-focus-border)}.ck .ck-widget.ck-widget_with-selection-handler.ck-widget_selected .ck-widget__selection-handler .ck-icon .ck-icon__selected-indicator,.ck .ck-widget.ck-widget_with-selection-handler.ck-widget_selected:hover .ck-widget__selection-handler .ck-icon .ck-icon__selected-indicator{opacity:1}.ck .ck-widget.ck-widget_with-selection-handler:hover .ck-widget__selection-handler{opacity:1;background-color:var(--ck-color-widget-hover-border)}.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected,.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected:hover{outline-color:var(--ck-color-widget-blurred-border)}.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected .ck-widget__selection-handler,.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected .ck-widget__selection-handler:hover,.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected:hover .ck-widget__selection-handler,.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected:hover .ck-widget__selection-handler:hover{background:var(--ck-color-widget-blurred-border)}.ck-editor__editable.ck-read-only .ck-widget{--ck-widget-outline-thickness:0}.ck.ck-labeled-input .ck-labeled-input__status{font-size:var(--ck-font-size-small);margin-top:var(--ck-spacing-small);white-space:normal}.ck.ck-labeled-input .ck-labeled-input__status_error{color:var(--ck-color-base-error)}:root{--ck-input-text-width:18em}.ck.ck-input-text{border-radius:0}.ck-rounded-corners .ck.ck-input-text,.ck.ck-input-text.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-input-text{box-shadow:var(--ck-inner-shadow),0 0;background:var(--ck-color-input-background);border:1px solid var(--ck-color-input-border);padding:var(--ck-spacing-extra-tiny) var(--ck-spacing-medium);min-width:var(--ck-input-text-width);min-height:var(--ck-ui-component-min-height);transition-property:box-shadow,border;transition:.2s ease-in-out}.ck.ck-input-text:focus{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-focus-outer-shadow),var(--ck-inner-shadow)}.ck.ck-input-text[readonly]{border:1px solid var(--ck-color-input-disabled-border);background:var(--ck-color-input-disabled-background);color:var(--ck-color-input-disabled-text)}.ck.ck-input-text[readonly]:focus{box-shadow:var(--ck-focus-disabled-outer-shadow),var(--ck-inner-shadow)}.ck.ck-input-text.ck-error{border-color:var(--ck-color-input-error-border);animation:ck-text-input-shake .3s ease both}.ck.ck-input-text.ck-error:focus{box-shadow:var(--ck-focus-error-outer-shadow),var(--ck-inner-shadow)}@keyframes ck-text-input-shake{20%{transform:translateX(-2px)}40%{transform:translateX(2px)}60%{transform:translateX(-1px)}80%{transform:translateX(1px)}}.ck.ck-text-alternative-form{display:flex;flex-direction:row;flex-wrap:nowrap}.ck.ck-text-alternative-form .ck-labeled-input{display:inline-block}.ck.ck-text-alternative-form .ck-label{display:none}@media screen and (max-width:600px){.ck.ck-text-alternative-form{flex-wrap:wrap}.ck.ck-text-alternative-form .ck-labeled-input{flex-basis:100%}.ck.ck-text-alternative-form .ck-button{flex-basis:50%}}.ck.ck-text-alternative-form{padding:var(--ck-spacing-standard)}.ck.ck-text-alternative-form:focus{outline:none}.ck.ck-text-alternative-form>:not(:first-child){margin-left:var(--ck-spacing-standard)}@media screen and (max-width:600px){.ck.ck-text-alternative-form{padding:0;width:calc(0.8*var(--ck-input-text-width))}.ck.ck-text-alternative-form .ck-labeled-input{margin:var(--ck-spacing-standard) var(--ck-spacing-standard) 0}.ck.ck-text-alternative-form .ck-labeled-input .ck-input-text{min-width:0;width:100%}.ck.ck-text-alternative-form .ck-button{padding:var(--ck-spacing-standard);margin-top:var(--ck-spacing-standard);margin-left:0;border-radius:0;border:0;border-top:1px solid var(--ck-color-base-border)}.ck.ck-text-alternative-form .ck-button:first-of-type{border-right:1px solid var(--ck-color-base-border)}}:root{--ck-balloon-panel-arrow-z-index:calc(var(--ck-z-default) - 3)}.ck.ck-balloon-panel{display:none;position:absolute;z-index:var(--ck-z-modal)}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:after,.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:before{content:"";position:absolute}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:before{z-index:var(--ck-balloon-panel-arrow-z-index)}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:after{z-index:calc(var(--ck-balloon-panel-arrow-z-index) + 1)}.ck.ck-balloon-panel[class*=arrow_n]:before{z-index:var(--ck-balloon-panel-arrow-z-index)}.ck.ck-balloon-panel[class*=arrow_n]:after{z-index:calc(var(--ck-balloon-panel-arrow-z-index) + 1)}.ck.ck-balloon-panel[class*=arrow_s]:before{z-index:var(--ck-balloon-panel-arrow-z-index)}.ck.ck-balloon-panel[class*=arrow_s]:after{z-index:calc(var(--ck-balloon-panel-arrow-z-index) + 1)}.ck.ck-balloon-panel.ck-balloon-panel_visible{display:block}:root{--ck-balloon-arrow-offset:2px;--ck-balloon-arrow-height:10px;--ck-balloon-arrow-half-width:8px}.ck.ck-balloon-panel{border-radius:0}.ck-rounded-corners .ck.ck-balloon-panel,.ck.ck-balloon-panel.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-balloon-panel{box-shadow:var(--ck-drop-shadow),0 0;min-height:15px;background:var(--ck-color-panel-background);border:1px solid var(--ck-color-panel-border)}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:after,.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:before{width:0;height:0;border-style:solid}.ck.ck-balloon-panel[class*=arrow_n]:after,.ck.ck-balloon-panel[class*=arrow_n]:before{border-left-width:var(--ck-balloon-arrow-half-width);border-bottom-width:var(--ck-balloon-arrow-height);border-right-width:var(--ck-balloon-arrow-half-width);border-top-width:0}.ck.ck-balloon-panel[class*=arrow_n]:before{border-bottom-color:var(--ck-color-panel-border)}.ck.ck-balloon-panel[class*=arrow_n]:after,.ck.ck-balloon-panel[class*=arrow_n]:before{border-left-color:transparent;border-right-color:transparent;border-top-color:transparent}.ck.ck-balloon-panel[class*=arrow_n]:after{border-bottom-color:var(--ck-color-panel-background);margin-top:var(--ck-balloon-arrow-offset)}.ck.ck-balloon-panel[class*=arrow_s]:after,.ck.ck-balloon-panel[class*=arrow_s]:before{border-left-width:var(--ck-balloon-arrow-half-width);border-bottom-width:0;border-right-width:var(--ck-balloon-arrow-half-width);border-top-width:var(--ck-balloon-arrow-height)}.ck.ck-balloon-panel[class*=arrow_s]:before{border-top-color:var(--ck-color-panel-border)}.ck.ck-balloon-panel[class*=arrow_s]:after,.ck.ck-balloon-panel[class*=arrow_s]:before{border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent}.ck.ck-balloon-panel[class*=arrow_s]:after{border-top-color:var(--ck-color-panel-background);margin-bottom:var(--ck-balloon-arrow-offset)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_n:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_n:before{left:50%;margin-left:calc(-1*var(--ck-balloon-arrow-half-width));top:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_nw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_nw:before{left:calc(2*var(--ck-balloon-arrow-half-width));top:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_ne:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_ne:before{right:calc(2*var(--ck-balloon-arrow-half-width));top:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_s:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_s:before{left:50%;margin-left:calc(-1*var(--ck-balloon-arrow-half-width));bottom:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_sw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_sw:before{left:calc(2*var(--ck-balloon-arrow-half-width));bottom:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_se:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_se:before{right:calc(2*var(--ck-balloon-arrow-half-width));bottom:calc(-1*var(--ck-balloon-arrow-height))}.ck .ck-balloon-rotator__navigation{display:flex;align-items:center;justify-content:center}.ck .ck-balloon-rotator__content .ck-toolbar{justify-content:center}.ck .ck-balloon-rotator__navigation{background:var(--ck-color-toolbar-background);border-bottom:1px solid var(--ck-color-toolbar-border);padding:0 var(--ck-spacing-small)}.ck .ck-balloon-rotator__navigation>*{margin-right:var(--ck-spacing-small);margin-top:var(--ck-spacing-small);margin-bottom:var(--ck-spacing-small)}.ck .ck-balloon-rotator__navigation .ck-balloon-rotator__counter{margin-right:var(--ck-spacing-standard);margin-left:var(--ck-spacing-small)}.ck .ck-balloon-rotator__content .ck.ck-annotation-wrapper{box-shadow:none}.ck .ck-fake-panel{position:absolute;z-index:calc(var(--ck-z-modal) - 1)}.ck .ck-fake-panel div{position:absolute}.ck .ck-fake-panel div:first-child{z-index:2}.ck .ck-fake-panel div:nth-child(2){z-index:1}:root{--ck-balloon-fake-panel-offset-horizontal:6px;--ck-balloon-fake-panel-offset-vertical:6px}.ck .ck-fake-panel div{box-shadow:var(--ck-drop-shadow),0 0;min-height:15px;background:var(--ck-color-panel-background);border:1px solid var(--ck-color-panel-border);border-radius:var(--ck-border-radius);width:100%;height:100%}.ck .ck-fake-panel div:first-child{margin-left:var(--ck-balloon-fake-panel-offset-horizontal);margin-top:var(--ck-balloon-fake-panel-offset-vertical)}.ck .ck-fake-panel div:nth-child(2){margin-left:calc(var(--ck-balloon-fake-panel-offset-horizontal)*2);margin-top:calc(var(--ck-balloon-fake-panel-offset-vertical)*2)}.ck .ck-fake-panel div:nth-child(3){margin-left:calc(var(--ck-balloon-fake-panel-offset-horizontal)*3);margin-top:calc(var(--ck-balloon-fake-panel-offset-vertical)*3)}.ck .ck-balloon-panel_arrow_s+.ck-fake-panel,.ck .ck-balloon-panel_arrow_se+.ck-fake-panel,.ck .ck-balloon-panel_arrow_sw+.ck-fake-panel{--ck-balloon-fake-panel-offset-vertical:-6px}.ck-content .image{clear:both;text-align:center;margin:1em 0}.ck-content .image>img{display:block;margin:0 auto;max-width:100%}.ck-content .image{position:relative;overflow:hidden}.ck-content .image .ck-progress-bar{position:absolute;top:0;left:0}:root{--ck-image-upload-progress-line-width:30px}.ck-content .image.ck-appear{animation:fadeIn .7s}.ck-content .image .ck-progress-bar{height:2px;width:0;background:var(--ck-color-upload-bar-background);transition:width .1s}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}.ck-image-upload-complete-icon{display:block;position:absolute;top:10px;right:10px;border-radius:50%}.ck-image-upload-complete-icon:after{content:"";position:absolute}:root{--ck-color-image-upload-icon:#fff;--ck-color-image-upload-icon-background:#008a00;--ck-image-upload-icon-size:20px;--ck-image-upload-icon-width:2px}.ck-image-upload-complete-icon{width:var(--ck-image-upload-icon-size);height:var(--ck-image-upload-icon-size);opacity:0;background:var(--ck-color-image-upload-icon-background);animation-name:ck-upload-complete-icon-show,ck-upload-complete-icon-hide;animation-fill-mode:forwards,forwards;animation-duration:.5s,.5s;font-size:var(--ck-image-upload-icon-size);animation-delay:0ms,3s}.ck-image-upload-complete-icon:after{left:25%;top:50%;opacity:0;height:0;width:0;transform:scaleX(-1) rotate(135deg);transform-origin:left top;border-top:var(--ck-image-upload-icon-width) solid var(--ck-color-image-upload-icon);border-right:var(--ck-image-upload-icon-width) solid var(--ck-color-image-upload-icon);animation-name:ck-upload-complete-icon-check;animation-duration:.5s;animation-delay:.5s;animation-fill-mode:forwards;box-sizing:border-box}@keyframes ck-upload-complete-icon-show{0%{opacity:0}to{opacity:1}}@keyframes ck-upload-complete-icon-hide{0%{opacity:1}to{opacity:0}}@keyframes ck-upload-complete-icon-check{0%{opacity:1;width:0;height:0}33%{width:.3em;height:0}to{opacity:1;width:.3em;height:.45em}}.ck .ck-upload-placeholder-loader{position:absolute;display:flex;align-items:center;justify-content:center;top:0;left:0}.ck .ck-upload-placeholder-loader:before{content:"";position:relative}:root{--ck-color-upload-placeholder-loader:#b3b3b3;--ck-upload-placeholder-loader-size:32px}.ck .ck-image-upload-placeholder{width:100%;margin:0}.ck .ck-upload-placeholder-loader{width:100%;height:100%}.ck .ck-upload-placeholder-loader:before{width:var(--ck-upload-placeholder-loader-size);height:var(--ck-upload-placeholder-loader-size);border-radius:50%;border-top:3px solid var(--ck-color-upload-placeholder-loader);border-right:2px solid transparent;animation:ck-upload-placeholder-loader 1s linear infinite}@keyframes ck-upload-placeholder-loader{to{transform:rotate(1turn)}}.ck.ck-dropdown{display:inline-block;position:relative}.ck.ck-dropdown .ck-dropdown__arrow{pointer-events:none;z-index:var(--ck-z-default)}.ck.ck-dropdown .ck-button.ck-dropdown__button{width:100%}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-on .ck-tooltip{display:none}.ck.ck-dropdown .ck-dropdown__panel{-webkit-backface-visibility:hidden;display:none;z-index:var(--ck-z-modal);position:absolute}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel-visible{display:inline-block;will-change:transform}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_ne,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nw{bottom:100%}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_se,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_sw{transform:translate3d(0,100%,0)}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_ne,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_se{left:0}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nw,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_sw{right:0}:root{--ck-dropdown-arrow-size:calc(0.5*var(--ck-icon-size))}.ck.ck-dropdown{font-size:inherit}.ck.ck-dropdown .ck-dropdown__arrow{right:var(--ck-spacing-standard);width:var(--ck-dropdown-arrow-size);margin-left:var(--ck-spacing-small)}.ck.ck-dropdown.ck-disabled .ck-dropdown__arrow{opacity:var(--ck-disabled-opacity)}.ck.ck-dropdown .ck-button.ck-dropdown__button:not(.ck-button_with-text){padding-left:var(--ck-spacing-small)}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-disabled .ck-button__label{opacity:var(--ck-disabled-opacity)}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-on{border-bottom-left-radius:0;border-bottom-right-radius:0}.ck.ck-dropdown .ck-button.ck-dropdown__button .ck-button__label{width:7em;overflow:hidden;text-overflow:ellipsis}.ck.ck-dropdown__panel{box-shadow:var(--ck-drop-shadow),0 0;border-radius:0}.ck-rounded-corners .ck.ck-dropdown__panel,.ck.ck-dropdown__panel.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0}.ck.ck-dropdown__panel{background:var(--ck-color-dropdown-panel-background);border:1px solid var(--ck-color-dropdown-panel-border);bottom:0;min-width:100%}.ck.ck-list{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;display:flex;flex-direction:column}.ck.ck-list .ck-list__item,.ck.ck-list .ck-list__separator{display:block}.ck.ck-list .ck-list__item>:focus{position:relative;z-index:var(--ck-z-default)}.ck.ck-list{border-radius:0}.ck-rounded-corners .ck.ck-list,.ck.ck-list.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-list{list-style-type:none;background:var(--ck-color-list-background)}.ck.ck-list__item{cursor:default;min-width:12em}.ck.ck-list__item .ck-button{min-height:unset;width:100%;text-align:left;border-radius:0;border:0;padding:calc(0.2*var(--ck-line-height-base)*var(--ck-font-size-base)) calc(0.4*var(--ck-line-height-base)*var(--ck-font-size-base))}.ck.ck-list__item .ck-button .ck-button__label{line-height:calc(1.2*var(--ck-line-height-base)*var(--ck-font-size-base))}.ck.ck-list__item .ck-button:active{box-shadow:none}.ck.ck-list__item .ck-button.ck-on{background:var(--ck-color-list-button-on-background);color:var(--ck-color-list-button-on-text)}.ck.ck-list__item .ck-button.ck-on:hover:not(ck-disabled){background:var(--ck-color-list-button-on-background-focus)}.ck.ck-list__item .ck-button.ck-on:active{box-shadow:none}.ck.ck-list__item .ck-button:hover:not(.ck-disabled){background:var(--ck-color-list-button-hover-background)}.ck.ck-list__item .ck-switchbutton.ck-on{background:var(--ck-color-list-background);color:inherit}.ck.ck-list__item .ck-switchbutton.ck-on:hover:not(ck-disabled){background:var(--ck-color-list-button-hover-background);color:inherit}.ck.ck-list__separator{height:1px;width:100%;background:var(--ck-color-base-border)}.ck.ck-button.ck-switchbutton .ck-button__toggle,.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner{display:block}:root{--ck-switch-button-toggle-width:2.6153846154em;--ck-switch-button-toggle-inner-size:1.0769230769em;--ck-switch-button-toggle-spacing:1px}.ck.ck-button.ck-switchbutton .ck-button__label{margin-right:calc(2*var(--ck-spacing-large))}.ck.ck-button.ck-switchbutton.ck-disabled .ck-button__toggle{opacity:var(--ck-disabled-opacity)}.ck.ck-button.ck-switchbutton .ck-button__toggle{border-radius:0}.ck-rounded-corners .ck.ck-button.ck-switchbutton .ck-button__toggle,.ck.ck-button.ck-switchbutton .ck-button__toggle.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-button.ck-switchbutton .ck-button__toggle{margin-left:auto;transition:background .4s ease;width:var(--ck-switch-button-toggle-width);background:var(--ck-color-switch-button-off-background)}.ck.ck-button.ck-switchbutton .ck-button__toggle:hover{background:var(--ck-color-switch-button-off-hover-background)}.ck.ck-button.ck-switchbutton .ck-button__toggle:hover .ck-button__toggle__inner{box-shadow:0 0 0 5px var(--ck-color-switch-button-inner-shadow)}.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner{border-radius:0}.ck-rounded-corners .ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner,.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner.ck-rounded-corners{border-radius:var(--ck-border-radius);border-radius:calc(0.5*var(--ck-border-radius))}.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner{margin:var(--ck-switch-button-toggle-spacing);width:var(--ck-switch-button-toggle-inner-size);height:var(--ck-switch-button-toggle-inner-size);background:var(--ck-color-switch-button-inner-background);transition:all .3s ease}.ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle{background:var(--ck-color-switch-button-on-background)}.ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle:hover{background:var(--ck-color-switch-button-on-hover-background)}.ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle .ck-button__toggle__inner{transform:translateX(1.3846153847em)}.ck.ck-toolbar-dropdown .ck-toolbar{flex-wrap:nowrap}.ck.ck-toolbar-dropdown .ck-dropdown__panel .ck-button:focus{z-index:calc(var(--ck-z-default) + 1)}.ck.ck-toolbar-dropdown .ck-toolbar{border:0}.ck.ck-dropdown .ck-dropdown__panel .ck-list{border-radius:0}.ck-rounded-corners .ck.ck-dropdown .ck-dropdown__panel .ck-list,.ck.ck-dropdown .ck-dropdown__panel .ck-list.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0}.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:first-child .ck-button{border-radius:0}.ck-rounded-corners .ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:first-child .ck-button,.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:first-child .ck-button.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0;border-bottom-left-radius:0;border-bottom-right-radius:0}.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:last-child .ck-button{border-radius:0}.ck-rounded-corners .ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:last-child .ck-button,.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:last-child .ck-button.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0;border-top-right-radius:0}.ck.ck-heading_heading1{font-size:20px}.ck.ck-heading_heading2{font-size:17px}.ck.ck-heading_heading3{font-size:14px}.ck[class*=ck-heading_heading]{font-weight:700}.ck.ck-dropdown.ck-heading-dropdown .ck-dropdown__button .ck-button__label{width:8em}.ck.ck-dropdown.ck-heading-dropdown .ck-dropdown__panel .ck-list__item{min-width:18em}.ck-content .image>figcaption{color:#333;background-color:#f7f7f7;padding:.6em;font-size:.75em;outline-offset:-1px}:root{--ck-image-style-spacing:1.5em}.ck-content .image-style-align-center,.ck-content .image-style-align-left,.ck-content .image-style-align-right,.ck-content .image-style-side{max-width:50%}.ck-content .image-style-side{float:right;margin-left:var(--ck-image-style-spacing)}.ck-content .image-style-align-left{float:left;margin-right:var(--ck-image-style-spacing)}.ck-content .image-style-align-center{margin-left:auto;margin-right:auto}.ck-content .image-style-align-right{float:right;margin-left:var(--ck-image-style-spacing)}.ck .ck-link_selected{background:var(--ck-color-link-selected-background)}.ck.ck-link-form{display:flex}.ck.ck-link-form .ck-label{display:none}@media screen and (max-width:600px){.ck.ck-link-form{flex-wrap:wrap}.ck.ck-link-form .ck-labeled-input{flex-basis:100%}.ck.ck-link-form .ck-button{flex-basis:50%}}.ck.ck-link-form_layout-vertical{display:block}.ck.ck-link-form{padding:var(--ck-spacing-standard)}.ck.ck-link-form:focus{outline:none}.ck.ck-link-form>:not(:first-child){margin-left:var(--ck-spacing-standard)}@media screen and (max-width:600px){.ck.ck-link-form{padding:0;width:calc(0.8*var(--ck-input-text-width))}.ck.ck-link-form .ck-labeled-input{margin:var(--ck-spacing-standard) var(--ck-spacing-standard) 0}.ck.ck-link-form .ck-labeled-input .ck-input-text{min-width:0;width:100%}.ck.ck-link-form .ck-button{padding:var(--ck-spacing-standard);margin-top:var(--ck-spacing-standard);margin-left:0;border-radius:0;border:0;border-top:1px solid var(--ck-color-base-border)}.ck.ck-link-form .ck-button:first-of-type{border-right:1px solid var(--ck-color-base-border)}}.ck.ck-link-form_layout-vertical{padding:0;min-width:var(--ck-input-text-width)}.ck.ck-link-form_layout-vertical .ck-labeled-input{margin:var(--ck-spacing-standard) var(--ck-spacing-standard) var(--ck-spacing-small)}.ck.ck-link-form_layout-vertical .ck-labeled-input .ck-input-text{min-width:0;width:100%}.ck.ck-link-form_layout-vertical .ck-button{padding:var(--ck-spacing-standard);margin:0;border-radius:0;border:0;border-top:1px solid var(--ck-color-base-border);width:50%}.ck.ck-link-form_layout-vertical .ck-button:first-of-type{border-right:1px solid var(--ck-color-base-border)}.ck.ck-link-form_layout-vertical .ck.ck-list{margin-left:0}.ck.ck-link-form_layout-vertical .ck.ck-list .ck-button.ck-switchbutton{border:0;width:100%}.ck.ck-link-form_layout-vertical .ck.ck-list .ck-button.ck-switchbutton:hover{background:none}.ck.ck-link-actions{display:flex;flex-direction:row;flex-wrap:nowrap}.ck.ck-link-actions .ck-link-actions__preview{display:inline-block}.ck.ck-link-actions .ck-link-actions__preview .ck-button__label{overflow:hidden}@media screen and (max-width:600px){.ck.ck-link-actions{flex-wrap:wrap}.ck.ck-link-actions .ck-link-actions__preview{flex-basis:100%}.ck.ck-link-actions .ck-button:not(.ck-link-actions__preview){flex-basis:50%}}.ck.ck-link-actions{padding:var(--ck-spacing-standard)}.ck.ck-link-actions .ck-button.ck-link-actions__preview{padding-left:0;padding-right:0}.ck.ck-link-actions .ck-button.ck-link-actions__preview,.ck.ck-link-actions .ck-button.ck-link-actions__preview:active,.ck.ck-link-actions .ck-button.ck-link-actions__preview:focus,.ck.ck-link-actions .ck-button.ck-link-actions__preview:hover{background:none}.ck.ck-link-actions .ck-button.ck-link-actions__preview:active{box-shadow:none}.ck.ck-link-actions .ck-button.ck-link-actions__preview:focus .ck-button__label{text-decoration:underline}.ck.ck-link-actions .ck-button.ck-link-actions__preview .ck-button__label{padding:0 var(--ck-spacing-medium);color:var(--ck-color-link-default);text-overflow:ellipsis;cursor:pointer;max-width:var(--ck-input-text-width);min-width:3em;text-align:center}.ck.ck-link-actions .ck-button.ck-link-actions__preview .ck-button__label:hover{text-decoration:underline}.ck.ck-link-actions:focus{outline:none}.ck.ck-link-actions .ck-button:not(.ck-link-actions__preview){margin-left:var(--ck-spacing-standard)}@media screen and (max-width:600px){.ck.ck-link-actions{padding:0;width:calc(0.8*var(--ck-input-text-width))}.ck.ck-link-actions .ck-button.ck-link-actions__preview{margin:var(--ck-spacing-standard) var(--ck-spacing-standard) 0}.ck.ck-link-actions .ck-button.ck-link-actions__preview .ck-button__label{min-width:0;max-width:100%}.ck.ck-link-actions .ck-button:not(.ck-link-actions__preview){padding:var(--ck-spacing-standard);margin-top:var(--ck-spacing-standard);margin-left:0;border-radius:0;border:0;border-top:1px solid var(--ck-color-base-border)}.ck.ck-link-actions .ck-button:not(.ck-link-actions__preview):first-of-type{border-right:1px solid var(--ck-color-base-border)}}.ck-media__wrapper .ck-media__placeholder{display:flex;flex-direction:column;align-items:center}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url .ck-tooltip{display:block}@media (hover:none){.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url .ck-tooltip{display:none}}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url{max-width:100%;position:relative}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url:hover .ck-tooltip{visibility:visible;opacity:1}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url .ck-media__placeholder__url__text{overflow:hidden;display:block}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="google.com/maps"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck-media__placeholder__icon *{display:none}.ck-editor__editable:not(.ck-read-only) .ck-media__wrapper>:not(.ck-media__placeholder),.ck-editor__editable:not(.ck-read-only) .ck-widget:not(.ck-widget_selected) .ck-media__placeholder{pointer-events:none}:root{--ck-media-embed-placeholder-icon-size:3em;--ck-color-media-embed-placeholder-url-text:#757575;--ck-color-media-embed-placeholder-url-text-hover:var(--ck-color-base-text)}.ck-media__wrapper{margin:0 auto}.ck-media__wrapper .ck-media__placeholder{padding:calc(3*var(--ck-spacing-standard));background:var(--ck-color-base-foreground)}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__icon{min-width:var(--ck-media-embed-placeholder-icon-size);height:var(--ck-media-embed-placeholder-icon-size);margin-bottom:var(--ck-spacing-large);background-position:50%;background-size:cover}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__icon .ck-icon{width:100%;height:100%}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url .ck-media__placeholder__url__text{color:var(--ck-color-media-embed-placeholder-url-text);white-space:nowrap;text-align:center;font-style:italic;text-overflow:ellipsis}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url .ck-media__placeholder__url__text:hover{color:var(--ck-color-media-embed-placeholder-url-text-hover);cursor:pointer;text-decoration:underline}.ck-media__wrapper[data-oembed-url*="open.spotify.com"]{max-width:300px;max-height:380px}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder{background:linear-gradient(90deg,#71c6f4,#0d70a5)}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0MDAgNDAwIj48cGF0aCBkPSJNNDAwIDIwMGMwIDExMC41LTg5LjUgMjAwLTIwMCAyMDBTMCAzMTAuNSAwIDIwMCA4OS41IDAgMjAwIDBzMjAwIDg5LjUgMjAwIDIwMHpNMTYzLjQgMzA1LjVjODguNyAwIDEzNy4yLTczLjUgMTM3LjItMTM3LjIgMC0yLjEgMC00LjItLjEtNi4yIDkuNC02LjggMTcuNi0xNS4zIDI0LjEtMjUtOC42IDMuOC0xNy45IDYuNC0yNy43IDcuNiAxMC02IDE3LjYtMTUuNCAyMS4yLTI2LjctOS4zIDUuNS0xOS42IDkuNS0zMC42IDExLjctOC44LTkuNC0yMS4zLTE1LjItMzUuMi0xNS4yLTI2LjYgMC00OC4yIDIxLjYtNDguMiA0OC4yIDAgMy44LjQgNy41IDEuMyAxMS00MC4xLTItNzUuNi0yMS4yLTk5LjQtNTAuNC00LjEgNy4xLTYuNSAxNS40LTYuNSAyNC4yIDAgMTYuNyA4LjUgMzEuNSAyMS41IDQwLjEtNy45LS4yLTE1LjMtMi40LTIxLjgtNnYuNmMwIDIzLjQgMTYuNiA0Mi44IDM4LjcgNDcuMy00IDEuMS04LjMgMS43LTEyLjcgMS43LTMuMSAwLTYuMS0uMy05LjEtLjkgNi4xIDE5LjIgMjMuOSAzMy4xIDQ1IDMzLjUtMTYuNSAxMi45LTM3LjMgMjAuNi01OS45IDIwLjYtMy45IDAtNy43LS4yLTExLjUtLjcgMjEuMSAxMy44IDQ2LjUgMjEuOCA3My43IDIxLjgiIGZpbGw9IiNmZmYiLz48L3N2Zz4=)}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder .ck-media__placeholder__url__text{color:#b8e6ff}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder .ck-media__placeholder__url__text:hover{color:#fff}.ck-media__wrapper[data-oembed-url*="google.com/maps"] .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNTAuMzc4IiBoZWlnaHQ9IjI1NC4xNjciIHZpZXdCb3g9IjAgMCA2Ni4yNDYgNjcuMjQ4Ij48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTcyLjUzMSAtMjE4LjQ1NSkgc2NhbGUoLjk4MDEyKSI+PHJlY3Qgcnk9IjUuMjM4IiByeD0iNS4yMzgiIHk9IjIzMS4zOTkiIHg9IjE3Ni4wMzEiIGhlaWdodD0iNjAuMDk5IiB3aWR0aD0iNjAuMDk5IiBmaWxsPSIjMzRhNjY4IiBwYWludC1vcmRlcj0ibWFya2VycyBzdHJva2UgZmlsbCIvPjxwYXRoIGQ9Ik0yMDYuNDc3IDI2MC45bC0yOC45ODcgMjguOTg3YTUuMjE4IDUuMjE4IDAgMCAwIDMuNzggMS42MWg0OS42MjFjMS42OTQgMCAzLjE5LS43OTggNC4xNDYtMi4wMzd6IiBmaWxsPSIjNWM4OGM1Ii8+PHBhdGggZD0iTTIyNi43NDIgMjIyLjk4OGMtOS4yNjYgMC0xNi43NzcgNy4xNy0xNi43NzcgMTYuMDE0LjAwNyAyLjc2Mi42NjMgNS40NzQgMi4wOTMgNy44NzUuNDMuNzAzLjgzIDEuNDA4IDEuMTkgMi4xMDcuMzMzLjUwMi42NSAxLjAwNS45NSAxLjUwOC4zNDMuNDc3LjY3My45NTcuOTg4IDEuNDQgMS4zMSAxLjc2OSAyLjUgMy41MDIgMy42MzcgNS4xNjguNzkzIDEuMjc1IDEuNjgzIDIuNjQgMi40NjYgMy45OSAyLjM2MyA0LjA5NCA0LjAwNyA4LjA5MiA0LjYgMTMuOTE0di4wMTJjLjE4Mi40MTIuNTE2LjY2Ni44NzkuNjY3LjQwMy0uMDAxLjc2OC0uMzE0LjkzLS43OTkuNjAzLTUuNzU2IDIuMjM4LTkuNzI5IDQuNTg1LTEzLjc5NC43ODItMS4zNSAxLjY3My0yLjcxNSAyLjQ2NS0zLjk5IDEuMTM3LTEuNjY2IDIuMzI4LTMuNCAzLjYzOC01LjE2OS4zMTUtLjQ4Mi42NDUtLjk2Mi45ODgtMS40MzkuMy0uNTAzLjYxNy0xLjAwNi45NS0xLjUwOC4zNTktLjcuNzYtMS40MDQgMS4xOS0yLjEwNyAxLjQyNi0yLjQwMiAyLTUuMTE0IDIuMDA0LTcuODc1IDAtOC44NDQtNy41MTEtMTYuMDE0LTE2Ljc3Ni0xNi4wMTR6IiBmaWxsPSIjZGQ0YjNlIiBwYWludC1vcmRlcj0ibWFya2VycyBzdHJva2UgZmlsbCIvPjxlbGxpcHNlIHJ5PSI1LjU2NCIgcng9IjUuODI4IiBjeT0iMjM5LjAwMiIgY3g9IjIyNi43NDIiIGZpbGw9IiM4MDJkMjciIHBhaW50LW9yZGVyPSJtYXJrZXJzIHN0cm9rZSBmaWxsIi8+PHBhdGggZD0iTTE5MC4zMDEgMjM3LjI4M2MtNC42NyAwLTguNDU3IDMuODUzLTguNDU3IDguNjA2czMuNzg2IDguNjA3IDguNDU3IDguNjA3YzMuMDQzIDAgNC44MDYtLjk1OCA2LjMzNy0yLjUxNiAxLjUzLTEuNTU3IDIuMDg3LTMuOTEzIDIuMDg3LTYuMjkgMC0uMzYyLS4wMjMtLjcyMi0uMDY0LTEuMDc5aC04LjI1N3YzLjA0M2g0Ljg1Yy0uMTk3Ljc1OS0uNTMxIDEuNDUtMS4wNTggMS45ODYtLjk0Mi45NTgtMi4wMjggMS41NDgtMy45MDEgMS41NDgtMi44NzYgMC01LjIwOC0yLjM3Mi01LjIwOC01LjI5OSAwLTIuOTI2IDIuMzMyLTUuMjk5IDUuMjA4LTUuMjk5IDEuMzk5IDAgMi42MTguNDA3IDMuNTg0IDEuMjkzbDIuMzgxLTIuMzhjMC0uMDAyLS4wMDMtLjAwNC0uMDA0LS4wMDUtMS41ODgtMS41MjQtMy42Mi0yLjIxNS01Ljk1NS0yLjIxNXptNC40MyA1LjY2bC4wMDMuMDA2di0uMDAzeiIgZmlsbD0iI2ZmZiIgcGFpbnQtb3JkZXI9Im1hcmtlcnMgc3Ryb2tlIGZpbGwiLz48cGF0aCBkPSJNMjE1LjE4NCAyNTEuOTI5bC03Ljk4IDcuOTc5IDI4LjQ3NyAyOC40NzVhNS4yMzMgNS4yMzMgMCAwIDAgLjQ0OS0yLjEyM3YtMzEuMTY1Yy0uNDY5LjY3NS0uOTM0IDEuMzQ5LTEuMzgyIDIuMDA1LS43OTIgMS4yNzUtMS42ODIgMi42NC0yLjQ2NSAzLjk5LTIuMzQ3IDQuMDY1LTMuOTgyIDguMDM4LTQuNTg1IDEzLjc5NC0uMTYyLjQ4NS0uNTI3Ljc5OC0uOTMuNzk5LS4zNjMtLjAwMS0uNjk3LS4yNTUtLjg3OS0uNjY3di0uMDEyYy0uNTkzLTUuODIyLTIuMjM3LTkuODItNC42LTEzLjkxNC0uNzgzLTEuMzUtMS42NzMtMi43MTUtMi40NjYtMy45OS0xLjEzNy0xLjY2Ni0yLjMyNy0zLjQtMy42MzctNS4xNjlsLS4wMDItLjAwM3oiIGZpbGw9IiNjM2MzYzMiLz48cGF0aCBkPSJNMjEyLjk4MyAyNDguNDk1bC0zNi45NTIgMzYuOTUzdi44MTJhNS4yMjcgNS4yMjcgMCAwIDAgNS4yMzggNS4yMzhoMS4wMTVsMzUuNjY2LTM1LjY2NmExMzYuMjc1IDEzNi4yNzUgMCAwIDAtMi43NjQtMy45IDM3LjU3NSAzNy41NzUgMCAwIDAtLjk4OS0xLjQ0IDM1LjEyNyAzNS4xMjcgMCAwIDAtLjk1LTEuNTA4Yy0uMDgzLS4xNjItLjE3Ni0uMzI2LS4yNjQtLjQ4OXoiIGZpbGw9IiNmZGRjNGYiIHBhaW50LW9yZGVyPSJtYXJrZXJzIHN0cm9rZSBmaWxsIi8+PHBhdGggZD0iTTIxMS45OTggMjYxLjA4M2wtNi4xNTIgNi4xNTEgMjQuMjY0IDI0LjI2NGguNzgxYTUuMjI3IDUuMjI3IDAgMCAwIDUuMjM5LTUuMjM4di0xLjA0NXoiIGZpbGw9IiNmZmYiIHBhaW50LW9yZGVyPSJtYXJrZXJzIHN0cm9rZSBmaWxsIi8+PC9nPjwvc3ZnPg==)}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder{background:#4268b3}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAyNCIgaGVpZ2h0PSIxMDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik05NjcuNDg0IDBINTYuNTE3QzI1LjMwNCAwIDAgMjUuMzA0IDAgNTYuNTE3djkxMC45NjZDMCA5OTguNjk0IDI1LjI5NyAxMDI0IDU2LjUyMiAxMDI0SDU0N1Y2MjhINDE0VjQ3M2gxMzNWMzU5LjAyOWMwLTEzMi4yNjIgODAuNzczLTIwNC4yODIgMTk4Ljc1Ni0yMDQuMjgyIDU2LjUxMyAwIDEwNS4wODYgNC4yMDggMTE5LjI0NCA2LjA4OVYyOTlsLTgxLjYxNi4wMzdjLTYzLjk5MyAwLTc2LjM4NCAzMC40OTItNzYuMzg0IDc1LjIzNlY0NzNoMTUzLjQ4N2wtMTkuOTg2IDE1NUg3MDd2Mzk2aDI2MC40ODRjMzEuMjEzIDAgNTYuNTE2LTI1LjMwMyA1Ni41MTYtNTYuNTE2VjU2LjUxNUMxMDI0IDI1LjMwMyA5OTguNjk3IDAgOTY3LjQ4NCAwIiBmaWxsPSIjRkZGRkZFIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder .ck-media__placeholder__url__text{color:#cdf}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder .ck-media__placeholder__url__text:hover{color:#fff}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder{background:linear-gradient(-135deg,#1400c8,#b900b4,#f50000)}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTA0IiBoZWlnaHQ9IjUwNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGRlZnM+PHBhdGggaWQ9ImEiIGQ9Ik0wIC4xNTloNTAzLjg0MVY1MDMuOTRIMHoiLz48L2RlZnM+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48bWFzayBpZD0iYiIgZmlsbD0iI2ZmZiI+PHVzZSB4bGluazpocmVmPSIjYSIvPjwvbWFzaz48cGF0aCBkPSJNMjUxLjkyMS4xNTljLTY4LjQxOCAwLTc2Ljk5Ny4yOS0xMDMuODY3IDEuNTE2LTI2LjgxNCAxLjIyMy00NS4xMjcgNS40ODItNjEuMTUxIDExLjcxLTE2LjU2NiA2LjQzNy0zMC42MTUgMTUuMDUxLTQ0LjYyMSAyOS4wNTYtMTQuMDA1IDE0LjAwNi0yMi42MTkgMjguMDU1LTI5LjA1NiA0NC42MjEtNi4yMjggMTYuMDI0LTEwLjQ4NyAzNC4zMzctMTEuNzEgNjEuMTUxQy4yOSAxNzUuMDgzIDAgMTgzLjY2MiAwIDI1Mi4wOGMwIDY4LjQxNy4yOSA3Ni45OTYgMS41MTYgMTAzLjg2NiAxLjIyMyAyNi44MTQgNS40ODIgNDUuMTI3IDExLjcxIDYxLjE1MSA2LjQzNyAxNi41NjYgMTUuMDUxIDMwLjYxNSAyOS4wNTYgNDQuNjIxIDE0LjAwNiAxNC4wMDUgMjguMDU1IDIyLjYxOSA0NC42MjEgMjkuMDU3IDE2LjAyNCA2LjIyNyAzNC4zMzcgMTAuNDg2IDYxLjE1MSAxMS43MDkgMjYuODcgMS4yMjYgMzUuNDQ5IDEuNTE2IDEwMy44NjcgMS41MTYgNjguNDE3IDAgNzYuOTk2LS4yOSAxMDMuODY2LTEuNTE2IDI2LjgxNC0xLjIyMyA0NS4xMjctNS40ODIgNjEuMTUxLTExLjcwOSAxNi41NjYtNi40MzggMzAuNjE1LTE1LjA1MiA0NC42MjEtMjkuMDU3IDE0LjAwNS0xNC4wMDYgMjIuNjE5LTI4LjA1NSAyOS4wNTctNDQuNjIxIDYuMjI3LTE2LjAyNCAxMC40ODYtMzQuMzM3IDExLjcwOS02MS4xNTEgMS4yMjYtMjYuODcgMS41MTYtMzUuNDQ5IDEuNTE2LTEwMy44NjYgMC02OC40MTgtLjI5LTc2Ljk5Ny0xLjUxNi0xMDMuODY3LTEuMjIzLTI2LjgxNC01LjQ4Mi00NS4xMjctMTEuNzA5LTYxLjE1MS02LjQzOC0xNi41NjYtMTUuMDUyLTMwLjYxNS0yOS4wNTctNDQuNjIxLTE0LjAwNi0xNC4wMDUtMjguMDU1LTIyLjYxOS00NC42MjEtMjkuMDU2LTE2LjAyNC02LjIyOC0zNC4zMzctMTAuNDg3LTYxLjE1MS0xMS43MUMzMjguOTE3LjQ0OSAzMjAuMzM4LjE1OSAyNTEuOTIxLjE1OXptMCA0NS4zOTFjNjcuMjY1IDAgNzUuMjMzLjI1NyAxMDEuNzk3IDEuNDY5IDI0LjU2MiAxLjEyIDM3LjkwMSA1LjIyNCA0Ni43NzggOC42NzQgMTEuNzU5IDQuNTcgMjAuMTUxIDEwLjAyOSAyOC45NjYgMTguODQ1IDguODE2IDguODE1IDE0LjI3NSAxNy4yMDcgMTguODQ1IDI4Ljk2NiAzLjQ1IDguODc3IDcuNTU0IDIyLjIxNiA4LjY3NCA0Ni43NzggMS4yMTIgMjYuNTY0IDEuNDY5IDM0LjUzMiAxLjQ2OSAxMDEuNzk4IDAgNjcuMjY1LS4yNTcgNzUuMjMzLTEuNDY5IDEwMS43OTctMS4xMiAyNC41NjItNS4yMjQgMzcuOTAxLTguNjc0IDQ2Ljc3OC00LjU3IDExLjc1OS0xMC4wMjkgMjAuMTUxLTE4Ljg0NSAyOC45NjYtOC44MTUgOC44MTYtMTcuMjA3IDE0LjI3NS0yOC45NjYgMTguODQ1LTguODc3IDMuNDUtMjIuMjE2IDcuNTU0LTQ2Ljc3OCA4LjY3NC0yNi41NiAxLjIxMi0zNC41MjcgMS40NjktMTAxLjc5NyAxLjQ2OS02Ny4yNzEgMC03NS4yMzctLjI1Ny0xMDEuNzk4LTEuNDY5LTI0LjU2Mi0xLjEyLTM3LjkwMS01LjIyNC00Ni43NzgtOC42NzQtMTEuNzU5LTQuNTctMjAuMTUxLTEwLjAyOS0yOC45NjYtMTguODQ1LTguODE1LTguODE1LTE0LjI3NS0xNy4yMDctMTguODQ1LTI4Ljk2Ni0zLjQ1LTguODc3LTcuNTU0LTIyLjIxNi04LjY3NC00Ni43NzgtMS4yMTItMjYuNTY0LTEuNDY5LTM0LjUzMi0xLjQ2OS0xMDEuNzk3IDAtNjcuMjY2LjI1Ny03NS4yMzQgMS40NjktMTAxLjc5OCAxLjEyLTI0LjU2MiA1LjIyNC0zNy45MDEgOC42NzQtNDYuNzc4IDQuNTctMTEuNzU5IDEwLjAyOS0yMC4xNTEgMTguODQ1LTI4Ljk2NiA4LjgxNS04LjgxNiAxNy4yMDctMTQuMjc1IDI4Ljk2Ni0xOC44NDUgOC44NzctMy40NSAyMi4yMTYtNy41NTQgNDYuNzc4LTguNjc0IDI2LjU2NC0xLjIxMiAzNC41MzItMS40NjkgMTAxLjc5OC0xLjQ2OXoiIGZpbGw9IiNGRkYiIG1hc2s9InVybCgjYikiLz48cGF0aCBkPSJNMjUxLjkyMSAzMzYuMDUzYy00Ni4zNzggMC04My45NzQtMzcuNTk2LTgzLjk3NC04My45NzMgMC00Ni4zNzggMzcuNTk2LTgzLjk3NCA4My45NzQtODMuOTc0IDQ2LjM3NyAwIDgzLjk3MyAzNy41OTYgODMuOTczIDgzLjk3NCAwIDQ2LjM3Ny0zNy41OTYgODMuOTczLTgzLjk3MyA4My45NzN6bTAtMjEzLjMzOGMtNzEuNDQ3IDAtMTI5LjM2NSA1Ny45MTgtMTI5LjM2NSAxMjkuMzY1IDAgNzEuNDQ2IDU3LjkxOCAxMjkuMzY0IDEyOS4zNjUgMTI5LjM2NCA3MS40NDYgMCAxMjkuMzY0LTU3LjkxOCAxMjkuMzY0LTEyOS4zNjQgMC03MS40NDctNTcuOTE4LTEyOS4zNjUtMTI5LjM2NC0xMjkuMzY1ek00MTYuNjI3IDExNy42MDRjMCAxNi42OTYtMTMuNTM1IDMwLjIzLTMwLjIzMSAzMC4yMy0xNi42OTUgMC0zMC4yMy0xMy41MzQtMzAuMjMtMzAuMjMgMC0xNi42OTYgMTMuNTM1LTMwLjIzMSAzMC4yMy0zMC4yMzEgMTYuNjk2IDAgMzAuMjMxIDEzLjUzNSAzMC4yMzEgMzAuMjMxIiBmaWxsPSIjRkZGIi8+PC9nPjwvc3ZnPg==)}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder .ck-media__placeholder__url__text{color:#ffe0fe}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder .ck-media__placeholder__url__text:hover{color:#fff}.ck.ck-media-form{display:flex;align-items:flex-start;flex-direction:row;flex-wrap:nowrap}.ck.ck-media-form .ck-labeled-input{display:inline-block}.ck.ck-media-form .ck-label{display:none}@media screen and (max-width:600px){.ck.ck-media-form{flex-wrap:wrap}.ck.ck-media-form .ck-labeled-input{flex-basis:100%}.ck.ck-media-form .ck-button{flex-basis:50%}}.ck.ck-media-form{padding:var(--ck-spacing-standard)}.ck.ck-media-form:focus{outline:none}.ck.ck-media-form>:not(:first-child){margin-left:var(--ck-spacing-standard)}@media screen and (max-width:600px){.ck.ck-media-form{padding:0;width:calc(0.8*var(--ck-input-text-width))}.ck.ck-media-form .ck-labeled-input{margin:var(--ck-spacing-standard) var(--ck-spacing-standard) 0}.ck.ck-media-form .ck-labeled-input .ck-input-text{min-width:0;width:100%}.ck.ck-media-form .ck-labeled-input .ck-labeled-input__error{white-space:normal}.ck.ck-media-form .ck-button{padding:var(--ck-spacing-standard);margin-top:var(--ck-spacing-standard);margin-left:0;border-radius:0;border:0;border-top:1px solid var(--ck-color-base-border)}.ck.ck-media-form .ck-button:first-of-type{border-right:1px solid var(--ck-color-base-border)}}.ck-content .media{clear:both;margin:1em 0;display:block;min-width:15em}:root{--ck-color-table-focused-cell-background:#f5fafe}.ck-widget.table td.ck-editor__nested-editable.ck-editor__nested-editable_focused,.ck-widget.table th.ck-editor__nested-editable.ck-editor__nested-editable_focused{background:var(--ck-color-table-focused-cell-background);border-style:none;outline:1px solid var(--ck-color-focus-border);outline-offset:-1px}:root{--ck-insert-table-dropdown-padding:10px;--ck-insert-table-dropdown-box-height:11px;--ck-insert-table-dropdown-box-width:12px;--ck-insert-table-dropdown-box-margin:1px;--ck-insert-table-dropdown-box-border-color:#bfbfbf;--ck-insert-table-dropdown-box-border-active-color:#53a0e4;--ck-insert-table-dropdown-box-active-background:#c7e5ff}.ck .ck-insert-table-dropdown__grid{display:flex;flex-direction:row;flex-wrap:wrap;width:calc(var(--ck-insert-table-dropdown-box-width)*10 + var(--ck-insert-table-dropdown-box-margin)*20 + var(--ck-insert-table-dropdown-padding)*2);padding:var(--ck-insert-table-dropdown-padding) var(--ck-insert-table-dropdown-padding) 0}.ck .ck-insert-table-dropdown__label{text-align:center}.ck .ck-insert-table-dropdown-grid-box{width:var(--ck-insert-table-dropdown-box-width);height:var(--ck-insert-table-dropdown-box-height);margin:var(--ck-insert-table-dropdown-box-margin);border:1px solid var(--ck-insert-table-dropdown-box-border-color);border-radius:1px}.ck .ck-insert-table-dropdown-grid-box.ck-on{border-color:var(--ck-insert-table-dropdown-box-border-active-color);background:var(--ck-insert-table-dropdown-box-active-background)}.ck-content .table{margin:1em auto;display:table}.ck-content .table table{border-collapse:collapse;border-spacing:0;border:1px double #b3b3b3}.ck-content .table table td,.ck-content .table table th{min-width:2em;padding:.4em;border-color:#d9d9d9}.ck-content .table table th{font-weight:700;background:#fafafa}</style><style id="abu-collapse-styles" type="text/css"></style></head>
<body>


<!-- Yandex.Metrika counter -->
<script>
   (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
   m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
   (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

   ym(48415679, "init", {
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true
   });
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/48415679" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Top100 (Kraken) Counter -->
<script>
    (function (w, d, c) {
    (w[c] = w[c] || []).push(function() {
        var options = {
            project: 7239947,
        };
        try {
            w.top100Counter = new top100(options);
        } catch(e) { }
    });
    var n = d.getElementsByTagName("script")[0],
    s = d.createElement("script"),
    f = function () { n.parentNode.insertBefore(s, n); };
    s.type = "text/javascript";
    s.async = true;
    s.src =
    (d.location.protocol == "https:" ? "https:" : "http:") +
    "//st.top100.ru/top100/top100.js";

    if (w.opera == "[object Opera]") {
    d.addEventListener("DOMContentLoaded", f, false);
} else { f(); }
})(window, document, "_top100q");
</script>
<noscript>
  <img src="//counter.rambler.ru/top100.cnt?pid=7239947" alt="Топ-100" />
</noscript>
<!-- END Top100 (Kraken) Counter -->





<div class="ajax-body" data-user_id="0" data-username="">

<div id="overflow" style="position: fixed; width: 100%; height: 100%; left: 0px; top: 0px; background: white; z-index: 100000000; display: none;"></div>
<img class="ajax-big-loader" alt="" src="/images/ajax-loader.gif" style="display: none;">
<div class="search-window-wrapper">
  <div class="search-window mode1">
    <div style="text-align: center;">
      <div class="orange-outlined-button ">По названию</div>
      <div class="orange-outlined-button gray-outlined-button to-mode2">По ингредиентам</div>
    </div>
    <div class="seach-type-selector" style="text-align: center;">
       Искать в
       <span><div class="jq-checkbox search-recepts checked"><input type="checkbox" class="search-recepts" checked=""><div class="jq-checkbox__div"></div></div> в рецептах</span>
       <span><div class="jq-checkbox search-sovets checked"><input type="checkbox" class="search-sovets" checked=""><div class="jq-checkbox__div"></div></div> в советах</span>
    </div>
    <div class="total-search-input">
      <img alt="" src="/images/search.png"><input class="total-serach-string" type="text" placeholder="Что ищем?">
    </div>
  </div>
  <div class="search-window mode2" style="display:none;">
    <div style="text-align: center;">
      <div class="orange-outlined-button gray-outlined-button to-mode1">По названию</div>
      <div class="orange-outlined-button ">По ингредиентам</div>
    </div>
    <div class="row">
    <div class="search-ingr-select-block col-md-4 form-item ingr-block">
      <select data-max-select="6" multiple="" class="select2-search-ingr multiple bottom-border ingr-include form-control form-select select2-hidden-accessible" data-placeholder="Ингридиенты в рецепте" data-select2-id="3" tabindex="-1" aria-hidden="true">
      </select><span class="select2 select2-container select2-container--default modal-search-select" dir="ltr" data-select2-id="4" style="width: 100%;"><span class="selection"><span class="select2-selection select2-selection--multiple" role="combobox" aria-haspopup="true" aria-expanded="false" tabindex="-1" aria-disabled="false"><ul class="select2-selection__rendered"><li class="select2-search select2-search--inline"><input class="select2-search__field" type="search" tabindex="0" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" role="searchbox" aria-autocomplete="list" placeholder="Ингридиенты в рецепте" style="width: 0px;"></li></ul></span></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>
      <div class="selected_fields"></div>
      <div class="limit-sel">Не более 6 значений</div>
    </div>
    <div class="search-ingr-select-block col-md-4 form-item">
      <select data-max-select="6" data-input="2" multiple="" class="select2-search multiple bottom-border cat-search form-control form-select select2-hidden-accessible" data-cat_type="category" data-placeholder="Категории блюда" data-select2-id="1" tabindex="-1" aria-hidden="true">
    
      </select><span class="select2 select2-container select2-container--default modal-search-select" dir="ltr" data-select2-id="2" style="width: calc(100% - 0px);"><span class="selection"><span class="select2-selection select2-selection--multiple" role="combobox" aria-haspopup="true" aria-expanded="false" tabindex="-1" aria-disabled="false"><ul class="select2-selection__rendered"><li class="select2-search select2-search--inline"><input class="select2-search__field" type="search" tabindex="0" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" role="searchbox" aria-autocomplete="list" placeholder="Категории блюда" style="width: 0px;"></li></ul></span></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>
      <div class="selected_fields"></div>
      <div class="limit-sel">Не более 6 значений</div>
    </div>
    <div class="search-ingr-select-block col-md-4 form-item ingr-block">
      <select data-max-select="6" multiple="" class="select2-search-ingr multiple bottom-border ingr-exclude form-control form-select select2-hidden-accessible" data-placeholder="Исключить ингрeдиенты" data-select2-id="5" tabindex="-1" aria-hidden="true">
      </select><span class="select2 select2-container select2-container--default modal-search-select" dir="ltr" data-select2-id="6" style="width: 100%;"><span class="selection"><span class="select2-selection select2-selection--multiple" role="combobox" aria-haspopup="true" aria-expanded="false" tabindex="-1" aria-disabled="false"><ul class="select2-selection__rendered"><li class="select2-search select2-search--inline"><input class="select2-search__field" type="search" tabindex="0" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" role="searchbox" aria-autocomplete="list" placeholder="Исключить ингрeдиенты" style="width: 0px;"></li></ul></span></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>
      <div class="selected_fields"></div>
      <div class="limit-sel">Не более 6 значений</div>
    </div>
    <!-- <div class='orange-outlined-button show-search-results'>Показать 0 рецептов</div> -->
    </div>
  </div>
  <div class="close-search-modal"><img class="close-search-modal-img" alt="" src="/images/close-1.png"></div>
  <div class="search-window-results">
      <div class="go-to-search-page"><a href="">Все результаты</a></div>
      <div class="recept-results"></div>
      <div class="sovet-results"></div>
      <div class="post-results"></div>
  </div>
</div>

<div id="loginBox" class="modal modal-dialog-centered fade"></div>
<div id="signupBox" class="modal modal-dialog-centered fade"></div>
<div id="rememberBox" class="modal modal-dialog-centered fade"></div> 
<div id="letterBox" class="modal modal-dialog-centered fade"></div> 
<div id="category-modal" class="modal modal-dialog-centered fade top-level">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <!-- Заголовок модального окна -->
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><img alt="" src="/images/modal-close.png"></button>
        <div class="modal-title">Категории блюд</div>
        <div class="mobil-back-navigator" data-cat_id="0" data-level="0">
          <i class="fa fa-caret-down"></i>
          <span>Категории</span>
        </div>
      </div>
      <!-- Основное содержимое модального окна -->
      <div class="modal-body scroll-modal-body">
          <div class="category-modal-parent-column">
<span class="top-list category-button active has_sub" data-href="/kategorii-blyuda/vtorye-blyuda" data-cat_id="1339">Вторые блюда</span><span class="top-list category-button  has_sub" data-href="/kategorii-blyuda/supy-i-bulony" data-cat_id="1763">Супы и бульоны</span><span class="top-list category-button  has_sub" data-href="/kategorii-blyuda/salaty" data-cat_id="1651">Салаты</span><span class="top-list category-button  has_sub" data-href="/kategorii-blyuda/zakuski" data-cat_id="1698">Закуски</span><span class="top-list category-button  has_sub" data-href="/kategorii-blyuda/deserty" data-cat_id="1456">Десерты</span><span class="top-list category-button  has_sub" data-href="/kategorii-blyuda/vypechka" data-cat_id="1501">Выпечка</span><span class="top-list category-button  has_sub" data-href="/kategorii-blyuda/napitki" data-cat_id="1627">Напитки</span><span class="top-list category-button  has_sub" data-href="/kategorii-blyuda/sousy-i-zapravki" data-cat_id="1818">Соусы и заправки</span><span class="top-list category-button  has_sub" data-href="/kategorii-blyuda/zagotovki" data-cat_id="1597">Заготовки</span><span class="top-list category-button  has_sub" data-href="/kategorii-blyuda/garniry" data-cat_id="1492">Гарниры</span><span class="top-list category-button  has_sub" data-href="/kategorii-blyuda/raznoe" data-cat_id="1477">Разное</span><span class="top-list category-button has_sub" data-href="" data-cat_id="-1">Кухни мира</span><span class="top-list category-button has_sub" data-href="" data-cat_id="-2">Поводы</span>        
         </div>
         <div class="category-modal-child-column">

<a href="/kategorii-blyuda/vtorye-blyuda"><span class="category-button">Вторые блюда
       <img alt="" src="/images/arrow-right-black-modal.svg"></span></a><div class="subcat-list"><a class="second_list" data-cat_id="1388" href="/kategorii-blyuda/zapekanka"><span class="category-button" title="Запеканки">Запеканки <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="1441" href="/kategorii-blyuda/kashi"><span class="category-button" title="Каши">Каши <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="1438" href="/kategorii-blyuda/kotlety"><span class="category-button" title="Котлеты">Котлеты <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="1368" href="/kategorii-blyuda/blyuda-iz-kuritsy"><span class="category-button" title="Блюда из курицы">Блюда из курицы <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="1358" href="/kategorii-blyuda/blyuda-iz-beloy-ryby"><span class="category-button" title="Блюда из рыбы">Блюда из рыбы <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="1370" href="/kategorii-blyuda/blyuda-iz-ovoschey"><span class="category-button" title="Блюда из овощей">Блюда из овощей <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="1371" href="/kategorii-blyuda/blyuda-iz-svininy"><span class="category-button" title="Блюда из свинины">Блюда из свинины <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="1499" href="/kategorii-blyuda/kartoshka"><span class="category-button" title="Блюда из картошки">Блюда из картошки <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="1361" href="/kategorii-blyuda/blyuda-iz-gribov"><span class="category-button" title="Блюда из грибов">Блюда из грибов <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="1411" href="/kategorii-blyuda/plov"><span class="category-button" title="Плов">Плов <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="1381" href="/kategorii-blyuda/blyudo-iz-subproduktov"><span class="category-button" title="Блюдо из субпродуктов">Блюдо из субпродуктов <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="2538" href="/kategorii-blyuda/blyuda-s-makaronami"><span class="category-button" title="Блюда с макаронами">Блюда с макаронами <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="1439" href="/kategorii-blyuda/shashlyk"><span class="category-button" title="Шашлык">Шашлык <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="1407" href="/kategorii-blyuda/otbivnye"><span class="category-button" title="Отбивные">Отбивные <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="1363" href="/kategorii-blyuda/blyuda-iz-indeyki"><span class="category-button" title="Блюда из индейки">Блюда из индейки <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="1422" href="/kategorii-blyuda/tefteli"><span class="category-button" title="Тефтели">Тефтели <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="1414" href="/kategorii-blyuda/ragu"><span class="category-button" title="Рагу">Рагу <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="1384" href="/kategorii-blyuda/golubtsy-dolma"><span class="category-button" title="Голубцы, Долма">Голубцы, Долма <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="1387" href="/kategorii-blyuda/zharkoe"><span class="category-button" title="Жаркое">Жаркое <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="1347" href="/kategorii-blyuda/tushenaya-kapusta"><span class="category-button" title="Тушеная капуста">Тушеная капуста <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="1382" href="/kategorii-blyuda/vareniki"><span class="category-button" title="Вареники">Вареники <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="1412" href="/kategorii-blyuda/podliva"><span class="category-button" title="Подлива">Подлива <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="1406" href="/kategorii-blyuda/myaso-po-frantsuzski"><span class="category-button" title="Мясо по-французски в духовке">Мясо по-французски в духовке <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="1385" href="/kategorii-blyuda/gulyash"><span class="category-button" title="Гуляш">Гуляш <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="1970" href="/kategorii-blyuda/myaso-v-duhovke"><span class="category-button" title="Мясо в духовке">Мясо в духовке <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="1408" href="/kategorii-blyuda/pasta"><span class="category-button" title="Паста, спагетти с соусом">Паста, спагетти с соусом <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="1360" href="/kategorii-blyuda/blyuda-iz-govyadiny"><span class="category-button" title="Блюда из говядины">Блюда из говядины <i class="fa fa-caret-down"></i></span></a><a class="second_list" data-cat_id="1376" href="/kategorii-blyuda/blyuda-iz-farsha"><span class="category-button" title="Блюда из фарша">Блюда из фарша <i class="fa fa-caret-down"></i></span></a><a class="" data-cat_id="1353" href="/kategorii-blyuda/beshbarmak-kuyrdak"><span class="category-button" title="Бешбармак, Куырдак">Бешбармак, Куырдак </span></a><a class="" data-cat_id="1362" href="/kategorii-blyuda/blyuda-iz-dichi"><span class="category-button" title="Блюда из дичи">Блюда из дичи </span></a><a class="" data-cat_id="1372" href="/kategorii-blyuda/blyuda-iz-soevogo-myasa"><span class="category-button" title="Блюда из соевого мяса">Блюда из соевого мяса </span></a><a class="" data-cat_id="1374" href="/kategorii-blyuda/blyuda-iz-telyatiny"><span class="category-button" title="Блюда из телятины">Блюда из телятины </span></a><a class="" data-cat_id="1375" href="/kategorii-blyuda/blyuda-iz-utki-i-gusya"><span class="category-button" title="Блюда из утки и гуся">Блюда из утки и гуся </span></a><a class="" data-cat_id="1377" href="/kategorii-blyuda/blyuda-iz-yagnenka"><span class="category-button" title="Блюда из ягненка">Блюда из ягненка </span></a><a class="" data-cat_id="1393" href="/kategorii-blyuda/kare-yagnenka"><span class="category-button" title="Каре ягненка">Каре ягненка </span></a><a class="" data-cat_id="1394" href="/kategorii-blyuda/kebab"><span class="category-button" title="Кебаб">Кебаб </span></a><a class="" data-cat_id="1417" href="/kategorii-blyuda/romshteks"><span class="category-button" title="Ромштекс">Ромштекс </span></a><a class="" data-cat_id="1425" href="/kategorii-blyuda/frikase"><span class="category-button" title="Фрикасе">Фрикасе </span></a><a class="" data-cat_id="2204" href="/kategorii-blyuda/medalony"><span class="category-button" title="Медальоны">Медальоны </span></a><a class="" data-cat_id="2303" href="/kategorii-blyuda/lapsha-vok"><span class="category-button" title="Лапша вок">Лапша вок </span></a><a class="" data-cat_id="2320" href="/kategorii-blyuda/ris-s-kuricei"><span class="category-button" title="Рис с курицей">Рис с курицей </span></a><a class="" data-cat_id="2393" href="/kategorii-blyuda/klyocki-knedliki"><span class="category-button" title="Клёцки, кнедлики">Клёцки, кнедлики </span></a><a class="" data-cat_id="2419" href="/kategorii-blyuda/grechka-s-kuricei"><span class="category-button" title="Гречка с курицей">Гречка с курицей </span></a><a class="" data-cat_id="2432" href="/kategorii-blyuda/kartoshka-s-myasom-v-duhovke"><span class="category-button" title="Картошка с мясом в духовке">Картошка с мясом в духовке </span></a><a class="" data-cat_id="2464" href="/kategorii-blyuda/myasnoe-sufle"><span class="category-button" title="Мясное суфле">Мясное суфле </span></a><a class="" data-cat_id="1437" href="/kategorii-blyuda/pelmeni"><span class="category-button" title="Пельмени">Пельмени </span></a><a class="" data-cat_id="1359" href="/kategorii-blyuda/blyuda-iz-bobovyh"><span class="category-button" title="Блюда из бобовых">Блюда из бобовых </span></a><a class="" data-cat_id="1423" href="/kategorii-blyuda/farshirovannye-pertsy"><span class="category-button" title="Фаршированные перцы">Фаршированные перцы </span></a><a class="" data-cat_id="1340" href="/kategorii-blyuda/adzhapsandal"><span class="category-button" title="Аджапсандал">Аджапсандал </span></a><a class="" data-cat_id="1341" href="/kategorii-blyuda/blyuda-iz-indoutki"><span class="category-button" title="Блюда из индоутки">Блюда из индоутки </span></a><a class="" data-cat_id="1343" href="/kategorii-blyuda/grechaniki"><span class="category-button" title="Гречаники">Гречаники </span></a><a class="" data-cat_id="1345" href="/kategorii-blyuda/kartoshka-v-duhovke"><span class="category-button" title="Картошка в духовке">Картошка в духовке </span></a><a class="" data-cat_id="1346" href="/kategorii-blyuda/kartoshka-s-myasom"><span class="category-button" title="Картошка с мясом">Картошка с мясом </span></a><a class="" data-cat_id="1348" href="/kategorii-blyuda/tushenaya-kartoshka"><span class="category-button" title="Тушеная картошка">Тушеная картошка </span></a><a class="" data-cat_id="1349" href="/kategorii-blyuda/azu"><span class="category-button" title="Азу">Азу </span></a><a class="" data-cat_id="1350" href="/kategorii-blyuda/antrekot"><span class="category-button" title="Антрекот">Антрекот </span></a><a class="" data-cat_id="1351" href="/kategorii-blyuda/banosh"><span class="category-button" title="Банош">Банош </span></a><a class="" data-cat_id="1352" href="/kategorii-blyuda/befstroganov"><span class="category-button" title="Бефстроганов">Бефстроганов </span></a><a class="" data-cat_id="1354" href="/kategorii-blyuda/bigus"><span class="category-button" title="Бигус">Бигус </span></a><a class="" data-cat_id="1356" href="/kategorii-blyuda/bifshteks"><span class="category-button" title="Бифштекс">Бифштекс </span></a><a class="" data-cat_id="1357" href="/kategorii-blyuda/blyuda-iz-baraniny"><span class="category-button" title="Блюда из баранины">Блюда из баранины </span></a><a class="" data-cat_id="1364" href="/kategorii-blyuda/blyuda-iz-koniny"><span class="category-button" title="Блюда из конины">Блюда из конины </span></a><a class="" data-cat_id="1365" href="/kategorii-blyuda/blyuda-iz-konservy"><span class="category-button" title="Блюда из консервы">Блюда из консервы </span></a><a class="" data-cat_id="1367" href="/kategorii-blyuda/blyuda-iz-krolika-zaytsa"><span class="category-button" title="Блюда из кролика, зайца">Блюда из кролика, зайца </span></a><a class="" data-cat_id="1369" href="/kategorii-blyuda/blyuda-iz-moreproduktov"><span class="category-button" title="Блюда из морепродуктов">Блюда из морепродуктов </span></a><a class="" data-cat_id="1373" href="/kategorii-blyuda/blyuda-iz-subproduktov-ptitsy"><span class="category-button" title="Блюда из субпродуктов птицы">Блюда из субпродуктов птицы </span></a><a class="" data-cat_id="1378" href="/kategorii-blyuda/blyuda-iz-yaits"><span class="category-button" title="Блюда из яиц">Блюда из яиц </span></a><a class="" data-cat_id="1379" href="/kategorii-blyuda/blyuda-s-kolbasnymi-izdeliyami"><span class="category-button" title="Блюда с колбасными изделиями">Блюда с колбасными изделиями </span></a><a class="" data-cat_id="1380" href="/kategorii-blyuda/blyuda-s-tofu"><span class="category-button" title="Блюда с тофу">Блюда с тофу </span></a><a class="" data-cat_id="1383" href="/kategorii-blyuda/galushki"><span class="category-button" title="Галушки">Галушки </span></a><a class="" data-cat_id="1386" href="/kategorii-blyuda/draniki"><span class="category-button" title="Драники">Драники </span></a><a class="" data-cat_id="1391" href="/kategorii-blyuda/zrazy"><span class="category-button" title="Зразы">Зразы </span></a><a class="" data-cat_id="1392" href="/kategorii-blyuda/karbonara-fetuchini"><span class="category-button" title="Карбонара, Фетучини">Карбонара, Фетучини </span></a><a class="" data-cat_id="1395" href="/kategorii-blyuda/kotlety-po-kievski"><span class="category-button" title="Котлеты по-киевски">Котлеты по-киевски </span></a><a class="" data-cat_id="1396" href="/kategorii-blyuda/kugelis"><span class="category-button" title="Кугелис">Кугелис </span></a><a class="" data-cat_id="1397" href="/kategorii-blyuda/kurinaya-pechen"><span class="category-button" title="Блюда из куриной печени">Блюда из куриной печени </span></a><a class="" data-cat_id="1398" href="/kategorii-blyuda/kyufta-gyurza"><span class="category-button" title="Кюфта, Гюрза">Кюфта, Гюрза </span></a><a class="" data-cat_id="1399" href="/kategorii-blyuda/lazanya"><span class="category-button" title="Лазанья">Лазанья </span></a><a class="" data-cat_id="1400" href="/kategorii-blyuda/langet"><span class="category-button" title="Лангет">Лангет </span></a><a class="" data-cat_id="1401" href="/kategorii-blyuda/lobio"><span class="category-button" title="Лобио">Лобио </span></a><a class="" data-cat_id="1402" href="/kategorii-blyuda/lyulya-kebab"><span class="category-button" title="Люля-кебаб">Люля-кебаб </span></a><a class="" data-cat_id="1404" href="/kategorii-blyuda/manty"><span class="category-button" title="Манты">Манты </span></a><a class="" data-cat_id="1405" href="/kategorii-blyuda/musaka"><span class="category-button" title="Мусака">Мусака </span></a><a class="" data-cat_id="1409" href="/kategorii-blyuda/paelya"><span class="category-button" title="Паэлья">Паэлья </span></a><a class="" data-cat_id="1410" href="/kategorii-blyuda/pleskavitsa"><span class="category-button" title="Плескавица">Плескавица </span></a><a class="" data-cat_id="1413" href="/kategorii-blyuda/ravioli"><span class="category-button" title="Равиоли">Равиоли </span></a><a class="" data-cat_id="1415" href="/kategorii-blyuda/ratatuy"><span class="category-button" title="Рататуй">Рататуй </span></a><a class="" data-cat_id="1416" href="/kategorii-blyuda/rizotto"><span class="category-button" title="Ризотто">Ризотто </span></a><a class="" data-cat_id="1418" href="/kategorii-blyuda/rostbif"><span class="category-button" title="Ростбиф">Ростбиф </span></a><a class="" data-cat_id="1420" href="/kategorii-blyuda/sote"><span class="category-button" title="Соте">Соте </span></a><a class="" data-cat_id="1421" href="/kategorii-blyuda/steyk"><span class="category-button" title="Стейки">Стейки </span></a><a class="" data-cat_id="1424" href="/kategorii-blyuda/frikadelki"><span class="category-button" title="Фрикадельки">Фрикадельки </span></a><a class="" data-cat_id="1426" href="/kategorii-blyuda/hashlama"><span class="category-button" title="Хашлама">Хашлама </span></a><a class="" data-cat_id="1427" href="/kategorii-blyuda/hingal"><span class="category-button" title="Хингал">Хингал </span></a><a class="" data-cat_id="1428" href="/kategorii-blyuda/hinkali"><span class="category-button" title="Хинкали">Хинкали </span></a><a class="" data-cat_id="1429" href="/kategorii-blyuda/tsyplenok-tabaka"><span class="category-button" title="Цыпленок табака">Цыпленок табака </span></a><a class="" data-cat_id="1430" href="/kategorii-blyuda/chahohbili-chanahi"><span class="category-button" title="Чахохбили, Чанахи">Чахохбили, Чанахи </span></a><a class="" data-cat_id="1431" href="/kategorii-blyuda/chyhyrtma"><span class="category-button" title="Чыхыртма">Чыхыртма </span></a><a class="" data-cat_id="1432" href="/kategorii-blyuda/shnitsel"><span class="category-button" title="Шницель">Шницель </span></a><a class="" data-cat_id="1433" href="/kategorii-blyuda/yahniya"><span class="category-button" title="Яхния">Яхния </span></a><a class="" data-cat_id="1440" href="/kategorii-blyuda/blyuda-iz-zlakov"><span class="category-button" title="Блюда из злаков">Блюда из злаков </span></a><a class="" data-cat_id="1956" href="/kategorii-blyuda/blyuda-iz-tykvy"><span class="category-button" title="Блюда из тыквы">Блюда из тыквы </span></a><a class="" data-cat_id="1958" href="/kategorii-blyuda/govyadina-v-duhovke"><span class="category-button" title="Говядина в духовке">Говядина в духовке </span></a><a class="" data-cat_id="1961" href="/kategorii-blyuda/domashnyaya-kolbasa"><span class="category-button" title="Домашняя колбаса">Домашняя колбаса </span></a><a class="" data-cat_id="1964" href="/kategorii-blyuda/krolik-zayac-v-duhovke"><span class="category-button" title="Кролик, заяц в духовке">Кролик, заяц в духовке </span></a><a class="" data-cat_id="1967" href="/kategorii-blyuda/makarony-s-myasom"><span class="category-button" title="Макароны с мясом">Макароны с мясом </span></a><a class="" data-cat_id="1986" href="/kategorii-blyuda/tushenoe-myaso"><span class="category-button" title="Тушеное мясо">Тушеное мясо </span></a><a class="" data-cat_id="1987" href="/kategorii-blyuda/utka-gus-v-duhovke"><span class="category-button" title="Утка, гусь в духовке">Утка, гусь в духовке </span></a><a class="" data-cat_id="2033" href="/kategorii-blyuda/kurinye-oladi"><span class="category-button" title="Куриные оладьи">Куриные оладьи </span></a><a class="" data-cat_id="2124" href="/kategorii-blyuda/tushenaya-pechen"><span class="category-button" title="Тушеная печень">Тушеная печень </span></a><a class="" data-cat_id="2129" href="/kategorii-blyuda/yozhiki-iz-farsha"><span class="category-button" title="Ёжики из фарша">Ёжики из фарша </span></a><a class="" data-cat_id="2206" href="/kategorii-blyuda/lapsha-s-kuricei"><span class="category-button" title="Лапша с курицей">Лапша с курицей </span></a><a class="" data-cat_id="2352" href="/kategorii-blyuda/lapsha-s-ovoschami"><span class="category-button" title="Лапша с овощами">Лапша с овощами </span></a></div><div class="random-recept">
</div>
         </div>
      </div>
    </div>
  </div>
</div> 

<div id="colorBox" class="modal modal-dialog-centered fade"></div>  
<div id="signupConfirmBox" class="modal modal-dialog-centered fade"></div>  


<div class="body-inner">
<div class="input-buffer"></div>
<input type="hidden" class="user_id" value="0">

<div class="wrap">

 

      
    
    
  <header>
    <nav id="w0" class="navbar navbar-default"><div class="container"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#w0-collapse ul.navbar-nav.nav"><span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span></button><a class="navbar-brand" href="/"><img src="/images/logo-nyam.png" alt=""></a></div><div id="w0-collapse" class="collapse navbar-collapse"><ul id="w1" class="navbar-nav nav"><div class="close-menu-button"></div><li><a href="/recepty">Рецепты</a></li>
<li><a href="/poleznye-sovety">Советы</a></li>
<li><a href="/radio"><img class="radio-icon" src="/images/radio-icon.png" alt=""> Радио</a></li>
<li><a href="https://t.me/nyamkin" target="_blank"><img class="telegram-icon" src="/images/telegram-icon.png" alt=""> Телеграм</a></li>
<li><a class="add-recept-not-login" href="/">+ Рецепт</a></li>
<li><a class="add-sovet-not-login" href="/">+ Совет</a></li></ul><div class="search-modal-init"><div class="search-modal-selector"><img alt="" src="/images/search.png"><div class="tinymobile"> Поиск</div></div><div class="search-modal-selector gray planshet">ингрeдиенты</div></div><div class="right-part-hat last-child"><a href="/login" class="not-login"><img alt="" src="/images/user-regular.png"></a></div><div class="right-part-hat"><a href="/favorites/recipes"><span class="go-to-favorits"><i class="fa fa-star"></i></span></a></div><div class="right-part-hat">
              <span class="add-recept-button desctop">
                <img alt="" src="/images/plus.png">Добавить
              </span>
              <span class="add-recept-button mobile">
                <img alt="" src="/images/plus.png">
              </span>
              <div class="add-dropdown-menu">
                <ul><li class="del"><a href="" class="add-recept-not-login">Рецепт</a></li><li class="del"><a href="" class="add-sovet-not-login">Совет</a></li></ul>
              </div>      
           </div></div></div></nav>  </header>   
   
<div class="back-to-top">
  <img alt="" src="/images/backtotop2x.png">
</div>
    <div class="container for-width-calc ">
    
    

    

                        
    <div class="success-action">
      <img class="icon" alt="" src="/images/success-action.png">
      <span></span>
      <div class="close">×</div>
    </div>
    <div class="fail-action">
      <img class="icon" alt="" src="/images/fail-action.png">
      <span></span>
      <div class="close">×</div>
    </div>

   

 

 

<div style="clear:both;"></div>
        <div class="col-md-9">
 <h1>Политика Конфиденциальности сайта nyamkin.ru</h1>
<div class="row"><div class="col-md-12">

<p>Администрация сайта nyamkin.ru обязуется сохранять вашу конфиденциальность в Интернете. Мы уделяем большое значение охране предоставленных вами данных. Наша политика конфиденциальности основана на требованиях Общего регламента о защите персональных данных Европейского Союза (GDPR). Цели, в которых мы собираем персональные данные: улучшение работы нашего сервиса, осуществление контактов с посетителями данного сайта, новостная рассылка по электронной почте, осуществление услуг, связанных с направлением деятельности данного сайта, для создания личного профиля пользователя на сайте в процессе авторизации, а так же для указанных ниже действий.</p>  <h3>Сбор и использование персональных данных</h3>  <p>Мы собираем и используем ваши персональные данные только в случае вашего добровольного согласия. При согласии с этим вы разрешаете нам собирать и использовать следующие данные: имя и фамилия, дата рождения, электронная почта, личные фотографии , идентификаторы электронных кошельков, данные аккаунтов в социальных сетях, . Сбор и обработка ваших данных проводится соответствии с законами, действующими на территории Европейского Союза и в государстве Россия.</p>  <h3>Хранение данных, изменение и удаление</h3>  <p>Пользователь, предоставивший свои персональные данные сайту nyamkin.ru имеет право на их изменение и удаление, а так же на отзыв своего согласия с их использованием. Срок, в течение которого будут храниться ваши персональные данные: время, необходимое для использования данных для основной деятельности сайта. При завершении использования ваших данных администрация сайта удаляет их. Для доступа к своим персональным данным вы можете связаться с администрацией сайта по следующему адресу: mixer@nyamkin.ru. Мы можем передавать ваши личные данные третьей стороне только с вашего добровольного согласия, если они были переданы, то изменение данных в других организациях, не связанных с нами, мы осуществить не можем.</p>  <h3>Использование технических данных при посещении сайта</h3>  <p>При посещении вами сайта nyamkin.ru в базе данных сохраняются записи о вашем IP адресе, времени посещения, настройках браузера, операционной системе, а также другая техническая информация необходимая для корректного отображения содержимого сайта. По этим данным нам невозможно идентифицировать личность посетителя.</p>  <h3>Предоставление информации детьми</h3>  <p>Если Вы являетесь родителем или опекуном, и вы знаете, что ваши дети предоставили нам свои личные данные без Вашего согласия, свяжитесь с нами: mixer@nyamkin.ru. На нашем сервисе запрещено оставлять личные данные несовершеннолетних без согласия родителей или опекунов.</p>  <h3>Использование cookies</h3>  <p>Для корректного отображения содержимого и для удобства использования сайта nyamkin.ru мы используем cookie файлы. Это небольшие файлы, которые хранятся на вашем устройстве. Они помогают сайту запомнить информацию о вас, например на каком языке вы просматриваете сайт и какие страницы вы уже открывали, эта информация будет полезна при следующем посещении. Благодаря файлам cookie просмотр сайта становится значительно более удобным. Подробнее про эти файлы вы можете прочитать тут. Вы можете настроить прием или блокировку cookie в браузере самостоятельно. Невозможность принимать cookie может ограничить работоспособность сайта.</p>  <h3>Использование персональных данных другими сервисами</h3>  <p>На этом сайте используются сторонние интернет-сервисы, осуществляющие независимый от нас сбор информации: Google Analytics , Google AdSense, Yandex.Metrica, Yandex.Direct, . Собранные ими данные могут предоставляться другим службам внутри этих организаций, они могут использовать данные для персонализации рекламы своей собственной рекламной сети.  Вы можете прочитать пользовательские соглашения этих организаций на их сайтах. Мы не передаем персональные данные другим организациям и службам, не указанным в данной политике конфиденциальности. Исключение составляет только передача информации при законных требованиях государственных органов уполномоченных осуществлять данные действия.</p>  <h3>Ссылки на другие сайты</h3>  <p>Наш сайт nyamkin.ru может содержать ссылки на другие сайты, которые не управляются нами. Мы не несем ответственность за их содержание. Мы рекомендуем вам ознакомиться с политикой конфиденциальности каждого сайта, который вы посещаете, если она там есть.</p>  <h3>Изменения в политике конфиденциальности</h3>  <p>Наш сайт nyamkin.ru может обновлять нашу политику конфиденциальности время от времени. Мы сообщаем о любых изменениях, разместив новую политику конфиденциальности на этой странице. Мы отслеживаем изменения законодательства, касающегося персональных данных в Европейском Союзе и в государстве Россия. Если вы оставили персональные данные у нас, то мы оповестим вас об изменении в политике конфиденциальности. Если ваши персональные данные были введены не корректно, то мы не сможем с вами связаться.</p>  <h3>Обратная связь, заключительные положения</h3>  <p>Связаться с администрацией сайта nyamkin.ru по вопросам, связанным с политикой конфиденциальности можно по адресу: mixer@nyamkin.ru, либо с помощью контактной формы указанной в соответствующем разделе данного сайта. Если вы не согласны с данной политикой конфиденциальности, вы не можете пользоваться услугами сайта nyamkin.ru, в этом случае вы должны воздержаться от посещения нашего сайта.</p></div></div>
</div>
<div class="col-md-3">
</div>    </div>
</div>

<footer class="footer">
    <div class="container">
      <div class="row">
        <div class="col-md-5">
          <nav class="footer-menu-string">
            <span>Разделы:</span>
            <a href="/recepty">Рецепты</a>
            <a href="/poleznye-sovety">Советы</a>
            <a class="autorize">Профиль</a>
          </nav>
          <nav class="footer-menu-string">
            <span>Контакты:</span>
            <a href="/contact">Написать нам</a>
            <a href="">Реклама</a>
            <a href="/pay-recipes">ПЛАТИМ</a>
          </nav>
          <nav class="footer-menu-string">
            <span>Правила:</span>
            <a href="/rules">Правила сайта</a>
            <a href="/policy">Политика конфиденциальности</a>
          </nav>
        </div>
        <div class="col-md-3 padding-left-0">
          <div class="soc-zagol">Нямкин в соцсетях</div>
          <div class="footer-soc">
            <a href="https://t.me/nyamkin"><img alt="" src="/images/soc/tg-social-logotype.png"></a>
            <a href="https://vk.com/nyamkin_ru"><img alt="" src="/images/soc/vk-social-logotype.png"></a>
            <a href="https://ok.ru/nyamkinru"><img alt="" src="/images/soc/odnoklassniki-logo.png"></a>
            <a href="https://www.youtube.com/c/nyamkin"><img alt="" src="/images/soc/youtube-logotype.png"></a>
            <a href="https://zen.yandex.ru/id/5cef2c8e32677000aff814c2"><img alt="" src="/images/soc/Zen_logo.png"></a>
          </div>
        </div>
        <div class="col-md-4  copyright">
          <div class="footer-logo"><a href="/"><img alt="" src="/images/logo-gr.png"></a></div>
          <div class="text"><span>© 2017-2023 Нямкин.</span> Для лиц старше 18 лет. Копирование материалов запрещено</div>
          <div class="google">This site is protected by reCAPTCHA and the Google <a href="https://policies.google.com/privacy">Privacy Policy</a> and <a href="https://policies.google.com/terms">Terms of Service</a> apply.</div>
        </div>
      </div>
    </div>
</footer>
<script src="/assets/79b87481/jquery.js"></script>
<script src="/assets/dea20f91/yii.js"></script>
<script src="/assets/23ff8788/js/bootstrap.js"></script></div>
</div>
<!-- <script src="/frontend/web/js/jquery.colorbox.js"></script> -->


    <script src="https://www.google.com/recaptcha/api.js?render=6Le4PNsUAAAAAFgraWD8EGN7p76X4Qv3oxfrxfiM"></script>
    <script>
        grecaptcha.ready(function () {
            grecaptcha.execute('6Le4PNsUAAAAAFgraWD8EGN7p76X4Qv3oxfrxfiM', { action: '' }).then(function (token) {
                $('#recaptchaResponse').val(token);
                $('.recaptchaResponse').val(token);
            });
        });
    </script>



<script>

var IS_TOUCH_DEVICE = ('ontouchstart' in document.documentElement);

if (false && !IS_TOUCH_DEVICE) {

  var IS_TOUCH_DEVICE = ('ontouchstart' in document.documentElement);
 
  var dragEvents = (function () {
    if (IS_TOUCH_DEVICE) {
      return {
        START: 'touchstart',
        MOVE: 'touchmove',
        END: 'touchend'
      };
    }
    else {
      return {
        START: 'mousedown',
        MOVE: 'mousemove',
        END: 'mouseup'
      };
    }
  }());


  var dragHandler = {
    lastClientX: 0,
    start: function (e) {
        //if (e.button == 0) {
            document.getElementById('scrollx').addEventListener(dragEvents.MOVE, dragHandler.drag);
            dragHandler.lastClientX = e.clientX || e.originalEvent.touches[0].clientX;
            e.preventDefault();
            
        //}
     },
     end: function (e) {
        //if (e.button == 0) {
           document.getElementById('scrollx').removeEventListener(dragEvents.MOVE, dragHandler.drag);
       // }
     },
     drag: function (e) {
        var clientX  = e.clientX || e.originalEvent.touches[0].clientX;
        var delta = -clientX + dragHandler.lastClientX;
        console.log('delta', delta, ' scrollX', $('#scrollx').css('marginLeft') );
        var ml = $('#scrollx').css('marginLeft').replace('px','')*1 - delta ;
        ml = Math.min(0, ml);
        ml = Math.max($('.container.for-size').width()-1200,ml);
        $('#scrollx').css('marginLeft', ml + 'px');
        dragHandler.lastClientX = e.clientX;
        e.preventDefault();
     }
  };
  document.getElementById('scrollx').addEventListener(dragEvents.START, dragHandler.start);
  document.getElementById('scrollx').addEventListener(dragEvents.END, dragHandler.end);
}


var yyy;

function hideScroll(y) {
  if (!IS_TOUCH_DEVICE) {
    document.body.classList.add('no-scroll');
    document.body.style.position = 'fixed';
    document.body.style.width = '100%';
    document.body.style.top = - y + 'px';
    yyy = y;
    
    console.log('hideScroll');
    $('html').css('overflow','unset');    
  }
}

function showScroll() {
  if (!IS_TOUCH_DEVICE) {

    console.log('showScroll');
    $('html').css('overflow','auto'); 
    
    document.body.classList.remove('no-scroll');
    
    document.body.style.position = '';
    document.body.style.width = '';
    document.body.style.top = '';
    
    window.scroll(0, yyy);
  }
}

function isYoutube(getURL){
	if(typeof getURL!=='string') return false;
	var newA = document.createElement('A');
	newA.href = getURL;
	var host = newA.hostname;
	var srch = newA.search;
	var path = newA.pathname;
	
	if(host.search(/youtube\.com|youtu\.be/)===-1) return false;
	if(host.search(/youtu\.be/)!==-1) return path.slice(1);
	if(path.search(/embed/)!==-1) return /embed\/([A-z0-9]+)(\&|$)/.exec(path)[1];
	var getId = /v=([A-z0-9]+)(\&|$)/.exec(srch);
	if(host.search(/youtube\.com/)!==-1) return !getId ? '':getId[1];
	return false;
}


  function send_comment_function(bl1, bl2, photo) {
  
    if ( bl2.html().replace(/<\/?[^>]+>/gi, '') == '' && ! bl2.html().indexOf('<input class=') == 0 ) {
    
              $('.fail-action span').text('Пустой комментарий');
              $('.fail-action').show();
              setTimeout( function() {
                $('.fail-action').fadeOut('slow');
              }, 4000); 
      return false;
    }
  
    if ($('.new-comment form').length) {
       
       var un = bl1.closest('.new-comment form').find('.comment-user-name');
       if ( un.length && un.val() == '' ) {
         un.css('borderBottom', '1px solid red');
              $('.fail-action span').text('Необходимо заполнить имя');
              $('.fail-action').show();
              setTimeout( function() {
                $('.fail-action').fadeOut('slow');
              }, 4000); 
         return false;
       }
       var txt = bl2.html().replace('<div>','').replace('</div>','').replace('<div>','').replace('</div>','<br>');
       
       if (txt.trim() == '' || txt.trim() == '<span class="rte-placeholder">Напишите комментарий</span>' || txt.trim() == '<br>') {
              $('.fail-action span').text('Пустой комментарий');
              $('.fail-action').show();
              setTimeout( function() {
                $('.fail-action').fadeOut('slow');
              }, 4000); 
         return false;
       }
       
       bl1.closest('form').find('.send-comment-button img').attr('src', '/images/loader_showmore.gif');
       
       txt = txt.split('<br>');
       if (txt[txt.length-1] == '') txt.splice(txt.length-1, 1);
       txt = txt.join('<br>');
       
       bl1.val(txt);
       var data   =  bl1.closest('.new-comment form').serializeArray();
       var form_data = new FormData(bl1.closest('.new-comment form')[0]);
	   console.log(form_data);
       /*
       $('.comments-list-wrapper').load( document.location.href+' .comments-list', data, function() {
         bl2.html('');
         bl1.val('');
       });*/
       if (photo) {
         form_data.append('modal', '#onePhotoBox');
         form_data.append('username', '');
         $.ajax({
	        url: '/modal',
	        dataType: 'text',
	        cache: false,
	        contentType: false,
	        processData: false,
	        data: form_data,
	        type: 'post',
	        success: function(ans){  
            if ( ans.indexOf('===#$#$#$#$===') !== -1 ) {
               ans = ans.split('===#$#$#$#$===');
               $('.fail-action span').text(ans[1]);
               $('.fail-action').show();
               setTimeout( function() {
                 $('.fail-action').fadeOut('slow');
               }, 4000);                 
            } else {
	          var $ans = $(ans);
	          $('.comments-list-wrapper').empty().append($ans.find('.comments-list'));
	          //$(".comment-ox").colorbox({rel:'comment-colorbox', transition:"none" });
	          //$('html').getNiceScroll().resize();
            }
          
	          bl2.html('');
              bl1.val('');
              $('.file-list').empty();
              
	          grecaptcha.ready(function () {
                grecaptcha.execute('6Le4PNsUAAAAAFgraWD8EGN7p76X4Qv3oxfrxfiM', { action: '' }).then(function (token) {
                  $('#recaptchaResponse').val(token);
                  $('.recaptchaResponse').val(token);
                });
              });
              
              $('.send-comment-button img').attr('src', '/images/send-message.png');
	        }
	      }); 
	    } else { 
	      $.ajax({
	        url: document.location.href,
	        dataType: 'text',
	        cache: false,
	        contentType: false,
	        processData: false,
	        data: form_data,
	        type: 'post',
	        success: function(ans){  

            if ( ans.indexOf('===#$#$#$#$===') !== -1 ) {
               ans = ans.split('===#$#$#$#$===');
               $('.fail-action span').text(ans[1]);
               $('.fail-action').show();
               setTimeout( function() {
                 $('.fail-action').fadeOut('slow');
               }, 4000);                 
            } else {
	          var $ans = $(ans);
	          $('.comments-list-wrapper').empty().append($ans.find('.comments-list'));
	          //$('html').getNiceScroll().resize();          

	            bl2.html('');
              bl1.val('');
              $('.file-list').empty();
            }
	          grecaptcha.ready(function () {
                grecaptcha.execute('6Le4PNsUAAAAAFgraWD8EGN7p76X4Qv3oxfrxfiM', { action: '' }).then(function (token) {
                  $('#recaptchaResponse').val(token);
                  $('.recaptchaResponse').val(token);
                });
              });
              
              $('.send-comment-button img').attr('src', '/images/send-message.png');	
        
	        },
	        error: function() {
              
              $('.fail-action span').text('Ошибка отправки. Попробуйте позже.');
              $('.fail-action').show();
              setTimeout( function() {
                $('.fail-action').fadeOut('slow');
              }, 4000);  
              
	          grecaptcha.ready(function () {
                grecaptcha.execute('6Le4PNsUAAAAAFgraWD8EGN7p76X4Qv3oxfrxfiM', { action: '' }).then(function (token) {
                  $('#recaptchaResponse').val(token);
                  $('.recaptchaResponse').val(token);
                });
              });
              
              $('.send-comment-button img').attr('src', '/images/send-message.png');		        
	        }
	      }); 
	    }      
        return false;
    } else if ($('.dialog-message-form').length) {
        //var data   = $('.dialog-message-form form').serialize();
        
    }
  }
</script>
<script src="/frontend/web/js/jquery.rte.js"></script>
<script src="/frontend/web/js/jquery.emojis.js"></script>
<script src="/frontend/web/js/jquery.formstyler.js"></script>

<script src="/frontend/web/js/drag-arrange.js"></script>
<script src="/frontend/web/js/jquery.nicescroll.js"></script>

<script src="https://cdn.jsdelivr.net/npm/lazyload@2.0.0-rc.2/lazyload.js"></script>

<script src="/frontend/web/js/jquery.imgareaselect.js"></script>
<script src="/frontend/web/js/select2.js"></script>
<script src="/frontend/web/js/ru.js"></script>

<!--
<script src="/frontend/web/js/pastefromoffice/pastefromoffice.js"></script>
<script src="/frontend/web/js/pastefromoffice/normalizers/googledocsnormalizer.js"></script>
<script src="/frontend/web/js/pastefromoffice/normalizers/mswordnormalizer.js"></script>

<script src="/frontend/web/js/pastefromoffice/filters/image.js"></script>
<script src="/frontend/web/js/pastefromoffice/filters/list.js"></script>
<script src="/frontend/web/js/pastefromoffice/filters/parse.js"></script>
<script src="/frontend/web/js/pastefromoffice/filters/removeboldwrapper.js"></script>
<script src="/frontend/web/js/pastefromoffice/filters/space.js"></script>
-->

<script src="/frontend/web/js/maskinput.js"></script>


<script src="/frontend/web/js/trumbowyg.js"></script>
<script src="/frontend/web/js/jquery-ui.min.js"></script>
<script src="/frontend/web/js/jquery-ui.ru.js"></script>

<script src="https://cdn.jsdelivr.net/npm/suggestions-jquery@latest/dist/js/jquery.suggestions.min.js"></script>


<script src="https://cdn.ckeditor.com/ckeditor5/12.3.1/classic/ckeditor.js"></script>
<script src="https://cdn.ckeditor.com/ckeditor5/12.3.1/classic/translations/ru.js"></script>

<script>
$(function() {

  $('.trumbowyg').each(function() {  
  var ths = $(this);      
  ClassicEditor
    .create( ths[0], {
        language: 'ru',
        toolbar: [ 'heading', '|', 'bold', 'italic', 'link', 'bulletedList', 'numberedList', 'blockQuote' ],
        heading: {
            options: [
                { model: 'paragraph', title: 'простой текст', class: 'ck-heading_paragraph' },
                { model: 'heading2', view: 'h2', title: 'H2 заголовок', class: 'ck-heading_heading2' },
                { model: 'heading3', view: 'h3', title: 'H3 заголовок', class: 'ck-heading_heading3' },
                { model: 'heading4', view: 'h4', title: 'H4 заголовок', class: 'ck-heading_heading4' }
            ]
        }
    })
    .then( editor => {
        ths.parent().on('blur', '.ck-content', function(){
            console.log(editor.getData());
            var th = $(this);
            var stp_id = th.closest('.recept-step').find('.stp_id');
            var vyd = $('.vyd').val();
            if (vyd == 2) return;
            $.ajax({
              url: '/ajax',
              data: {save_step: editor.getData(), item_id: $('.item_id').val(), stp_id: stp_id.val(), name:'step-desc[]', vyd: vyd},
              type: 'post',
              success: function(a){
                if ( a.length == 0 ) return;
                var aa = a.split(':');
                stp_id.val(aa[0]);
                $('.item_id').val(aa[1]);
                rearrangeSteps();
                $('.btn-go-draft').show();
                $('.or').show();
                $('button.end-of-edit').removeClass('end-of-edit').text('Отправить на модерацию');         
              } 
            });
        });
    });
});

});
</script>


<script>

  var editor_id = 0;

  $(function () {
	  
  $('img[data-version]').each(function() {
    $(this).attr( 'data-src', $(this).attr('data-src') + $(this).attr('data-version') );
  });

  lazyload();
  
  $('.fail-action img').attr('src', '/images/fail-action.png');
  
  $('.select2').select2({minimumResultsForSearch:Infinity, language: "ru"});
  //$('.select2.time-selector').select2({minimumResultsForSearch:Infinity, minimumInputLength: 0, language: "ru"});
  
  $('.select2-search').each(function() { 
  
    var i = 85;
    var theme = 'default';
    if ($(this).closest('.small-filter-select').length) { i = 70; }
    else if ($(this).closest('.node-recept-form').length) { i = 0; }
    else if ($(this).closest('.search-ingr-select-block').length) {
      i = 0;
      theme = 'default modal-search-select';
    }
    var th = $(this);
    var ninp = 1;
    if (th.attr('data-input')) ninp = th.attr('data-input');

    if (ninp == 0) {
    $(this).select2({
      language: "ru",
      width: 'calc(100% - '+i+'px)',
      maximumSelectionLength: $(this).attr('data-max-select'),
      //minimumInputLength: 2,
      theme: theme,
      sorter: function(results) {
        var query = th.parent().find('.select2-search__field').val().toLowerCase();
        console.log(query);
        if (query) {
          return results.sort(function(a, b) {
            var ind = a.text.toLowerCase().indexOf(query) - b.text.toLowerCase().indexOf(query);
            console.log(ind);
            if (ind == 0) 
              return a.text.length - b.text.length;
            else 
              return ind;
          });
        } else {
          return results;
        }
      } 
    });
    } else {

    $(this).select2({
      language: "ru",
      width: 'calc(100% - '+i+'px)',
      maximumSelectionLength: $(this).attr('data-max-select'),
      minimumInputLength: ninp,
      theme: theme,
      ajax: {
        url: '/ajax',
        data: function (params) {
          var query = {
            load_category_list: params.term, type:th.attr('data-cat_type')
          }
          return query;
        },
        processResults: function (data) {
          data = JSON.parse(data);
          console.log(data);
          return {
            results: $.map(data, function(item) {
              return {
                text: item.text,
                id: item.id
              };
            })
          };
        }
      }
    });
    }

  });
  
  $('.select2-search-ingr').each(function() { 
  
    var i = 3;
    var width = 'calc(100% - 115px)';
    var theme = 'default';
    var drop = '';
    if ($(this).closest('.node-recept-form').length) {
      i = 1;
      width = '285px';
    } else if ($(this).closest('.search-ingr-select-block').length) {
      width = '100%';
      theme = 'default modal-search-select';
      drop = 'bigdrop';
    }
        
    $(this).select2({
      language: "ru",
      width: width,
      maximumSelectionLength: i,
      minimumInputLength: 3,
      theme: theme,
      ajax: {
        url: '/ajax',
        data: function (params) {
          var query = {
            load_ingr_list: params.term,  user: '0',
          }
          return query;
        },
        processResults: function (data) {
          data = JSON.parse(data);
          console.log(data);
          return {
            results: $.map(data, function(item) {
              return {
                text: item.text,
                id: item.id
              };
            })
          };
        }
      }
    });
  });
  
  
  
  $.datepicker.setDefaults($.datepicker.regional['ru']);
  $(".birthday-input").datepicker({changeMonth:true, changeYear:true, dateFormat:'dd.mm.yy', yearRange: "-100:-10",});
  
  $('img.calendar').click(function() {
    $(".birthday-input").focus();
  });
  
   $('.access-block .editprofile-button').click(function() {
   
              $('.success-action span').text('Изменения сохранены');
              $('.success-action').show();
              setTimeout( function() {
                $('.success-action').fadeOut('slow');
              }, 4000);    
    
   });

   $('.info-block .editprofile-button').click(function() {
       $.ajax ({
          url: document.location.href,
          data:  $('.info-block form').serialize(),
          type: 'post',
          success: function(ans) { 
            if (ans.length >10) {
              $('.fail-action span').text(ans);
              $('.fail-action').show();
              setTimeout( function() {
                $('.fail-action').fadeOut('slow');
              }, 4000);
            } else {  
              $('.sidebar.user-menu .username').text($('.info-block form .profile-input-text[name="name[0]"]').val() + ' ' + $('.info-block form .profile-input-text[name="name[1]"]').val());
              $('.success-action span').text('Изменения сохранены');
              $('.success-action').show();
              setTimeout( function() {
                $('.success-action').fadeOut('slow');
              }, 4000);
            }  
          }
      });  
      return false;
   });
   
   $('.success-action .close, .fail-action .close').click(function() {
      $(this).parent().fadeOut('slow');
   });
   
   

   /*
   $('.info-block .editprofile-button').click(function() {
     $(this).closest('form').submit();
   });*/
   
   if (!IS_TOUCH_DEVICE /*  !navigator.userAgent.match(/(iPod|iPhone|iPad)/)  */ ) {
     //$("html").niceScroll({autohidemode: false, cursorborder: '1px solid rgb(204, 204, 204)', cursorwidth:10, cursorcolor:'rgb(218, 218, 218)', railpadding:{top:0,right:5,left:0,bottom:0}});
     //$(".dialog-wrapper").niceScroll({autohidemode: false, cursorborder: '1px solid rgb(204, 204, 204)', cursorwidth:10, cursorcolor:'rgb(218, 218, 218)'});
     $("#scrollx-wrapper").niceScroll({autohidemode: true, cursorborder: 'none', cursorwidth:0, cursorcolor:'#fff'});
     $(".friend-scrollx-wrapper").niceScroll({autohidemode: true, cursorborder: 'none', cursorwidth:0, cursorcolor:'#fff'});

    /*  
    $("#scrollx").draggable({ 
      cursor: "move",  
      axis: "x",          
      stop: function() { 
        if(jQuery(this).position().left > 1 )
          jQuery(this).css("left", "0");
        }
    });	  
    */
  } 

    if (document.body.clientWidth <= 768) {
       var width=0, ncatbut=0;

       $('.category-buttons-block .category-btn').each(function(){
         width += $(this).outerWidth() + 8;
         ++ncatbut;
         if (ncatbut == $('.category-buttons-block .category-btn').length ) {
           console.log($(this).width());
           width += $('.category-buttons-block .cat-separator').length * 20;
           $('.category-buttons-block').width(width);
           if (!IS_TOUCH_DEVICE ) {
             $(".category-buttons-block-wrapper").niceScroll({autohidemode: true, cursorborder: 'none', cursorwidth:0, cursorcolor:'#fff'});
           }
         }
       });

     }
   

  
    var set_user_active = true;
  
    $(document).mousemove(function() { 
      if (set_user_active) {
        $.ajax ({
            url: '/ajax',
            data: { set_user_activity: 1 },
            type: 'post'
        });
        set_user_active = false;
        setTimeout(
          function() { set_user_active = true; },
          20000
        );
      }
    });
    
    $.ajax ({
            url: '/ajax',
            data: { set_user_activity: 1 },
            type: 'post'
    });
  
    $('input[type=number]').styler();
    $('input[type=radio]').styler();
    $('input[type=checkbox]').styler();
    $('.access_table select.wo-search').select2({minimumResultsForSearch:Infinity, language: "ru", width:'150px', theme:'default wo-border'});
    $('select.with-search').styler({selectSearch:true});
    
    //$('select.measure_select').styler({selectPlaceholder:'Выберите'});
    
    $('select.product-list-menu-select, select.dialog-menu-select, select.ban-menu-select').select2(
      {minimumResultsForSearch:Infinity, language: "ru", theme: 'default border-select'}
    );
    
    $(document).on('click', '.new-message', function() {
    
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }   
        $.ajax({
          url: "/modal",
          method: "POST",
          data: { modal:'#dialogModalBox' },
          success: function(ans) { 
            $('#dialogModalBox').empty().append(ans);
            $('#dialogModalBox').find(".comment-textarea").rte({content_css_url: "/css/rte.css", media_url: "",});
            var y = window.pageYOffset; 
            hideScroll(y);
            
            $('#dialogModalBox').modal('show');         
          }
        });       
    });

    $(document).on('click', '.toowner-group', function() {
    
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }   
        $.ajax({
          url: "/modal",
          method: "POST",
          data: { modal:'#toownerModalBox', group_id: $(this).attr('data-group_id'), group_name: $(this).attr('group_name') },
          success: function(ans) { 
            $('#toownerModalBox').empty().append(ans);
            var y = window.pageYOffset; 
            hideScroll(y);
            
            $('#toownerModalBox').modal('show');         
          }
        });       
    });  
    
    $(document).on('click', '.toadmin-group', function() {
    
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }   
        $.ajax({
          url: "/modal",
          method: "POST",
          data: { modal:'#toadminModalBox', group_id: $(this).attr('data-group_id') },
          success: function(ans) { 
            $('#toadminModalBox').empty().append(ans);
            var y = window.pageYOffset; 
            hideScroll(y);
            
            $('#toadminModalBox').modal('show');         
          }
        });       
    });  

    
    $(document).on('keyup', '.ingr_selected .jq-selectbox__search input, .ingr-select-in-filter .jq-selectbox__search input, .search-ingr-select-block .jq-selectbox__search input', function() {
    
      var th = $(this);
      
      if ( event.keyCode >=33 && event.keyCode <= 40 || event.keyCode == 13 ) return;
      
      if ( th.val().length >= 3 ) {
          $.ajax({
            url: '/ajax',
            data: { load_ingr_list: th.val() },
            type: 'post',
            success: function(list) {
              th.closest('.ingr-block').find('select').empty().append(list).trigger('refresh');
              /*
              th.closest('.ingr-block').find('ul').empty();
              th.closest('.ingr-block').find('select.ingr_selected option').each(function() {
                th.closest('.ingr-block').find('ul').append('<li style="">'+$(this).text()+'</li>');
              });
              */
            }
          });      
      }
      
    });
    
    
    $(document).on('click', '.circle-select', function() { 
      if ($(this).hasClass('blocked')) return;
      if ($(this).hasClass('all-select')) {
        if ($(this).hasClass('checked')) {
          $('.circle-select:not(.blocked)').removeClass('checked');
        } else {
          $('.circle-select:not(.blocked)').addClass('checked');
        }
      } else {
        $(this).toggleClass('checked');
      }
    });
    
    $('.delete-all-dialogs').click(function() {

        $.ajax({
          url: "/modal",
          method: "POST",
          data: { modal:'#dialogConfirmBox' },
          success: function(ans) { 
            $('#dialogConfirmBox').empty().append(ans);
            var y = window.pageYOffset; 
            hideScroll(y);
            $('#dialogConfirmBox').modal('show');         
          }
        });   
    });
    
    $(document).on('click', '.modal-confirm-delete', function() {
        $('.selector-dialog:not(.blocked)').each(function() {
          var sel = $(this);
          $.ajax({
            url: '/ajax',
            data: { delete_dialog: $(this).attr('dialog-id') },
            type: 'post',
            success: function(ans) {
              sel.closest('.dialog-in-list').remove();
              $('.number-dialogs').text($('.number-dialogs').text()*1-1);
              $('#dialogConfirmBox').modal('hide'); 
            }
          });
        });    
    });
    

    $(document).on('click', '.delete-dialog', function() {
          var sel = $(this);
          $.ajax({
            url: '/ajax',
            data: { delete_dialog: $(this).attr('dialog-id') },
            type: 'post',
            success: function(ans) {
              sel.closest('.dialog-in-list').remove();
              $('.number-dialogs').text($('.number-dialogs').text()*1-1);
            }
          });
    
    });
    
    $(document).on('click', '.pin', function() {
    
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
     
          var sel = $(this);
          var data;
          if (sel.attr('group_id') !== undefined) data = { top_group: $(this).attr('data-group_id') };
          else if (sel.attr('photo_id') !== undefined) data = { top_photo: $(this).attr('photo_id') };
          else if (sel.attr('album_id') !== undefined) data = { top_album: $(this).attr('album_id') };
          else if (sel.attr('list_id') !== undefined) data = { top_list: $(this).attr('list_id') };
          else if (sel.attr('post_id') !== undefined) data = { top_post: $(this).attr('post_id') };
          else  data = { top_dialog: $(this).attr('dialog-id') };
          
          console.log (data);
          $.ajax({
            url: '/ajax',
            data: data,
            type: 'post',
            success: function(ans) {
              if ( sel.find('img').attr('src') == '/images/pin-orange.png')
                sel.find('img').attr('src', '/images/pin-black.png');
              else 
                sel.find('img').attr('src', '/images/pin-orange.png');
                
              if (sel.attr('list_id') !== undefined) {
                $('.shoping-wrapper').load(document.location.href + ' .shoping-inner');
              } else if (sel.attr('photo_id') !== undefined || sel.attr('album_id') !== undefined) {
                $('.photo-list-wrapper').load(document.location.href + ' .photo-list-inner');
                $('.album-list-wrapper').load(document.location.href + ' .album-list-inner');
              } else if (sel.attr('post_id') !== undefined) {
                $('.important-post-list').load(document.location.href + ' .important-post-list-inner');
                $('.normal-post-list').load(document.location.href + ' .normal-post-list-inner');
              }
              
            }
          });
         return false;
    });
    
        
    $('.dialog-menu-select').change(function() {
      if ($(this).val() == 1) {
        $('.selector-dialog.checked').each(function() {
          var sel = $(this);
          $.ajax({
            url: '/ajax',
            data: { delete_dialog: $(this).attr('dialog-id') },
            type: 'post',
            success: function(ans) {
              sel.closest('.dialog-in-list').remove();
              $('.number-dialogs').text($('.number-dialogs').text()*1-1);
            }
          });
        });
      } else if ($(this).val() == 2) {
        $('.selector-dialog.checked').each(function() {
          var sel = $(this);
          $.ajax({
            url: '/ajax',
            data: { user_ban: sel.attr('ban-id') },
            type: 'post',
            success: function(ans) {
              $.ajax({
                url: '/ajax',
                data: { delete_dialog: sel.attr('dialog-id') },
                type: 'post',
                success: function(ans) {
                  sel.closest('.dialog-in-list').remove();
                  $('.number-dialogs').text($('.number-dialogs').text()*1-1);
                }
              });
            }
          });
        });
      } else if ($(this).val() == 3) {
        $('.selector-ban.checked').each(function() {
          var sel = $(this);
          $.ajax({
            url: '/ajax',
            data: { delete_ban: $(this).attr('ban-id') },
            type: 'post',
            success: function(ans) {
              sel.closest('.ban-in-list').remove();
            }
          });
        });
      }
    });
    
    
    $('.delete-all-bans').click(function() {
        $('.selector-ban').each(function() {
          var sel = $(this);
          $.ajax({
            url: '/ajax',
            data: { delete_ban: $(this).attr('ban-id') },
            type: 'post',
            success: function(ans) {
              sel.closest('.ban-in-list').remove();
            }
          });
        });    
    });
    
    $('.delete-ban').click(function() {
          var sel = $(this);
          $.ajax({
            url: '/ajax',
            data: { delete_ban: $(this).attr('ban-id') },
            type: 'post',
            success: function(ans) {
              sel.closest('.ban-in-list').remove();
            }
          });
    
    });
    
    
    $(document).on('keyup', '.search-username', function() {
      var th = $(this);
      if (th.val().length >=3 ) {
          $.ajax({
            url: '/ajax',
            data: { search_username: th.val() },
            type: 'post',
            success: function(ans) {
              if (ans.length) {
                $('.search-username-list').empty().append(ans).show();
                $('.error-form').hide();
              }
            }
          });       
      } else {
        $('.search-username-list').empty().hide();
      }
    });
    
    $(document).on('click', '.search-username-list li', function() {
    
      $('.search-username').val($(this).attr('value'));
      $('.search-username-list').hide();
    });
    
    $(document).on('click', '.modal-addmessage', function() {

     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
     
    
       //console.log($('.search-username').val(), $('textarea#new-message').val() );
       
       var file_data = $('#dialogModalBox').find('.comment_image').eq(0).prop('files');
    
       if ( $('.search-username').val() != '' && ( $('textarea#new-message').val() != '' || file_data.length ) ) {
       
       
        var form_data = new FormData();
	    
	    if (file_data.length) {
          for (var i=0; i<Math.min(3, file_data.length); i++) {
            if ($('#dialogModalBox').find('.file-list span').eq(i).hasClass('deleted')) continue;
            form_data.append('comment_image['+i+']', file_data[i]);
          }
        //console.log(form_data);
	      $.ajax({
	        url: '/ajax',
	        dataType: 'text',
	        cache: false,
	        contentType: false,
	        processData: false,
	        data: form_data,
	        type: 'post',
	        success: function(ans){        
        
              $.ajax({
                url: '/ajax',
                data: { create_dialog: $('.search-username').val(), message: $('textarea#new-message').val()+ans },
                type: 'post',
                success: function(ans) {
                 //console.log(ans);
                  if (ans.length) {
                    document.location.href = ans;
                  } else {
                    $('.form-error').show();
                  }
                 }
               });      
             }
           });
         } else {       

          $.ajax({
            url: '/ajax',
            data: { create_dialog: $('.search-username').val(), message: $('textarea#new-message').val() },
            type: 'post',
            success: function(ans) {
              //console.log(ans);
              if (ans.length) {
                document.location.href = ans;
              } else {
                $('.form-error').show();
              }
            }
          }); 
         }   
       } else {
         if ( $('.search-username').val() == '') {
           $('.fail-action span').text('Не выбран получатель');
           $('.fail-action').show();
           setTimeout( function() {
             $('.fail-action').fadeOut('slow');
           }, 4000);         
         } else if ( $('textarea#new-message').val() == '' && file_data.length == 0 ) {
           $('.fail-action span').text('Пустое сообщение');
           $('.fail-action').show();
           setTimeout( function() {
             $('.fail-action').fadeOut('slow');
           }, 4000);         
         }
       
       
       }     
    });
    

    $(document).on('keyup', '.search-username-ingroup', function() {
      var th = $(this);
 
          $.ajax({
            url: '/ajax',
            data: { search_username_ingroup: th.val(), group_id: $(this).closest('.modal').find('.group_id').val() },
            type: 'post',
            success: function(ans) {
              if (ans.length) {
                $('.search-username-list-ingroup').empty().append(ans).show();
                $('.error-form').hide();
              }
            }
          });       

    });
    
    $(document).on('focus', '.search-username-ingroup', function() {
      var th = $(this);
 
          $.ajax({
            url: '/ajax',
            data: { search_username_ingroup: th.val(), group_id: $(this).closest('.modal').find('.group_id').val() },
            type: 'post',
            success: function(ans) {
              if (ans.length) {
                $('.search-username-list-ingroup').empty().append(ans).show();
                $('.error-form').hide();
              }
            }
          });       

    });
    
    $(document).on('click', '.search-username-list-ingroup li', function() {
    
      $('.search-username-ingroup').val($(this).attr('value'));
      $('.search-username-list-ingroup').hide();
    });
    
    $(document).on('click', '.modal-job-send', function() {
    
       if ( $('.search-username-ingroup').val() != '') {    

          $.ajax({
            url: '/ajax',
            data: { create_job: $('.search-username-ingroup').val(), 
                    group_id: $(this).closest('.modal').find('.group_id').val(), 
                    type: $(this).closest('.modal').find('.type').val(), 
                    confirm_code: $(this).closest('.modal').find('.confirm-code').val() 
                  },
            type: 'post',
            success: function(ans) {
                  if (ans.length) {
                  
                          $('.success-action span').text('Предложение отправлено');
                          $('.success-action').show();
                          setTimeout( function() {
                              $('.success-action').fadeOut('slow');
                          }, 4000);   
                          
                          $('.modal').modal('hide');
                  } else {
                    $('.form-error').show();
                  }             
            }
          }); 
          
       }       
    });
    
    $(document).on('click', '.cancel-job', function() {
         var th = $(this);
         $.ajax({
            url: '/ajax',
            data: { cancel_job: $(this).attr('message_id') },
            type: 'post',
            success: function(ans) {
              th.closest('.message-buttons').remove();
            }
          });     
    
    });
    
    $(document).on('click', '.confirm-job', function() {
         var th = $(this);
         $.ajax({
            url: '/ajax',
            data: { confirm_job: $(this).attr('message_id') },
            type: 'post',
            success: function(ans) {
              th.closest('.message-buttons').remove();
            }
          });     
    
    });
    
    $(document).on('click', '.delete-option', function() {
      
      var cat_id = $(this).closest('.selected_option').attr('value');
      var item = $(this).closest('.form-item');
      var th = $(this).parent().parent().parent().find('select');
        
        if ( cat_id && item.find('select').hasClass('recept-filter-select') ) {
          $('.filter-block').addClass('ajax-waiting');
          
          $.ajax({
            url: '/ajax',
            data: { delete_recept_cat: cat_id, recept_id:$('.item_id').val(), cat_type: $(this).closest('.filter-select').find('select').attr('data-cat_type') },
            type: 'post',
            success: function() {
              load_filtered_recepts();
            }
          });   
        }  
        

        
      if ( item.find('.selected_fields span.selected_option').length==1 && item.find('select').hasClass('required') ) {
        setTimeout(function() {
          item.find('select').val('').trigger('refresh');
          item.find('.jq-selectbox__select').css('borderColor','red');
          item.find('select').addClass('required-error');
        }, 1)
      } else {
        item.find('select').removeClass('required-error');
        item.find('.jq-selectbox__select').css('borderColor','rgba(204,204,204,0.5)');
      }    
      
      
      
      $(this).parent().remove();
      
      item.find('.limit-sel').hide();
      
      th.val('').attr('placeholder', '').trigger('refresh');
      if ( item.find('.selected_fields span.selected_option').length==0 ) {
         th.closest('.jq-selectbox').find('.jq-selectbox__select-text.placeholder').text(th.closest('.jq-selectbox').find('select').attr('data-placeholder'));
      } else {
         th.closest('.jq-selectbox').find('.jq-selectbox__select-text.placeholder').text('');
      }
      
      
      var new_height = th.parent().parent().find('.selected_fields').height() + 14;
      var ob_new_height = th.closest('.jq-selectbox').find('.jq-selectbox__select');
        
      ob_new_height.css('borderColor','rgba(204,204,204,0.5)').height( new_height );
      th.closest('.jq-selectbox').find('.jq-selectbox__dropdown').css('marginTop', (new_height-32)+'px');
      
      $('div.jqselect').css({zIndex: 9}).removeClass('opened');
        
    });
  
    var dropZone = $('.dropzone'), dropZoneStep = $('.dropzone-step'), body = $('body');
        maxFileSize = 10000000; // максимальный размер фалйа - 1 мб.
    
    // Проверка поддержки браузером
    if (typeof(window.FileReader) == 'undefined') {
        dropZone.text('Не поддерживается браузером!');
        dropZone.addClass('error');
    }
    
    
    
    
    if (dropZone.length) {
    // Добавляем класс hover при наведении
    dropZone[0].ondragover = function() {
        dropZone.addClass('hover');
        return false;
    };
    
    
    // Убираем класс hover
    dropZone[0].ondragleave = function() {
        dropZone.removeClass('hover');
        return false;
    };
    
    dropZone[0].ondrop = function(event) {
        event.preventDefault();
        dropZone.removeClass('hover');
        var file = event.dataTransfer.files[0];        
        loadFile (file, dropZone.parent() );  
    };
    
    }
    
    
    document.ondragover = function() {
        return false;
    };
    
    document.ondrop = function(event) {
        //alert('---');
        event.preventDefault();
        return false;
    };
    
    $(document).on('click', '.dropzone, .dropzone-step', function() {
      $(this).parent().find('.form-file').click();
    });
    
    $(document).on('change', '.form-file', function() {
      var file = $(this).prop('files')[0];
      if ($(this).hasClass('group-file'))
        loadFileGroup (file, $(this).closest('.back-image'));
      else
        loadFile (file, $(this).closest('.back-image'));
    });
    
    // Обрабатываем событие Drop
    
    
    document.ondrop = function(event) {
      event.preventDefault();
      return false;
    };
    
    // Показываем процент загрузки
    function uploadProgress(event) {
        var percent = parseInt(event.loaded / event.total * 100);
        dropZone.find('#upload-instructions--2').text('Загрузка: ' + percent + '%');
    }
    
    // Пост обрабочик
    function stateChange(event) {
        if (event.target.readyState == 4) {
            if (event.target.status == 200) {
                dropZone.find('#upload-instructions--2').text('Загрузка успешно завершена!');
            } else {
                dropZone.find('#upload-instructions--2').text('Произошла ошибка!');
                dropZone.addClass('error');
            }
        }
    }

  
  
function get_cookie ( cookie_name )
{
  var results = document.cookie.match ( '(^|;) ?' + cookie_name + '=([^;]*)(;|$)' );
 
  if ( results )
    return ( unescape ( results[2] ) );
  else
    return null;
}

   $(document).on('submit', '.no-subscribe', function() {
     var user_id = $('.user_id').val();
     var email = $('.subscribe-input input');
     
     if (email.length) email = email.val();
     else email = '';
     $.ajax({
        url: "/ajax",
        method: "POST",
        data: { do_subscribe: email, user_id: user_id },
        success: function(a) { 
           $('.no-subscribe').hide();
           $('.yes-subscribe').show(); 
           $('.success-action span').text('Вы подписались');
              $('.success-action').show();
              setTimeout( function() {
                $('.success-action').fadeOut('slow');
           }, 4000);   
        }
     }); 
     return false;
   });
   
   $(document).on('submit', '.yes-subscribe', function() {
     var user_id = $('.user_id').val();
     
     $.ajax({
        url: "/ajax",
        method: "POST",
        data: { undo_subscribe: 'YES', user_id: user_id },
        success: function(a) { 
           $('.yes-subscribe').hide();
           $('.no-subscribe').show();        
        }
     }); 
     return false;
   });


    

   $(document).on('change', '.comment_image', function() {
      $('.file-list').empty().append ("<img class='paper-clip' alt='' src='/images/paper-clip.png'>");
      var file_data = $(this).prop('files');
      
      for (var i=0; i<Math.min(3, file_data.length); i++) {
        //console.log (file_data[i]);
        if (file_data[i].size < 5000000) {
          $('.file-list').append(' <span>'+file_data[i].name+' <img class="image-delete" alt="" src="/images/close.png"></span>'); 
        } 
      }
    });
    
    $(document).on('click', '.image-delete', function() {
      
      $(this).parent().addClass('deleted');
    });

    var modal_category_html = ['', '', '', ''];

    $(document).on('click', '.second_list', function() {
      var th = $(this);
      var back_text = th.closest('.category-modal-child-column').find('a').eq(0).find('span').text();
      modal_category_html[$('.mobil-back-navigator').attr('data-level')*1] = th.closest('.modal-content').html();
      if ($(document).width() < 991) {
        $.ajax({
          url: "/ajax",
          method: "POST",
          data: { load_subcats : th.attr('data-cat_id') },
          success: function(a) { 
            if (a.length) {
                var res = $('<div />');
                res.append(a);
                var first = res.find('a').eq(0).clone();
                res.find('a').eq(0).remove();
                th.closest('.modal-body').find('.category-modal-child-column > a').remove();
                th.closest('.modal-body').find('.category-modal-child-column').prepend(first);
                th.closest('.modal-body').find('.subcat-list').empty().append(res);
                $('.mobil-back-navigator span').text(back_text);
                $('.mobil-back-navigator').attr('data-level', $('.mobil-back-navigator').attr('data-level')*1+1);              
            } else {
              document.location.href = th.attr('data-href');
            }
         }
        });
        return false;
      } else if (true || !th.hasClass('active')) {
        $('.third-level-list').remove();
        $('.second_list').removeClass('active');
        if (th.find('.fa').hasClass('fa-caret-up')) {
          th.find('.fa').addClass('fa-caret-down').removeClass('fa-caret-up');
          return false;
        }
        th.addClass('active');
        $('.second_list .fa').addClass('fa-caret-down').removeClass('fa-caret-up');
        th.find('.fa').removeClass('fa-caret-down').addClass('fa-caret-up');
        $.ajax({
          url: "/ajax",
          method: "POST",
          data: { load_subsubcats : th.attr('data-cat_id') },
          success: function(a) { 
            var num = th.index();
            num = (Math.floor(num/3) + 1) * 3 - 1;
            th.parent().find('a').eq(num).after(a);
          }
        });        
        return false;
      } else {
        document.location.href = th.attr('data-href');
      }   
    })

    $(document).on('click', '.mobil-back-navigator', function() {
      var th = $(this);
      if (th.attr('data-level') == 0 ) {
        return;
      } else {
        th.attr('data-level', th.attr('data-level')*1 - 1);
        $('#category-modal .modal-content').html(modal_category_html[th.attr('data-level')*1]);
      }
      if (th.attr('data-level') == 0) {
        $('#category-modal').addClass('top-level');
      }

    })
    
    $(document).on('click', '.category-button.top-list', function() {
    
      var th = $(this);
      modal_category_html[0] = th.closest('.modal-content').html();
      if (!th.hasClass('active') || $(document).width() < 991) {
        $.ajax({
          url: "/ajax",
          method: "POST",
          data: { load_subcats : th.attr('data-cat_id') },
          success: function(a) { 
            if (a.length) {
              if (th.closest('.modal').length == 0)
                th.parent().find('.subcat-list').empty().append(a);
              else {
                var res = $('<div />');
                res.append(a);
                var first = res.find('a').eq(0).clone();
                res.find('a').eq(0).remove();
                th.closest('.modal-body').find('.category-modal-child-column > a').remove();
                th.closest('.modal-body').find('.category-modal-child-column').prepend(first);
                th.closest('.modal-body').find('.subcat-list').empty().append(res);
                th.closest('.modal-body').scrollTop(0);
                $.ajax({
                  url: "/ajax",
                  method: "POST",
                  data: { load_random_recept : th.attr('data-cat_id') },
                  success: function(recs) {
                    recs = JSON.parse(recs);
                    var rand_rec = th.closest('.modal-body').find('.random-recept');
                    rand_rec.empty();
                    for (var i = 0; i < recs.length; i++ ) {
                      var a = recs[i];
                      rand_rec.append(
'<div class="carcass">' +
'<a class="link-block" href="/recipes/'+a.alias+'">'+
  '<div class="carcass-foto super-small">'+
    '<img alt="" class="img-responsive" src="'+a.image+'"  title="'+a.name+', рецепт с фото." width="205" height="150">'+
  '</div>'+
'</a>'+
'<a class="link-block" href="/recipes/'+a.alias+'"><div class="carcass-title">'+a.name+'</div></a>'+
'</div>'
                      );
                    }
                  }
                })

                if ($(document).width() < 991) {
                  $('.category-modal-parent-column').hide();
                  $('.category-modal-child-column').show();
                } 
                $('.mobil-back-navigator span').text('Категории');
                $('.mobil-back-navigator').attr('data-cat_id', 0).attr('data-level', 1);
                $('#category-modal').removeClass('top-level');
              }
              th.parent().find('.category-button.top-list').removeClass('active');
              th.addClass('active');
              //$('html').getNiceScroll().resize();
            } else {
              document.location.href = th.attr('data-href');
            }
         }
        });
      } else if (th.attr('data-href') != '') {
        document.location.href = th.attr('data-href');
      }        
    });
/*
  $(document).on('click', '.recept .fa-star', function() {
    //$(this).parent().find('.izbr_form').submit();
    var user_id = $('.user_id').val();
    var th = $(this);
    
  if (th.hasClass('orange')) {  
    if ( user_id != 0 ) {  
      $.ajax({
        url: "/ajax",
        method: "POST",
        data: { del_izbr : th.attr('data-recept_id'), user_id: user_id },
        success: function(a) { 
        
           $('.recept .fa-star[recept_id='+th.attr('data-recept_id')+']').removeClass('orange').addClass('white');
           if (document.location.href.indexOf('izbr') + 1) {
             th.closest('.recept').remove();
           }
        }
      });
    } else {
      var izbr = get_cookie('izbr' );
      izbr = izbr.split(',');
      var idx = izbr.indexOf($(this).attr('data-recept_id'));
      console.log(izbr);
      if (idx != -1) izbr.splice(idx, 1);
      console.log(idx, izbr);
      izbr = izbr.join(',');
      document.cookie = "izbr="+izbr+"; path=/; expires=01/01/2030 00:00:00";
      $('.recept .fa-star[recept_id='+th.attr('data-recept_id')+']').removeClass('orange').addClass('white');
      if (document.location.href.indexOf('izbr') + 1) {
             th.closest('.recept').remove();
      }
      return false;    
    }
  } else {
    if ( user_id != 0 ) { 
      $.ajax({
        url: "/ajax",
        method: "POST",
        data: { izbr : th.attr('data-recept_id'), user_id: user_id },
        success: function(a) { 
           $('.recept .fa-star[recept_id='+th.attr('data-recept_id')+']').removeClass('white').addClass('orange');
        }
      });    
    } else {
      var izbr = get_cookie('izbr' );
      console.log(izbr);
      if (izbr)
        izbr = izbr.split(',');
      else 
        izbr = [];
      
      if ( izbr.indexOf(th.attr('data-recept_id')) == -1 )
        izbr.push(th.attr('data-recept_id'));
      izbr = izbr.join(',');
      document.cookie = "izbr="+izbr+"; path=/; expires=01/01/2030 00:00:00";
      $('.recept .fa-star[recept_id='+th.attr('data-recept_id')+']').removeClass('white').addClass('orange');
    
      return false;    
    }
  }
  return false;
  });
*/
    //jQuery.colorbox.settings.maxWidth  = '80%';
    //jQuery.colorbox.settings.maxHeight = '80%';
  
    //$(".colorbox").colorbox({rel:'colorbox', transition:"none", width:"1000px"});
    
    //$(".comment-colorbox").colorbox({rel:'comment-colorbox', transition:"none"});
    //$(".message-colorbox").colorbox({rel:'message-colorbox', transition:"none" });
    
    $(document).on('change', 'select.required', function() {
        $(this).removeClass('required-error');
        $(this).parent().find('.select2-selection').css('borderColor','#e5e5e5');
        $(this).parent().find('.form-error').hide();
    });
    
    $(document).on('change', 'input[type=hidden].required', function() {
      if ($(this).val() == '') {
        $(this).parent().find('input[type=file]').addClass('required-error');
      } else {
        $(this).parent().find('input[type=file]').removeClass('required-error');
      }
    });
    
    $(document).on('change', 'input[type=checkbox].required', function() {
      if ($(this).prop('checked') === false ) {
        $(this).addClass('required-error');
      } else {
        $(this).removeClass('required-error');
      }
    });
    
    
    $(document).on('change', 'select.with_selected_fields', function() {
      var th = $(this);
      var sel_num = th.parent().parent().find('.selected_fields span.selected_option').length;
      var sel_num_eq = 0;
      if (th.val() != '') 
        sel_num_eq = th.parent().parent().find('.selected_fields span.selected_option[value='+th.val()+']').length;
        
      if ( th.val() && sel_num < th.attr('data-max-select') && sel_num_eq == 0 ) {
        if (th.hasClass('recept-filter-select')) {
          $('.filter-block').addClass('ajax-waiting');
          
          $.ajax({
            url: '/ajax',
            type: 'post', 
            data: { set_session_filter_param: th.val(), cat_type: th.attr('data-cat_type') },
            success: function () {
              if (th.parent().parent().find('.selected_fields').hasClass('wo-ajax')) {
                load_filtered_recepts();
              }
              
              $('.sort-block .sort').removeClass('active');
              $('.sort-block .sort[data-sort=relevant]').addClass('active');
            }
          });
        }
        var delpng = 'delete_option.png';
        if (th.closest('.search-window').length) delpng = 'modal_delete_option.png';
        th.parent().parent().find('.selected_fields').append("<span class='selected_option' value='"+th.val()+"'>"+th.find('option:selected').text()+" <span class='delete-option'><img alt='' src='/images/"+delpng+"'></span></span>");
        //th.val('').attr('placeholder', '').trigger('refresh');
        th.closest('.jq-selectbox').find('.jq-selectbox__select-text.placeholder').text('');
        $('.jq-selectbox__dropdown').hide();
        th.removeClass('required-error');
        
      } else if ( sel_num >= $(this).attr('data-max-select') && sel_num_eq == 0 ) {
        $(this).closest('.form-item').find('.limit-sel').show();
      }
      
      th.val('').attr('placeholder', '').trigger('refresh');
      th.closest('.jq-selectbox').find('.jq-selectbox__select-text.placeholder').text('');
      
      var new_height = th.parent().parent().find('.selected_fields').height() + 14;
      var ob_new_height = th.closest('.jq-selectbox').find('.jq-selectbox__select');
        
      ob_new_height.css('borderColor','rgba(204,204,204,0.5)').height( new_height );
      th.closest('.jq-selectbox').find('.jq-selectbox__dropdown').css('marginTop', (new_height-32)+'px');
      
      $('div.jqselect').css({zIndex: 9}).removeClass('opened');
         
    });
    
    $(document).on('change', '.select2-search.multiple, .select2-search-ingr.multiple', function() {
      var th = $(this);
        
      if ( true || th.val()  ) {
        if (th.hasClass('recept-filter-select')) {          
          $('.filter-block').addClass('ajax-waiting');
          
          load_filtered_recepts();
          $('.sort-block .sort').removeClass('active');
          $('.sort-block .sort[data-sort=relevant]').addClass('active');
        }
        
        th.removeClass('required-error');
        
      }
         
    });
   
    
    $('select.ajax_category_save').change(function() {
          var th = $(this);
          if ( th.hasClass('required-error')) return;
          var cat = $(this).val().length == 0 ? [0]: $(this).val();
          $.ajax({
            url: '/ajax',
            data: {save_category: cat, item_id: $('.item_id').val(), name:th.attr('data-cat_type'), vyd: $('.vyd').val()},
            type: 'post',
            success: function(a){
              $('.item_id').val(a);
              $('.btn-go-draft').show();
              $('.or').show();
              
              $('button.end-of-edit').removeClass('end-of-edit').text('Отправить на модерацию'); 
/*            
      $('.success-action span').text('Сохранено');
      $('.success-action').show();
      setTimeout( function() {
        $('.success-action').fadeOut('slow');
      }, 4000);             
*/            
            
            } 
         });               
    });
    
    $(document).on('change', 'input.ingr-save-ajax, select.ingr-save-ajax', function() {
          var th = $(this);
          var ing_id = th.closest('.ingr-block').find('.ing_id');
          var group_id = th.closest('.ingr-group-block').find('.group_id');
          
          if ( th.hasClass('required-error')) return;
          $.ajax({
            url: '/ajax',
            data: {save_ingridient: $(this).val(), group_id: group_id.val(), item_id: $('.item_id').val(), ing_id: ing_id.val(), name:th.attr('name'), vyd: $('.vyd').val()},
            type: 'post',
            success: function(a){
              if ( a == '') return;
              var data = a.split(':');
              ing_id.val(data[0]);
              $('.item_id').val(data[1]);
              console.log(th.attr('name'),th.find('option:checked').attr('not_rq'));
              if (th.attr('name') == 'measure[]') {
                if ( th.find('option:checked').attr('not_rq') == 1 ) {
                  th.closest('.ingr-block').find('.number-ingr input').removeClass('required').css('border','1px solid rgb(226,226,226)');
                } else {
                  th.closest('.ingr-block').find('.number-ingr input').addClass('required');
                }
              }
              if (th.attr('name') == 'quantity[]') {
                th.val(data[2]);
              }
              $('button.end-of-edit').removeClass('end-of-edit').text('Отправить на модерацию'); 
/*
      $('.success-action span').text('Сохранено');
      $('.success-action').show();
      setTimeout( function() {
        $('.success-action').fadeOut('slow');
      }, 4000); 
*/

            },
            error: function() {
              if (th.attr('name') == 'quantity[]') {
                th.val('');
                $('.fail-action span').text('Некорректное значение, введите число');
                $('.fail-action').show();
                setTimeout( function() {
                  $('.fail-action').fadeOut('slow');
                }, 4000); 
              }
            }
         });     
    });
    
    $(document).on('change', 'input.ingr-groop-save-ajax', function() {
          var th = $(this);
          var group_id = th.closest('.ingr-group-block').find('.group_id');
          var group_id_val = group_id.val();
          if (group_id_val == '') group_id_val = 0;
          if ( th.hasClass('required-error')) return;
          var ingr_in_group = [];
          th.closest('.ingr-group-block').find('.ingr-block').each(function(){
            ingr_in_group.push( $(this).find('.ing_id').val() );
          });
          $.ajax({
            url: '/ajax',
            data: {save_group_ingridient: $(this).val(), group_id: group_id_val, ingr_in_group:ingr_in_group, item_id: $('.item_id').val(), vyd: $('.vyd').val() },
            type: 'post',
            success: function(a){
            
            
/*
      $('.success-action span').text('Сохранено');
      $('.success-action').show();
      setTimeout( function() {
        $('.success-action').fadeOut('slow');
      }, 4000);
*/

              var data = a.split(':');
              group_id.val(data[0]);
              $('.item_id').val(data[1]);
              if (group_id_val == 0 ) {
                th.closest('.ingr-group-blocks').find('.ingr-group-block').each(function () {
                  var cur_group_id = $(this).find('.group_id');
                  var cur_group_name = $(this).find('.ingr-groop-save-ajax');
                  if ( cur_group_id.val() == 0 && cur_group_name.val() == 'Основные') {
                    cur_group_name.change();
                    rearrangeGroups();
                  }
                });
 /*               
                th.closest('.ingr-group-block').find('.ingr-block').each(function () {
                  var ing_id = $(this).find('.ing_id').val();
                  console.log('ингридиент', ing_id);
                  if( ing_id != 0 && ing_id != '' ) {
                    $.ajax({
                      url: '/ajax',
                      data: { set_new_group: a, ing_id: ing_id },
                      type: 'post'
                    });                
                  }
                });
*/



              }
              $('button.end-of-edit').removeClass('end-of-edit').text('Отправить на модерацию'); 
            } 
         });     
    });
    
    $(document).on('change', '.header-type-select', function() {
      var input = $(this).closest('.recept-step').find('.step-save-ajax');
      var size = $(this).val().replace('H','');
      
      input.attr('placeholder', 'Добавьте заголовок '+$(this).val()).attr('ps', 'Добавьте заголовок '+$(this).val()).attr('size', size);
      input.removeClass('input-header-2');
      input.removeClass('input-header-3');
      input.removeClass('input-header-4');
      input.addClass('input-header-'+size);
      
	  if (input.val() != '')
        input.change();
    });
    
     $(document).on('change', '.step-save-ajax', function() {
          var th = $(this);
          var stp_id = th.closest('.recept-step').find('.stp_id');
          //if ( th.hasClass('required-error')) return;
          console.log('======= vyd ========', $('.vyd').val());
          if ($('.vyd').val() == 2) return;
          $.ajax({
            url: '/ajax',
            data: {
              save_step: $(this).val(), 
              item_id: $('.item_id').val(), 
              stp_id: stp_id.val(), 
              name:th.attr('name'), 
              size:th.attr('size'), 
              vyd: $('.vyd').val()
            },
            type: 'post',
            success: function(a){
              if ( a.length == 0 ) return;
              var data = a.split(':');
              stp_id.val(data[0]);
              $('.item_id').val(data[1]); 
              
/*              
      $('.success-action span').text('Сохранено');
      $('.success-action').show();
      setTimeout( function() {
        $('.success-action').fadeOut('slow');
      }, 4000);
*/              
              rearrangeSteps();  
              $('button.end-of-edit').removeClass('end-of-edit').text('Отправить на модерацию');         
            } 
         });     
    });
    
    $(document).on('change', '.image-from-url input', function() {
          var th = $(this);
          var stp_id = th.closest('.recept-step').find('.stp_id');
          $.ajax({
            url: '/ajax',
            data: {image_from_url: $(this).val(), item_id: $('.item_id').val(), stp_id: stp_id.val() },
            type: 'post',
            success: function(a){
              a = a.split('$$$$');
              var bl = th.closest('.recept-step').find('.back-image');
              th.closest('.recept-step').find('input[type=hidden]').val(a[0]);
              bl.css('background', 'url(/images/recepts/original/'+a[0]+')').css('backgroundSize', 'cover').css('backgroundPosition', 'center center');
              bl.find('.form-error').hide();
              stp_id.val(a[1]);
              rearrangeSteps();
            } 
         });        
    
    });
    
    
    $(document).on('change', 'select.ingr_selected', function() {
          var th = $(this);
          $.ajax({
            url: '/ajax',
            data: {load_measures:$(this).val()},
            type: 'post',
            success: function(a){
              th.parent().parent().find('select.measure_select').empty().append(a).trigger('change');        
            } 
         });     
    });
  
    $(document).on('click','.field-add-more-submit.new-ingr', function() {
      var new_row =  $(
           "<div class='ingr-block'>"+
               "<span class='drag-ingr'> "+
                   "<img alt='' src='/images/drag.png'> "+
                "</span>"+
                "<span class='select-ingr'> "+
                   "<select  data-placeholder='Выберите ингрeдиент' multiple data-max-select='1' class='select2-search-ingr multiple ingr-save-ajax ingr_selected bottom-border required' data-toggle='tooltip' name='ingridient[]' data-original-title='Если какой-то ингредиент отсутствует в списке, сообщите об этом администратору сайта и мы внесем недостающий ингредиент в систему.'>"+
                   "</select> "+
                "</span> "+
                "<span class='number-ingr'> "+
                   " <input placeholder='Кол-во' class='ingr-save-ajax required' type='text' name='quantity[]' value=''> "+
                " </span> "+
                "<span class='mesuare-ingr'>"+
                    "<select  data-placeholder='Выберите' class='select2 ingr-save-ajax measure_select bottom-border required' name='measure[]'>"+
                    "</select>"+
                  
                "</span>"+
                "<span class='delete-ingr' > "+
                  "<img alt='' src='/images/delete_option.png'> "+
                "</span> "+
                "<input class='ing_id' type='hidden' value='0'>"+
           "</div>");
      
      //new_row.find('select.wo-search').styler({selectSearch:false, selectVisibleOptions: 10});
      //new_row.find('select.measure_select').styler({selectPlaceholder:'Выберите'});
      new_row.find('.delete-ingr').show();
      new_row.find('.drag-ingr').css('visibility', 'visible');
      new_row.find('.ing_id').val('0');
      $(this).parent().parent().find('.ingr-blocks').append(new_row).find('.delete-ingr').show();
      $(this).parent().parent().find('.ingr-blocks').find('.drag-ingr').css('visibility', 'visible');
      $('.ingr-block').arrangeable({dragSelector: '.drag-ingr', dragCallback: rearrangeIngrs});
      new_row.find('select.select2-search-ingr').select2({
        language: "ru",
        width: '285px',
        maximumSelectionLength: 1,
        minimumInputLength: 3,
        ajax: {
          url: '/ajax',
          data: function (params) {
            var query = {
              load_ingr_list: params.term,
            }
            return query;
          },
          processResults: function (data) {
            data = JSON.parse(data);
            console.log(data);
            return {
              results: $.map(data, function(item) {
                return {
                  text: item.text,
                  id: item.id
                };
              })
            };
          }
        }
      });
      new_row.find('select.measure_select').select2({minimumResultsForSearch:Infinity, language: "ru"});
      //$('html').getNiceScroll().resize();
      
    });
    
    
    $('.field-add-more-submit.new-ingr-group').click(function() {
    
      $('.edit-pencil').show();
      
      var new_row =  $(
      
            "<div class='ingr-group-block enabled'> "+
              "<div class='ingr-group-title'> "+
                "<span class='drag-ingr-group'> "+
                   "<img alt='' src='/images/drag.png'> "+
                "</span> "+
                "<span  class='ingr-group-name'> "+
                  "<input placeholder='Название группы, например: Для теста' class='ingr-groop-save-ajax required' type='text' name='group_name[]' value=''> "+
                  "<img class='edit-pencil' alt='' src='/images/pencil.png' style='display:none;'> "+
                  "<input type='hidden' class='group_id' name='group_id' value='0'> "+
                "</span> "+
                "<span class='delete-ingr-group' > "+
                  "<img alt='' src='/images/delete_option.png'> "+
                "</span> "+
            "</div> "+
            "<div class='ingr-blocks'> "+
           "<div class='ingr-block'>"+
               "<span class='drag-ingr'> "+
                   "<img alt='' src='/images/drag.png'> "+
                "</span>"+
                "<span class='select-ingr'> "+
                   "<select  data-placeholder='Выберите ингрeдиент' multiple data-max-select='1' class='select2-search-ingr multiple ingr-save-ajax ingr_selected bottom-border required' data-toggle='tooltip' name='ingridient[]' data-original-title='Если какой-то ингредиент отсутствует в списке, сообщите об этом администратору сайта и мы внесем недостающий ингредиент в систему.'>"+
                   "</select> "+
                "</span> "+
                "<span class='number-ingr'> "+
                   " <input placeholder='Кол-во' class='ingr-save-ajax required' type='text' name='quantity[]' value=''> "+
                " </span> "+
                "<span class='mesuare-ingr'>"+
                    "<select  data-placeholder='Выберите' class='select2 ingr-save-ajax measure_select bottom-border required' name='measure[]'>"+
                    "</select>"+
                  
                "</span>"+
                "<span class='delete-ingr' > "+
                  "<img alt='' src='/images/delete_option.png'> "+
                "</span> "+
                "<input class='ing_id' type='hidden' value='0'>"+
           "</div>"+
           "</div>"+
            "<div class='clearfix'>"+
              "<div class='field-add-more-submit new-ingr form-submit ajax-processed' name='field_recept_ingr_field_add_more' value='Добавить ещё'><span>+</span> Ингредиент в группу</div>"+
              "</div>"+
            "</div>"
           );
      
      new_row.find('.ingr-groop-save-ajax').val('');
      new_row.find('.group_id').val('0');
      new_row.find('.ing_id').val('0');
      new_row.find('.delete-ingr-group').show();
      new_row.find('.edit-pencil').hide();

      
      $(this).parent().parent().find('.ingr-group-blocks').append(new_row).find('.delete-ingr-group').show();
      $('.ingr-group-block').arrangeable({dragSelector: '.drag-ingr-group', dragCallback: rearrangeGroups});
      $('.ingr-block').arrangeable({dragSelector: '.drag-ingr', dragCallback: rearrangeIngrs});
      
      new_row.find('select.select2-search-ingr').select2({
        language: "ru",
        width: '285px',
        maximumSelectionLength: 1,
        minimumInputLength: 3,
        ajax: {
          url: '/ajax',
          data: function (params) {
            var query = {
              load_ingr_list: params.term,
            }
            return query;
          },
          processResults: function (data) {
            data = JSON.parse(data);
            console.log(data);
            return {
              results: $.map(data, function(item) {
                return {
                  text: item.text,
                  id: item.id
                };
              })
            };
          }
        }
      });
      new_row.find('select.measure_select').select2({minimumResultsForSearch:Infinity, language: "ru"});
      
      //$('html').getNiceScroll().resize();
    });
    
    $(document).on('focusin', '.ingr-groop-save-ajax', function() {
      $(this).parent().find('.edit-pencil').hide();
    });
    
    $(document).on('click', '.edit-pencil', function() {
      $(this).parent().find('.ingr-groop-save-ajax').focus();
    });
    
function getWidth(elem) {
    
    var fontSize = elem.css('fontSize');
    var fontWeight = elem.css('fontWeight');
    var newSpan = document.createElement('span');
    newSpan.style.fontSize = fontSize;
    newSpan.style.fontWeight = fontWeight;
    newSpan.style.margin = '0px';
    newSpan.style.padding = '0px';
    newSpan.style.maxWidth = 'unset';
    newSpan.innerHTML = elem.val();
    console.log(newSpan.innerHTML);
    document.body.appendChild(newSpan);
    var width = newSpan.offsetWidth;
    newSpan.remove()
    return width*1+13;
}

    $(document).on('focusout', '.ingr-groop-save-ajax', function() {
      if ($(this).val() != '') {
        $(this).parent().find('.edit-pencil').show().css('left', getWidth($(this)) +'px' );
      }
      if ( $('.ingr-group-block').length == 1 ) {
        $('.edit-pencil').hide();
      }
    });
    
    $(document).on('focusin', '.ingr-groop-save-ajax', function() {
      if ( $('.ingr-group-block').length == 1 ) {
        $('.fail-action span').text('Нельзя редактировать название единственной группы');
        $('.fail-action').show();
        setTimeout( function() {
          $('.fail-action').fadeOut('slow');
        }, 4000); 
        $(this).blur();
      }
    });
    
    
   
    $('.ingr-groop-save-ajax').each(function() {
      if ($(this).val() != '') {
        $(this).parent().find('.edit-pencil').show().css('left', getWidth($(this)) +'px' );
      }
    });
    
    if ( $('.ingr-group-block').length == 1 ) {
      $('.edit-pencil').hide();
    }

    
    $('.field-add-more-submit.new-step').click(function() {
      var new_row = $(this).parent().parent().find('.recept-step').eq(0).clone();
      var num = $(this).parent().parent().find('.recept-step').length + 1;
      new_row.find('input, select').val('');
      new_row.find('.step_id').val(0);
      new_row.find('textarea').val('');
      new_row.find('.step-number').text('Шаг '+ num);
      new_row.find('.back-image').css('background','none');
      
      new_row.find('.for-hide').show();
      new_row.find('.help-block').show();
      new_row.find('.rotaion-buttons').hide();
      new_row.find('.back-image').css('height', '140px');
      new_row.find('.dropzone-step').css( 'backgroundImage', "url('/images/lined-rect.png')" ).css('height', '140px');
      
      if (num > 3) {
        new_row.find('.remove-button').show();
      }
      $(this).parent().parent().find('.recept-steps').append(new_row);
      //$('html').getNiceScroll().resize();
      $('.recept-step').arrangeable({dragSelector: '.drag-step', dragCallback: rearrangeSteps});
    });
    
    $(document).on('click', '.new-step-sovet .icon.picture, .new-step-sovet .icon.text, .new-step-sovet .icon.headers, .new-step-sovet .icon.link, .new-step-sovet .icon.video', function() {
      var string = '';
      var vyd = $('.vyd').val();
      var word = 'тему';
      if (vyd == 1) word='совет';
      var word1 = 'которая';
      if (vyd == 1) word1='который';
      if ($(this).hasClass('picture')) {
      
        string = '\r\n\
             <div class="recept-step"> \r\n\
              <div class="">\r\n\
                <span class="drag-step"><img alt="" src="/images/drag.png"></span>\r\n\
                <span class="step-delete remove-button" style="display:none;">Удалить</span>\r\n\
              </div>\r\n\
              <div class="back-image" style="">\r\n\
                <div class="dropzone-step"  ondragover="$(this).addClass(\'hover\'); return false;" ondragleave="$(this).removeClass(\'hover\');return false;" ondrop="event.preventDefault(); $(this).removeClass(\'hover\'); var file = event.dataTransfer.files[0]; loadFile (file, $(this).parent() );">\r\n\
                  <label class="control-label" for="edit-field-about-recept-und-0-value">\r\n\
                    <div class="for-hide"><img alt="" src="/images/picture.png"></div>\r\n\
                    <div class="for-hide">Загрузите фото\r\n\
                      <span class="form-required" title="Это поле обязательно для заполнения.">*</span>\r\n\
                    </div>\r\n\
                    <div class="progressbar">\r\n\
                      <div class="indicator"></div>\r\n\
                    </div>\r\n\
                  </label>\r\n\
                  <div class="help-block">\r\n\
                     <div id="upload-instructions--2" class="element-invisible help-block">\r\n\
                       Размер файла не более 10 мб\r\n\
                     </div>\r\n\
                     <div class="form-error">Добавьте фото</div>\r\n\
                  </div>\r\n\
                </div>\r\n\
                <div class="rotaion-buttons">\r\n\
                  <img class="rotation-left" alt="" src="/images/rotate-photo-left.png">\r\n\
                  <img class="rotation-right" alt="" src="/images/rotate-photo-right.png">\r\n\
                </div>\r\n\
                <input class="form-control form-file" type="file" size="22" accept="image/jpeg,image/png,image/gif,image/webp" style="display:none;">\r\n\
                <input class="required" type="hidden" value="" name="step_image[]">\r\n\
                <input class="stp_id" type="hidden" value="0">\r\n\
                <span class="button-site-url"><img alt="" src="/images/link.png"></span>\r\n\
              </div>\r\n\
              <div class="image-from-url">\r\n\
                <input type="text" placeholder="Ссылка на фото с другого сайта">\r\n\
              </div>\r\n\
              <div class="show-add-step-block"><img alt="" src="/images/plus-block.png"></div>\r\n\
            </div>';
      }
      
      if ($(this).hasClass('text')) {
      
        string = "\r\n\
              <div class='recept-step'>\r\n\
              <div class=''>\r\n\
                <span class='drag-step'><img alt='' src='/images/drag.png'></span>\r\n\
                <span class='step-delete remove-button' style='display:none;'>Удалить</span>\r\n\
                <input class='stp_id' type='hidden' value=''>\r\n\
              </div>\r\n\
              <div class='field-type-text-long field-name-field-desc-step field-widget-text-textarea form-wrapper form-group' >\r\n\
                        <div class='form-error step-desc'>Добавьте текст</div>\r\n\
                        <textarea placeholder='Добавьте текст. Не копируйте тексты с других сайтов в интернете. Пишите своими словами. Мы оставляем за собой право удалить "+word+", "+word1+" содержит текст, написанный не вами, так как он нарушает правила сайта.' min_size='2' class='trumbowyg step-save-ajax text-full form-control form-textarea required' name='step-desc[]' cols='60' rows='5'></textarea>\r\n\
              </div>\r\n\
              <div class='show-add-step-block'><img alt='' src='/images/plus-block.png'></div>\r\n\
            </div>";
      }
      
      
      if ($(this).hasClass('headers')) {
      
        string = "\r\n\
              <div class='recept-step'>\r\n\
              <div class=''>\r\n\
                <span class='drag-step'><img alt='' src='/images/drag.png'></span>\r\n\
                <span class='header-type-select-wrapper'>\r\n\
                <select class='select2 header-type-select'>\r\n\
                  <option selected>H2</option>\r\n\
                  <option>H3</option>\r\n\
                  <option>H4</option>\r\n\
                </select>\r\n\
                </span>\r\n\
                <span class='step-delete remove-button' style='display:none;'>Удалить</span>\r\n\
                <input class='stp_id' type='hidden' value=''>\r\n\
              </div>\r\n\
              <div class='form-item form-item-title form-type-textfield form-group'>\r\n\
                <input class='newrecept-name form-control form-text step-save-ajax required input-header-"+$(this).attr('type')+"' placeholder='Добавьте заголовок H"+$(this).attr('type')+"' type='text' name='step_title[]' size='"+$(this).attr('type')+"'>\r\n\
                <div class='form-error title'>Вы не заполнили поле</div>\r\n\
              </div>\r\n\
              <div class='show-add-step-block'><img alt='' src='/images/plus-block.png'></div>\r\n\
            </div>";
        }
        
     if ($(this).hasClass('link')) {
      
        string = "\r\n\
              <div class='recept-step'>\r\n\
              <div class=''>\r\n\
                <span class='drag-step'><img alt='' src='/images/drag.png'></span>\r\n\
                <span class='step-delete remove-button' style='display:none;'>Удалить</span>\r\n\
                <input class='stp_id' type='hidden' value=''>\r\n\
              </div>\r\n\
              <div class='form-item form-item-title form-type-textfield form-group'>\r\n\
                <div><input class='stp_id' type='hidden' value=''></div>\r\n\
                <div class='row'>\r\n<div class='col-md-6' style='padding: 2px 10px 0 0;'>\r\n\
                  <input class='step-save-ajax required simple half' placeholder='Добавьте ссылку' type='text' name='step_link_url[]'>\r\n\
                </div>\r\n\
                <div class='col-md-6' style='padding: 0 0 0 10px;'>\r\n\
                  <input class='step-save-ajax required simple half' placeholder='Добавьте текст ссылки' type='text' name='step_link_text[]'></div></div>\r\n\
                <div class='form-error title'>Вы не заполнили поле</div>\r\n\
              </div>\r\n\
              <div class='show-add-step-block'><img alt='' src='/images/plus-block.png'></div>\r\n\
            </div>";
        }
        
      if ($(this).hasClass('video')) {
      
        string = "\r\n\
              <div class='recept-step'>\r\n\
              <div class=''>\r\n\
                <span class='drag-step'><img alt='' src='/images/drag.png'></span>\r\n\
                <span class='step-delete remove-button' style='display:none;'>Удалить</span>\r\n\
                <input class='stp_id' type='hidden' value=''>\r\n\
              </div>\r\n\
              <div class='form-item form-item-title form-type-textfield form-group'>\r\n\
                <input class='step-save-ajax required simple' placeholder='Добавьте ссылку на видео' type='text' name='step_video[]'>\r\n\
                <div class='form-error title'>Вы не заполнили поле</div>\r\n\
              </div>\r\n\
              <div class='show-add-step-block'><img alt='' src='/images/plus-block.png'></div>\r\n\
            </div>";
        }
      
      
      if (string != '') {
        var new_row = $( $.parseHTML(string));
        new_row.find('input, select').val('');
        new_row.find('.step_id').val(0);
        new_row.find('textarea').val('');
        new_row.find('.back-image').css('background','none');
        new_row.find('.remove-button').show();
        
        var new_block;
        
        if ( $(this).closest('.recept-step').length ) {
          $(this).closest('.recept-step').after(new_row);
          new_block = $(this).closest('.recept-step').next();
        } else {
          $(this).closest('.form-item').find('.recept-steps').append(new_row);
          new_block = $(this).closest('.form-item').find('.recept-steps .recept-step:last');
        }
        
        if ($(this).hasClass('headers')) {
          new_block.find('select').select2({minimumResultsForSearch:Infinity, language: "ru"});
          new_block.find('select').val('H2').trigger('change');
        }
        
        if ($(this).hasClass('text')) {

  ClassicEditor
    .create( new_block.find('.trumbowyg' )[0], {
        language: 'ru',
        toolbar: [ 'heading', '|', 'bold', 'italic', 'link', 'bulletedList', 'numberedList', 'blockQuote' ],
        heading: {
            options: [
                { model: 'paragraph', title: 'простой текст', class: 'ck-heading_paragraph' },
                { model: 'heading2', view: 'h2', title: 'H2 заголовок', class: 'ck-heading_heading2' },
                { model: 'heading3', view: 'h3', title: 'H3 заголовок', class: 'ck-heading_heading3' },
                { model: 'heading4', view: 'h4', title: 'H4 заголовок', class: 'ck-heading_heading4' }
            ]
        }
    })
    .then( editor => {
        new_block.on('blur', '.ck-content', function(){
            //console.log(editor.getData());
            var th = $(this);
            var stp_id = th.closest('.recept-step').find('.stp_id');
            var vyd = $('.vyd').val();
            if (vyd == 2) return;
            $.ajax({
              url: '/ajax',
              data: {save_step: editor.getData(), item_id: $('.item_id').val(), stp_id: stp_id.val(), name:'step-desc[]', vyd: vyd},
              type: 'post',
              success: function(a){
                if ( a.length == 0 ) return;
                var aa = a.split(':');
                stp_id.val(aa[0]);
                $('.item_id').val(aa[1]);
                rearrangeSteps();
                $('.btn-go-draft').show();
                $('.or').show(); 
                $('button.end-of-edit').removeClass('end-of-edit').text('Отправить на модерацию');         
              }
            });
            //$("#addNewPost .modal-body").getNiceScroll().resize();
        });
        //$("#addNewPost .modal-body").getNiceScroll().resize();
    } );

        }

        //$("#addNewPost .modal-body").getNiceScroll().resize();

        if ( $(this).closest('.recept-step').length ) {
          $(this).closest('.new-step-sovet').remove();
        }

        $('.recept-step').arrangeable({dragSelector: '.drag-step', dragCallback: rearrangeSteps});
      }
    });
    
    
    $(document).on('click', '.button-site-url', function() {
      $(this).closest('.recept-step').find('.image-from-url').toggle();        
      //$("#addNewPost .modal-body").getNiceScroll().resize();
    });
    
    $(document).on('click', '.delete-ingr', function() {
      if ($(this).closest('.ingr-blocks').find('.ingr-block').length > 1 ) {
        
        var ing_id = $(this).closest('.ingr-block').find('.ing_id').val();
        var ing_blocks = $(this).closest('.ingr-blocks');
        $(this).parent().remove();
        
        if (ing_blocks.find('.ingr-block').length == 1) {
           ing_blocks.find('.delete-ingr').hide();
           ing_blocks.find('.drag-ingr').css('visibility', 'hidden');
        }
        
        if (ing_id) {
          $.ajax({
            url: '/ajax',
            data: {delete_ingr: ing_id},
            type: 'post'
          });   
        }  
      } else {
        $('.fail-action span').text('Нельзя удалить ингредиент, если он единственный');
        $('.fail-action').show();
        setTimeout( function() {
          $('.fail-action').fadeOut('slow');
        }, 4000); 
      }
    });
    
    
    if ($('.ingr-group-block').length == 1) {
        $('.delete-ingr-group').hide();
    }
    
    $(document).on('click', '.delete-ingr-group', function() {
      if ($(this).closest('.ingr-group-blocks').find('.ingr-group-block').length > 1 ) {
      
        var able = true;
        var group_id = $(this).closest('.ingr-group-block').find('.group_id').val();
        
        $(this).closest('.ingr-group-block').find('.ingr-block').each(function() {
          if ( $(this).find('.select-ingr select').val() != '' ) {
            able = false;
          }
        });
      
        if ( !able ) {
          var y = window.pageYOffset; 
          hideScroll(y);
          $('#ingrGroupDelConfirmBox').modal('show');
          $('#ingrGroupDelConfirmBox .ingr_group_id').val(group_id);
          $('.ingr-group-block').removeAttr('will_delete');
          $(this).closest('.ingr-group-block').attr('will_delete', 1)
          return;      
        }
        
        var group_blocks = $('.ingr-group-blocks');
        $(this).closest('.ingr-group-block').remove();
        
        if (group_blocks.find('.ingr-group-block').length == 1) {
           group_blocks.find('.delete-ingr-group').hide();
        }
        
        if (group_id) {
          $.ajax({
            url: '/ajax',
            data: {delete_ingr_group: group_id},
            type: 'post'
          });   
        }  
      } else {
        $('.fail-action span').text('Нельзя удалить группу, если она единственная');
        $('.fail-action').show();
        setTimeout( function() {
          $('.fail-action').fadeOut('slow');
        }, 4000);  
      }
    });
    
    $(document).on('click', '.ingr-group-modal-confirm-delete', function() {
        var group_blocks = $('.ingr-group-blocks');
        var group_id = $('#ingrGroupDelConfirmBox .ingr_group_id').val();
        
        $('.ingr-group-block[will_delete=1]').remove();
        
        if (group_blocks.find('.ingr-group-block').length == 1) {
           group_blocks.find('.delete-ingr-group').hide();
        }
        
        if (group_id) {
          $.ajax({
            url: '/ajax',
            data: {delete_ingr_group: group_id},
            type: 'post'
          });   
        }     
        
        $('#ingrGroupDelConfirmBox').modal('hide');
    });
    
    
    $(document).on('click', '.remove-button', function() {
      if ( $(this).closest('.recept-steps').find('.recept-step').length > 1 || $('.vyd').val() == 1 || $('.vyd').val() == 2 ) {
        var stp_id = $(this).closest('.recept-step').find('.stp_id').val();
        
        $(this).parent().parent().remove();
        renumSteps ();
        
        if (stp_id) {
          $.ajax({
            url: '/ajax',
            data: {delete_step: stp_id},
            type: 'post'
          });   
        }  
      } else {
        $('.fail-action span').text('Нельзя удалить шаг, если он единственный');
        $('.fail-action').show();
        setTimeout( function() {
          $('.fail-action').fadeOut('slow');
        }, 4000); 
      }
    });
  
    $(document).on('change', 'input[type=text].required, input[type=number].required', function() {
      
      if ( $(this).val() == 0 || $(this).val() == '') {
        $(this).addClass('required-error');
        $(this).parent().find('.form-error').show();
        $(this).closest('.jq-number__field').css('borderColor','red');
        $(this).css('borderColor','red');
      } else {
        $(this).removeClass('required-error');
        $(this).parent().find('.form-error').hide();
        $(this).closest('.jq-number__field').css('borderColor','rgb(226,226,226)');
        $(this).css('borderColor','rgb(226,226,226)');
      }
    });
    
    $(document).on('change', 'input[type=radio].required', function() { 
      var th = $(this);
      setTimeout ( function() {   
        var name =  th.attr('name');
        $('input[name='+name+']').removeClass('required-error').removeAttr('checked');
        $('input[name='+name+']').closest('.jq-radio').css('borderColor','#C3C3C3').removeClass('checked');
        th.attr('checked','checked');
        th.closest('.jq-radio').addClass('checked');
      }, 100);
    });
    
    $(document).on('change', 'select.time-required', function() { 
      var time_sel = 0;
      $('select.time-required').each(function() {
        if( $(this).val() == 0 ) time_sel++; 
      });
      if( time_sel == 3 ) {
        $('select.time-required').each(function() {
          $(this).addClass('required-error');
          $(this).parent().find('.select2-selection').css('borderColor','red');
        });
      } else {
        $('select.time-required').each(function() {
          $(this).removeClass('required-error');
          $(this).parent().find('.select2-selection').css('borderColor','#e5e5e5');
        });
      }
    });
    
    $(document).on('change', 'textarea.required', function() {

     if ($(this).hasClass('newrecept-name')) { 
        if ($(this).val().length < $(this).attr('min_size') || $(this).val().length > 140 ) {

            $(this).addClass('required-error');
            $(this).parent().find('.form-error').show();
        } else {
            $(this).removeClass('required-error');
            $(this).parent().find('.form-error').hide();
        }      
     } else {
        if ($(this).val().length < $(this).attr('min_size') ) {

            $(this).addClass('required-error');
            $(this).parent().find('.form-error').show();
        } else {
            $(this).removeClass('required-error');
            $(this).parent().find('.form-error').hide();
        } 
     }
    });
    
    $(document).on('keyup', 'textarea', function() {
      if ($(this).hasClass('newrecept-name')) {
        var l = 140-$(this).val().length;
        $(this).parent().find('.simbol-counter').text('Осталось ' + l + ' знаков');
        if (l<0) {
          $(this).parent().find('.simbol-counter').css('color', 'red');
        } else {
          $(this).parent().find('.simbol-counter').css('color', '#000');
        }
      } else {
        $(this).parent().find('.simbol-counter span').text(Math.max(0,200-($(this).val().length)));
      }
    });
    
    $(document).on('change', '.video-input', function() {
        if ( $(this).val() != '' && ! isYoutube ( $(this).val() ) )  {
            $(this).addClass('required-error');
            $(this).parent().find('.form-error').show();
        } else {
            $(this).removeClass('required-error');
            $(this).parent().find('.form-error').hide();
        } 
    });
    
    

  $(document).on('click', '.set-subscribe', function() {
  
       
      show_login ();
      
      return false;
      
      });
  
   $('.show-login').click(function() {
     $('.user-profile-dropdown-menu').hide();
     show_login ();
   });
    
        
    $(document).on('click', '.del-group', function() {
    
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
     
      var gr_name = $(this).attr('group_name');
            
      $.ajax({
        url: '/ajax',
        data: {send_code:gr_name},
        type: 'post',
        success: function(a) {
        
           if ( a.length > 5 ) {
             $('.fail-action span').text(a);
             $('.fail-action').show();
             setTimeout( function() {
               $('.fail-action').fadeOut('slow');
             }, 4000); 
             return false;
           } 
           
           $.ajax({
             url: "/modal",
             method: "POST",
             data: { modal:'#groupdelConfirmBox' },
             success: function(ans) { 
               $('#groupdelConfirmBox').empty().append(ans);
               
               $('#groupdelConfirmBox').find('.group-name-del').text(gr_name);
               $('#groupdelConfirmBox').find('.group-id').val($(this).attr('data-group_id'));
               $('#groupdelConfirmBox').find('.confirm-code').val('');
               var y = window.pageYOffset; 
               hideScroll(y);
            
               $('#groupdelConfirmBox').modal('show');         
             }
           });  
        }
      });
      return false;
    });
    
    $(document).on('click', '.deleteprofile-button', function() {
            
      $.ajax({
        url: '/ajax',
        data: {send_user_code:1},
        type: 'post',
        success: function(a) {
           $.ajax({
             url: "/modal",
             method: "POST",
             data: { modal:'#userdelConfirmBox' },
             success: function(ans) { 
               $('#userdelConfirmBox').empty().append(ans);
               
               $('#userdelConfirmBox').find('.confirm-code').val('');
               var y = window.pageYOffset; 
               hideScroll(y);
            
               $('#userdelConfirmBox').modal('show');         
             }
           });  
        }
      });
      return false;
    });
   
    $(document).on('click', '.ajax-processed-image', function() {
      
      var th = $(this);
      var bl = $(this).parent().parent().parent();
      if( bl.find('input[type=file]').prop('files').length ) {
        var file_data = $(this).parent().parent().find('input').prop('files')[0];
        console.log (file_data);
        if (file_data.size < 10000000) {
	      var form_data = new FormData();
          form_data.append('recept', file_data);
          var name = bl.find('input[type=hidden]').prop('name');
          form_data.append('name', name );
          form_data.append('item_id', $('.item_id').val());
          if (name == 'step_image[]') 
            form_data.append('stp_id', th.closest('tr').find('.stp_id').val());
          $.ajax({
            url: '/ajax',
            dataType: 'text',
            cache: false,
            contentType: false,
            processData: false,
            data: form_data,
            type: 'post',
            success: function(a){
              a = a.split('$$$$');
              bl.find('input[type=hidden]').val(a[0]);
              bl.find('img').attr('src', '/images/recepts/original/'+a[0]).show();
              if (name == 'step_image[]') { 
                th.closest('tr').find('.stp_id').val(a[1]);
              } else {
                $('.item_id').val(a[1]);
                
                $('.btn-go-draft').show();
                $('.or').show();
              }
        
            }
          });      
      
      
      
        //$('.profile_image_title').text(file_data.name); 
        } else {
          alert('Размер файла превышает допустимый'); 
        }
      } else {
        alert('Выберите файл'); 
      }
      return false;
    });
    
  $(document).on('click', '.show-add-step-block', function() {
  
    if ($(this).closest('.recept-step').find('.new-step-sovet').length) return;
  
    var clone = $('.new-step-sovet.for-clone').clone();
    
    clone.removeClass('for-clone');
    
    $(this).closest('.recept-step').append(clone);
  });
    
  $(".abuse-group").click(function() {
       var th = $(this);
       $.ajax({
          url: "/modal",
          method: "POST",
          data: { modal:'.abuseGroupBox' },
          success: function(ans) { 
            $('.abuseModalBox').empty().append(ans);
            var y = window.pageYOffset; 
            hideScroll(y);
            if (th.attr('data-group_id')) {
              $('.abuseModalBox').find('.object_type').val(3); 
              $('.abuseModalBox').find('.object_id').val(th.attr('data-group_id')); 
            } else {
              $('.abuseModalBox').find('.object_type').val(2); 
              $('.abuseModalBox').find('.object_id').val(th.attr('data-recept_id')?th.attr('data-recept_id'):th.attr('recept_id')); 
            }
            $('.abuseModalBox').modal('show');         
          }
        });  
  
  });
  
  $(".abuse-modal-show, .abuse-item").click(function() {
  
    $('.dropdown-menu-recept-comands-list').hide();
    $('html').css('overflowY','auto');

       $.ajax({
          url: "/modal",
          method: "POST",
          data: { modal:'#abuseModalBox' },
          success: function(ans) { 
            $('#abuseModalBox').empty().append(ans);
            var y = window.pageYOffset; 
            hideScroll(y);
            
            $('#abuseModalBox').modal('show');         
          }
        });  
  
  });
  
  $(".abuse-sovet").click(function() {
       $.ajax({
          url: "/modal",
          method: "POST",
          data: { modal:'#abuseModalBox', sovet:1 },
          success: function(ans) { 
            $('#abuseModalBox').empty().append(ans);
            var y = window.pageYOffset; 
            hideScroll(y);
            $('#abuseModalBox').modal('show');         
          }
        });  
  });
  
  $(document).on('click', '.abuse-string', function() {
  
    $(this).find('.abuse-in-list').toggleClass('added');
  });
  
  $(document).on('click', '.send-abuse', function() {
    var able = true;
    $('#abuseModalBox .required').each(function() {
    
      if ($(this).val() == '') {
        $(this).css('border', '1px solid red');
        able = false;
      }
    
    });
   /*
    var reg = /^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;
    var val = $('#abuseModalBox input[type=email]').val();
    if(reg.test(val) == false) {
      able = false;
    }
  */
  
    if ($('#abuseModalBox input[type=email]:invalid').length) {
      able = false;
    }
    
    if (able) {
      var form = $('#abuseModalBox');
      
      var email = '';
      if ( form.find('.email').length ) email = form.find('.email').val();
      
      var text = '', povod = ''; 
      
      form.find('.abuse-string').each(function () {
        if ( $(this).find('.abuse-in-list').hasClass('added') ) {
          povod += '<p>'+$(this).text()+'</p>';
        }
      });
      
      text += '<p>'+form.find('.message').val()+'</p>';
      
      var recept_id = 0;
      if ($('.recept_id').length) recept_id = $('.recept_id').val();
      
      if ( text.length < 8 && povod.length < 8 ) {
        $('.fail-action span').text('Пустая жалоба');
        $('.fail-action').show();
        setTimeout( function() {
          $('.fail-action').fadeOut('slow');
        }, 4000);      
        return false;
      }
      
      $('#abuseModalBox').modal('hide');
      
      $.ajax({
        url: '/ajax',
        data: { send_abuse: recept_id, username: form.find('.name').length ? form.find('.name').val():'', 
        abuse_text:text, abuse_povod:povod, email:email, object_type:$('.object_type').val(),
        recaptcha_response: $('.recaptchaResponse').val() },
        type: 'post',
        success: function(a){      
           
              $('.success-action span').text('Жалоба отправлена');
              $('.success-action').show();
              setTimeout( function() {
                $('.success-action').fadeOut('slow');
              }, 4000);  
        }
      });
    }
  });
  
  $(document).on('change', '.modal input[type=email]', function() {
    $(this).closest('form').find('input[type=submit]').click();
    return false;
  });
  
  $(document).on('click', '.send-abuse-user, .send-abuse-group, .send-abuse-photo', function() {
    var able = true;
    var form = $(this).hasClass('send-abuse-photo') ? $('#onePhotoAbuse'):$('.abuseModalBox');
      
    form.find('.required').each(function() {
    
      if ($(this).val() == '') {
        $(this).css('border', '1px solid red');
        able = false;
      }
    
    });
    
    if (form.find('input[type=email]:invalid').length) {
      able = false;
    }
  
    if (able) {
      
      var email = '';
      if ( form.find('.email').length ) email = form.find('.email').val();
      
      var text = '', povod = ''; 
      
      form.find('.abuse-string').each(function () {
        if ( $(this).find('.abuse-in-list').hasClass('added') ) {
          povod += '<p>'+$(this).text()+'</p>';
        }
      });
      
      text = '<p>'+form.find('.message').val()+'</p>';
      
      var object_id = $('.object_id').val();
      
      if ( text.length < 8 && povod.length < 8 ) {
        $('.fail-action span').text('Пустая жалоба');
        $('.fail-action').show();
        setTimeout( function() {
          $('.fail-action').fadeOut('slow');
        }, 4000);      
        return false;
      }
      
      form.modal('hide');
      
      $.ajax({
        url: '/ajax',
        data: { send_abuse: object_id, username: form.find('.name').length?form.find('.name').val():'', 
        abuse_text:text, email:email, abuse_povod:povod, object_type:$('.object_type').val(),
        recaptcha_response: $('.recaptchaResponse').val()
         },
        type: 'post',
        success: function(a){      

              $('.success-action span').text('Жалоба отправлена');
              $('.success-action').show();
              setTimeout( function() {
                $('.success-action').fadeOut('slow');
              }, 4000);  
        }
      });
    }
  });
    
    

  $(document).on('click', '.nravitsya', function() {
    $(this).next().click();
  });

  $(document).on('click', '.comment-rate-button', function() {
  
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
     
     var data;
     var th = $(this);
     
     if (th.attr('data-comment_id')) {
       data = { comment_like: th.attr('data-comment_id') }; 
     } else { 
       data = { photo_comment_like: th.attr('photo_comment_id') };
     }
     
     $.ajax({ 
       url: "/ajax",
       method: "POST",
       data: data,
       success: function(a) { 
         //console.log(a.length);
         if (a.length > 1) {
           th.find('.rate-info').text( th.find('.rate-info').text()*1 + 1 );
         } else {
           th.find('.rate-info').text( th.find('.rate-info').text()*1 - 1 );
         }
       }
     });
     return false;
   });


 $(document).on('click','.ingr-for-market', function() {
  
    $(this).toggleClass('added');
    if ($(this).hasClass('common')) {
      if ($(this).hasClass('added')) $('.ingr-for-market').addClass('added');
      else $('.ingr-for-market').removeClass('added');
    }
  });

$(document).on('click', '.hide-empty-selector.off', function() {
   
    $(this).removeClass('off').addClass('on');
    $('.modal-book.empty').hide();
  
  });
  $(document).on('click', '.hide-empty-selector.on', function() {
   
    $(this).removeClass('on').addClass('off');
    $('.modal-book.empty').show();
  
  });
  

  $(document).on('click', '.flag-throbber-last', function() {
  
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
     
  
        $.ajax({
          url: "/modal",
          method: "POST",
          data: { modal:'#booksModalBox', vyd:$('.vyd').val(), rid:$('.recept_id').val()},
          success: function(ans) { 
            $('#booksModalBox').empty().append(ans);
            var y = window.pageYOffset; 
            hideScroll(y);
            
            $('#booksModalBox').modal('show');         
          }
        });   
     
  })


  $('.modal-create-book input').change(function() {
  
    $('.create-book').attr('data-book', $(this).val());
  });
  
  $(document).on('click', '.carcass-favorite .fa-star.in-book', function() {
  
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
       
  
    var user_id = $('.user_id').val();
    var th = $(this);

    $('.filter-block').addClass('ajax-waiting');
       
        $.ajax({
          url: "/ajax",
          method: "POST",
          data: { del_from_book: th.attr('data-recept_id')?th.attr('data-recept_id'):th.attr('recept_id'), user_id: user_id, book_id: th.attr('data-book_id')},
          success: function(a) { 
             load_filtered_recepts();          
          }
        });   
     return false;
  });
  
  $(document).on('click', '.carcass-favorite .fa-star.not-in-book', function() {
  
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
     
    var user_id = $('.user_id').val();
    var th = $(this);
    var y = window.pageYOffset; // запоминаем текущую прокрутку сверху
    
    if ( user_id != 0 ) {
      if ( $(this).attr('data-count')*1 == 1 ) {

        var th = $(this);
        $.ajax({
          url: "/ajax",
          method: "POST",
          data: { del_all_izbr: th.attr('data-recept_id')?th.attr('data-recept_id'):th.attr('recept_id'), user_id: user_id },
          success: function(a) { 
            th.addClass('total-reload').addClass('submit_izbr_form').removeClass('fa-star').addClass('fa-star-o').attr('data-count','0');
            var cnt = $('.eye-block .fa-star-o[recept_id='+th.attr('data-recept_id')?th.attr('data-recept_id'):th.attr('recept_id')+']' ).next();
            cnt.text( cnt.text()*1-1 );
          }
        });   
      } else {
      
         var rid = $(this).attr('data-recept_id')?$(this).attr('data-recept_id'):$(this).attr('recept_id');
         var th = $(this);
    
         $.ajax({
          url: "/modal",
          method: "POST",
          data: { modal:'.booksModalBox', rid:rid},
          success: function(ans) { 
            $('.booksModalBox').empty().append(ans);
            
            hideScroll(y);
            $('.booksModalBox').modal('show');         
          }
        });   
      }
    } else {
      var izbr = get_cookie('izbr' );
      izbr = izbr.split(',');
      var idx = izbr.indexOf($(this).attr('data-recept_id')?$(this).attr('data-recept_id'):$(this).attr('recept_id'));
      console.log(izbr);
      if (idx != -1) izbr.splice(idx, 1);
      console.log(idx, izbr);
      izbr = izbr.join(',');
      console.log("izbr="+izbr+"; expires=01/01/2030 00:00:00");
      document.cookie = "izbr="+izbr+"; path=/; expires=01/01/2030 00:00:00";
      
      $(this).addClass('submit_izbr_form').removeClass('fa-star').addClass('fa-star-o');
    }
    return false;
  });
  
  $(document).on('click', '.modal-book', function() {
    $(this).find('.modal-add-to-book, .modal-remove-from-book').click();
  });
  
  $(document).on('click', '.submit_izbr_form, .modal-add-to-book, .create-book', function() {
  
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
     
    //$(this).parent().find('.izbr_form').submit();
    var user_id = $('.user_id').val();
    
    if ( user_id != 0 ) {
      var th = $(this);
      var data;
      if (th.hasClass('create-book')) {
        data = { izbr : th.attr('data-recept_id')?th.attr('data-recept_id'):th.attr('recept_id'), user_id: user_id, bookname: th.closest('.modal-create-book').find('input').val(), vyd:$('.vyd').val() };
      } else {
        if (th.attr('data-book') == '') return;
        data = { izbr : th.attr('data-recept_id')?th.attr('data-recept_id'):th.attr('recept_id'), user_id: user_id, book: th.attr('data-book') };
      }//$('#booksModalBox').modal('hide');
      $.ajax({
        url: "/ajax",
        method: "POST",
        data: data,
        success: function(a) { 
        
          if (!th.hasClass('total-reload')) {
            $.ajax({
              url: "/modal",
              method: "POST",
              data: { modal:'#booksModalBox', vyd:$('.vyd').val(), rid:$('.recept_id').val()},
              success: function(ans) { 
                $('#booksModalBox').empty().append(ans);  
              }
            });       
            
            $('.f-star-wrapper').load(document.location.href +' .f-star-inner');
          } else {
            var rid = th.attr('data-recept_id');
            
            $.ajax({
              url: "/modal",
              method: "POST",
              data: { modal:'.booksModalBox', rid:rid},
              success: function(ans) {
         
                $('.booksModalBox').empty().append(ans);
                //$('.booksModalBox .modal-title').text(th.closest('.recept').find('.carcass-title').text());
                $('.modal-create-book input').val('');
                var recfav = $('.carcass-favorite[data-recept_id='+rid+'] .fa-star-star');
                recfav.removeClass('total-reload').removeClass('submit_izbr_form').removeClass('fa-star-o').addClass('fa-star').attr('title','').attr('data-count', recfav.attr('data-count')*1+1);
              }
            });
          }
          
          var cnt = $('.eye-block .fa-star-o[data-recept_id='+th.attr('data-recept_id')+']' ).next();
          cnt.text( cnt.text()*1+1 );
        }
      });
      return false;  
    } else {      
      var izbr = get_cookie('izbr' );
      var rid = $(this).attr('data-recept_id');
      console.log(izbr);
      if (izbr)
        izbr = izbr.split(',');
      else 
        izbr = [];
      
      if ( izbr.indexOf($(this).attr('data-recept_id')) == -1 )
        izbr.push($(this).attr('data-recept_id'));
      izbr = izbr.join(',');
      document.cookie = "izbr="+izbr+"; path=/; expires=01/01/2030 00:00:00";      
      
      $('.big-star[data-recept_id='+rid+']')
          .removeClass('white').addClass('orange')
          .removeClass('fa-star-o').addClass('fa-star')
          .removeClass('submit_izbr_form').addClass('delete_izbr_form');
      $('.flag-throbber.submit_izbr_form[data-recept_id='+rid+']').text('- Избранное')
         .removeClass('submit_izbr_form').addClass('delete_izbr_form').closest('.f-star').find('.flag-throbber-itogo span').text(
           $('.flag-throbber.delete_izbr_form[data-recept_id='+rid+']').closest('.f-star').find('.flag-throbber-itogo span').text()*1+1
         );
      $('.fa-star-star[data-recept_id='+rid+']').removeClass('fa-star-o').addClass('fa-star');
           
      return false;    
    }
  }); 
  
  $(document).on('click', '.delete_izbr_form, .modal-remove-from-book', function() {
    //$(this).parent().find('.izbr_form').submit();
    var user_id = $('.user_id').val();
    
    if ( user_id != 0 ) {
      var th = $(this);
      $.ajax({
        url: "/ajax",
        method: "POST",
        data: { del_izbr : th.attr('data-recept_id'), user_id: user_id, book: th.attr('data-book') },
        success: function(a) { 
          
        
           if (!th.hasClass('not_change') && !th.hasClass('total-reload')) {
             $('.big-star').removeClass('orange').removeClass('fa-star').addClass('white').addClass('fa-star-o');
             $('.flag-throbber.delete_izbr_form').text('+ '+$('.flag-throbber.delete_izbr_form').attr('data-bookname'));
             $('.delete_izbr_form').removeClass('delete_izbr_form').addClass('submit_izbr_form');
           }
           
           if ( th.hasClass('total-reload')) {
             var rid = th.attr('data-recept_id');
             var recfav = $('.carcass-favorite[data-recept_id='+rid+'] .fa-star-star');
             var cnt = recfav.attr('data-count')*1-1;
             
             if (cnt == 0)
               recfav.addClass('total-reload').addClass('submit_izbr_form').addClass('fa-star-o').removeClass('fa-star').attr('data-count', cnt);
             else
               recfav.removeClass('total-reload').removeClass('submit_izbr_form').removeClass('fa-star-o').addClass('fa-star').attr('data-count', cnt);
           }
           //$('.flag-throbber-last').text();
           
           $('.flag-throbber-itogo span').text($('.flag-throbber-itogo span').text()*1-1);
           $('.modal-remove-from-book[data-book='+th.attr('data-book')+']').closest('.modal-book').find('.remove > img').attr('src', '/images/book-plus.png');
           $('.modal-remove-from-book[data-book='+th.attr('data-book')+']').closest('.modal-book').find('.remove').removeClass('remove');
           $('.modal-remove-from-book[data-book='+th.attr('data-book')+']').removeClass('modal-remove-from-book').addClass('modal-add-to-book');
           var cnt = th.closest('.modal-book').find('.cnt');
           cnt.text(cnt.text()*1-1);
           
           cnt = $('.eye-block .fa-star-o[data-recept_id='+th.attr('data-recept_id')+']' ).next();
           cnt.text( cnt.text()*1-1 );
        }
      });
      return false;  
    } else {
      var izbr = get_cookie('izbr' );
      var rid = $(this).attr('data-recept_id');
      izbr = izbr.split(',');
      var idx = izbr.indexOf(rid);
      console.log(izbr);
      if (idx != -1) izbr.splice(idx, 1);
      console.log(idx, izbr);
      izbr = izbr.join(',');
      console.log("izbr="+izbr+"; expires=01/01/2030 00:00:00");
      document.cookie = "izbr="+izbr+"; path=/; expires=01/01/2030 00:00:00";
      $('.big-star[data-recept_id='+rid+']')
          .removeClass('orange').addClass('white')
          .removeClass('fa-star').addClass('fa-star-o')
          .removeClass('delete_izbr_form').addClass('submit_izbr_form');
      $('.flag-throbber.delete_izbr_form[data-recept_id='+rid+']').text('- Избранное')
         .removeClass('delete_izbr_form').addClass('submit_izbr_form').closest('.f-star').find('.flag-throbber-itogo span').text(
           $('.flag-throbber.submit_izbr_form[data-recept_id='+rid+']').closest('.f-star').find('.flag-throbber-itogo span').text()*1-1
         );
      $('.fa-star-star[data-recept_id='+rid+']').removeClass('fa-star').addClass('fa-star-o');
      if ( $(this).closest('.favorite-page').length)
        $(this).closest('.recept').remove();
      return false;    
    }
  });
  
   


   $(document).on('click','.rate-button', function() {
   
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
     
     var th = $(this);
     var data, obj, obj_name, attr_name;
     if (th.attr('data-recept_id')) {
       obj = th.attr('data-recept_id');
       obj_name = 'recept_id';
       attr_name = 'data-recept_id';
       data = { like : obj };
     } else  if (th.attr('photo_id')) {
       obj = th.attr('photo_id');
       obj_name = 'photo_id';
       attr_name = 'photo_id';
       data = { like_photo : obj };
     } else {
       obj = th.attr('album_id');
       obj_name = 'album_id';
       attr_name = 'album_id';
       data = { like_album : obj };
     }
     $.ajax({
       url: "/ajax",
       method: "POST",
       data: data,
       success: function(a) { 
         //console.log(a.length);
         if (a.length > 1) {
           $('.rate-button['+attr_name+'='+obj+']').parent().find('.rate-info').text( th.parent().find('.rate-info').text()*1 + 1 );
           $('.count-photo-like[photo_id='+obj+']').text( $('.count-photo-like[photo_id='+obj+']').text()*1 + 1 ); 
         } else {
           $('.rate-button['+attr_name+'='+obj+']').parent().find('.rate-info').text( th.parent().find('.rate-info').text()*1 - 1 );
           $('.count-photo-like[photo_id='+obj+']').text( $('.count-photo-like[photo_id='+obj+']').text()*1 - 1 );          
         }
       }
     });
     return false;
   });
   
   
   $(".modal").on('hidden.bs.modal', function() {
     showScroll();
     //$('.nicescroll-rails:not(#ascrail2000, #ascrail2000-hr)').remove();
     //$(this).find('.scroll-modal-body').getNiceScroll().remove();
     $('.modal-backdrop').remove();
   });
   
   var old_photo_href;
   
   $("#onePhotoBox").on('hidden.bs.modal', function() {
     history.pushState(null, null, old_photo_href);
   });
   
   var ans = 1;
   
   $(document).on('keyup', '.frameBody', function() {
     //if ($(this).parent().parent().find('textarea').val() != '')
     if(event.keyCode==13)
        $(this).parent().submit();
   });
   
   $(document).on('click', '.comment-ans', function() {
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
    
     var new_comment = $(this).parent().find('.new-comment').eq(0);
     new_comment.slideDown(200);
     if ( new_comment.find('form textarea').length == 0 ) {
       new_comment.find('form').prepend("<textarea id='new-ans-"+ans+"'  maxlength='500' placeholder='Напишите комментарий' class='comment-textarea required ans-textarea' name='comment-text'></textarea>");
       new_comment.find(".comment-textarea").rte({content_css_url: "/css/rte.css", media_url: "",});
       ++ans;
     }
     $(this).removeClass('comment-ans').addClass('hide-ans-1').text('Отменить');
   }); 
   
   $(document).on('click', '.hide-ans, .hide-ans-1', function() {
     $(this).parent().parent().parent().parent().find('.new-comment').hide();
     $(this).parent().parent().parent().parent().find('.hide-ans-1').addClass('comment-ans').removeClass('hide-ans-1').text('Ответить');
     //$(this).parent().parent().parent().parent().find('form .emojiPickerIconWrap').remove();
   }); 
   

   
      
   
      
      
   
      
    
  

     $('.list-group-search input').keyup(function() {
        //if( $(this).val().length >= 3 ) search = 
           $('.list-dialog-search .fa-search').hide();
           $('.list-dialog-search .ajax-loader').show();
           $('.friends-list-wrapper').load(document.location.href + '?search='+$(this).val()+' .friends-list-inner', function() {
             $('.list-dialog-search .fa-search').show();
             $('.list-dialog-search .ajax-loader').hide();
           });
                     
        //}
      });

    $(document).on('click', '.friend-dropdown-menu', function() { 
      $(this).find('.single-dialog-menu-list').show();
      return false;
    });

    $(document).on('click', '.user-modal-close', function() { 
      $('.user-profile-dropdown-menu').hide();
      $('.dropdown-menu-recept-comands-list').hide();
      $('html').css('overflowY','auto');
      return false;
    });


    $(document).on('click', '.open-user-dropdown-menu', function() { 
      $('.user-profile-dropdown-menu').toggle();
      if($(document).width() < 768) {
        $('html').css('overflowY','hidden');
      }
      return false;
    });
    
    $(document).on('click', '.post-dropdown-menu', function() { 
      $(this).find('.post-menu-list').toggle();
      return false;
    });
    $(document).on('click', '.group-page-dropdown-menu', function() { 
      $(this).find('ul').toggle();
      return false;
    });
    
    $(document).on('click', '.add-recept-button', function() { 
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
     
      //if ($('.ajax-body').attr('user_id') != 0 ) {
        $('.add-dropdown-menu ul').toggle();

        $('.add-element').parent().show();
        return false;
      //}
    });
     
    
    

    $(document).on('click', '.photo-dropdown-menu', function() { 
      var ofs = $('.photo-dropdown-menu').offset();
      ofs.top += 20;
      ofs.left -= $('.photo-menu-list').hasClass('aabuse') ? 98:72;
        
      $('.photo-menu-list').toggle().offset(ofs);
    });
    
    $(document).on('click', '.link-to-dialog:not(.show-login)', function() {
    
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
          
      document.location.href = $(this).attr('data-href') ? $(this).attr('data-href') : $(this).attr('href');
      return false;
    });
    

    $('body').click(function(event) {
      /*
      if ($('.single-dialog-menu-list').is(":visible")  ) {
        $('.single-dialog-menu-list').hide();
      }
      */

      if ( $(event.target).closest('.dropdown-menu-recept-comands').length == 0 && event.target.className != 'dropdown-menu-recept-comands') {
        $('.dropdown-menu-recept-comands-list').hide();
        $('html').css('overflowY','auto');
      }

      if ($('.add-dropdown-menu ul').is(":visible")  ) {
        $('.add-dropdown-menu ul').hide();
      }
      if ($('.photo-menu-list').is(":visible")  ) {
        if (event.target.className != 'not-hide') {
          $('.photo-menu-list').hide();
        }
      }
      if ($('.post-menu-list').is(":visible")  ) {
        if (event.target.className != 'not-hide') {
          $('.post-menu-list').hide();
        }
      }
      if ($('.header-dropdown-menu ul').is(":visible")  ) {
        //alert (event.target.className);
        if (event.target.className != 'fa fa-angle-up' && event.target.className != 'fa fa-angle-down' && event.target.className != 'user-image') {
          $('.header-dropdown-menu ul').hide();
          $('.fa-angle-up').removeClass('fa-angle-up').addClass('fa-angle-down');
        }
      }
      if ($('.group-page-dropdown-menu-list').is(":visible")  ) {
        if (event.target.className != 'not-hide') {
          $('.group-page-dropdown-menu-list').hide();
        }
      } 
      if ($('.emojiPicker').is(":visible")  ) {
        if ( event.target.parentNode.className != 'smile' && event.target.className.indexOf('emoji-tab-') == -1 && !(event.target.parentNode.className == 'emojiPicker' || event.target.parentNode.parentNode.className == 'emojiPicker' || event.target.parentNode.parentNode.parentNode.className == 'emojiPicker')) {
          $('.emojiPicker').hide();
        }
      }
    }); 
    
    $(document).on('click', '.single-dialog-menu-list .ban', function() { 
       $('#overflow').css('opacity','0.8').show();
       $('.ajax-big-loader').show();
       
       var th = $(this);
       var ban_id = th.attr('ban-id');
       $.ajax({
            url: '/ajax',
            data: { delete_friend: ban_id },
            type: 'post',
            success: function(ans) {
                $.ajax({
                  url: '/ajax',
                  data: { user_ban: ban_id },
                  type: 'post',
                  success: function(ans) {

                    if (th.closest('.friends-list-wrapper').length) {
                      $('.friends-list-wrapper').load(document.location.href + ' .friends-list-inner', function() {
                        $('#overflow').css('opacity','1').hide();
                        $('.ajax-big-loader').hide();  
                      });
                    } else {
                      $('.user-menu').load(document.location.href + ' .user-menu-inner', function() {
                        $('#overflow').css('opacity','1').hide();
                        $('.ajax-big-loader').hide();  
                      });           
                    }         
                  }
                });
            }
          });   
        return false;
    });
    
    $(document).on('click', '.single-dialog-menu-list .friend', function() { 
    
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
          
       $('#overflow').css('opacity','0.8').show();
       $('.ajax-big-loader').show();
       
       var th = $(this);
       var friend_id = th.attr('friend_id');
       $.ajax({
            url: '/ajax',
            data: { add_friend: friend_id },
            type: 'post',
            success: function(ans) {

                     $('.friends-list-wrapper').load(document.location.href + ' .friends-list-inner', function() {
                       console.log(document.location.href);
                       $('#overflow').css('opacity','1').hide();
                       $('.ajax-big-loader').hide();  
                     });        
                  }

      });  
      return false; 
    });
    
    $(document).on('click', '.single-dialog-menu-list .abuse', function() { 
        $('.user-profile-dropdown-menu').hide();
        $('html').css('overflowY','auto');
        
        var th = $(this);
      
        $.ajax({
          url: "/modal",
          method: "POST",
          data: { modal:'.abuseModalBox' },
          success: function(ans) { 
            $('.abuseModalBox').empty().append(ans);
            var y = window.pageYOffset; 
            hideScroll(y);

            var frid = th.attr('data-friend_id') ? th.attr('data-friend_id') : th.attr('friend_id');
            
            if (frid) {
              $('.abuseModalBox').find('.object_type').val(4); 
              $('.abuseModalBox').find('.object_id').val(frid); 
            }
               
            $('.abuseModalBox').modal('show');         
          }
        });   
      return false;
    });
    
    $(document).on('click', '.show-all-group-members', function() { 
        
        var th = $(this);
      
        $.ajax({
          url: "/modal",
          method: "POST",
          data: { modal:'#allGroupMembers', group_id: th.attr('data-group_id') },
          success: function(ans) { 
            $('#allGroupMembers').empty().append(ans);
            var y = window.pageYOffset; 
            hideScroll(y);
               
            $('#allGroupMembers').modal('show');         
          }
        });   
      return false;
    });
    
    
    $(document).on('click', '.abuse-photo', function() { 
        $('#onePhotoBox').modal('hide');
        
        var th = $(this);
      
        $.ajax({
          url: "/modal",
          method: "POST",
          data: { modal:'#onePhotoAbuse' },
          success: function(ans) { 
            $('#onePhotoAbuse').empty().append(ans);
            var y = window.pageYOffset; 
            hideScroll(y);
            
            if (th.attr('photo_id')) {
              $('#onePhotoAbuse').find('.object_type').val(5); 
              $('#onePhotoAbuse').find('.object_id').val(th.attr('photo_id')); 
            }
               
            $('#onePhotoAbuse').modal('show');         
          }
        });   
      return false;
    });
    
    $(document).on('click', '.single-dialog-menu-list .profile', function() { 
      document.location.href = $(this).attr('data-href') ? $(this).attr('data-href') : $(this).attr('href');
      return false;
    });
    
 
    $.ajax({
      url: '/emoj',
      type: 'post',
      success: function(e) {
        $('.emojiPicker').append(e);
        console.log (emojis.length);
        setTimeout ( function() {
          for ( var i = 0; i < emojis.length; i++ ) {
            $('.emojiPicker').find('.sections .emoji[smile="emoji-'+emojis[i].name+'"]').text( toUnicode(emojis[i].unicode['apple']) );
            if (emojis[i].name == 'plus1') {
               console.log ('-----', toUnicode(emojis[i].unicode['apple']) );
            }
          }
        }, 500 );
      }
    });
    
    function updatePosition ($el) {
    
      var $picker = $('.emojiPicker');


      var positionedParent = $picker.offsetParent();
      var parentOffset = positionedParent.offset(); // now have a top/left object

      // Step 2
      var elOffset = $el.offset();
      elOffset.top += $el.outerHeight();

      // Step 3
            var diffOffset = {
        top: (elOffset.top - parentOffset.top),
        left: (elOffset.left - parentOffset.left)
      };
            
      $picker.css({
        top: diffOffset.top,
        left: diffOffset.left
      });

      return;
    }
    
    $(document).on('click', '.rte-toolbar .smile', function() { 
      updatePosition ($(this));
      $('.emojiPicker').toggle();
      editor_id = $(this).closest('.rte-toolbar').attr('id').replace('toolbar-','');
      return false;
    });
    
    $(document).on('click', '.emojiPicker .tab', function(e) {
      var section = '';
      var $picker = $('.emojiPicker');
      // Update tab
      $picker.find('nav .tab').removeClass('active');
      if ($(e.target).parent().hasClass('tab')) {
        section = $(e.target).parent().attr('data-tab');
        $(e.target).parent('.tab').addClass('active');
      }
      else {
        section = $(e.target).attr('data-tab');
        $(e.target).addClass('active');
      }

      var $section = $picker.find('section.' + section);

      var heightOfSectionsHidden = $section.parent().scrollTop();
      var heightOfSectionToPageTop = $section.offset().top;
      var heightOfSectionsToPageTop = $section.parent().offset().top;

      var scrollDistance = heightOfSectionsHidden
                           + heightOfSectionToPageTop
                           - heightOfSectionsToPageTop;

      $('.sections').off('scroll'); // Disable scroll event until animation finishes

      var that = this;
      $('.sections').animate({
        scrollTop: scrollDistance
      }, 250, function() {
        $picker.find('.sections').on('scroll', $.proxy(that.emojiScroll, that) ); // Enable scroll event
      });
    });
    
    $(document).on('scroll', '.emojiPicker', function(e) {
      var sections = $('section');
      $.each(sections, function(key, value) {
        var section = sections[key];
        var offsetFromTop = $(section).position().top;

        if (offsetFromTop <= 0) {
          $(section).parents('.emojiPicker').find('nav .tab').removeClass('active');
          $(section).parents('.emojiPicker').find('nav .tab[data-tab=' + section.className + ']').addClass('active');
        }
      });
    });
    
    function findEmoji(emojiShortcode) {
      for (var i = 0; i < emojis.length; i++) {
        if (emojis[i].shortcode == emojiShortcode) {
          return emojis[i];
        }
      }
    }

    var endSelection = 0;


    
    function insertAtCaret(myValue) {
    
      myValue = "<input class='sic' value='"+myValue+"'>";
      //console.log(myValue);
      var html = $('iframe#'+editor_id).contents().find( "body" ).html();

      html = html.replace(/<br>$/, '');
      
      //console.log(html);
      if ( html.indexOf('<span class="rte-placeholder">Напишите сообщение</span>')+1  || html.indexOf('<span class="rte-placeholder">Напишите комментарий</span>')+1 ) {
           $('iframe#'+editor_id).contents().find( "body" ).html(myValue);
           $('textarea#'+editor_id).val(myValue);
      } else {
           $('iframe#'+editor_id).contents().find( "body" ).html(html+myValue);
           $('textarea#'+editor_id).val(html+myValue);
      }
    }
    
    
    function toUnicode(code) {
      var codes = code.split('-').map(function(value, index) {
        return parseInt(value, 16);
      });
      //console.log(String.fromCodePoint.apply(null, codes));
      return String.fromCodePoint.apply(null, codes);
    }
    
    $(document).on('click', '.send-comment-button', function() {
    
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
          
      var bl1 = $(this).closest('form').find('.comment-textarea');
      var bl2 = $(this).closest('form').find('iframe').contents().find( "body" );
      
      var photo = false;
      if ($(this).hasClass('photo-comment')) photo = true;
      send_comment_function (bl1, bl2, photo);
    });
    
    $(document).on('focus', 'input[type=text], input[type=email], textarea', function() {
      $(this).attr('ps',$(this).attr('placeholder'));
      $(this).attr('placeholder','')
    });
    $(document).on('focus', 'input[type=number]', function() {
      $(this).attr('placeholder','')
    });
    $(document).on('blur', 'input[type=number], input[type=text], input[type=email], textarea', function() {
      $(this).attr('placeholder',$(this).attr('ps'));
    });
    
    $(document).on('click', '.delete-draft, .delete-post', function () {
    
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
      
        var y = window.pageYOffset; // запоминаем текущую прокрутку сверху
           
        var th = $(this);
        
        $.ajax({
          url: "/modal",
          method: "POST",
          data: { modal:'#receptConfirmBox', rid: th.attr('data-recept_id') },
          success: function(ans) { 
            $('#receptConfirmBox').empty().append(ans);
            $('#receptConfirmBox').find('.recept-name-del').text(th.attr('recept-name'));
            $('#receptConfirmBox').find('.recept-modal-confirm-delete').attr('data-recept_id', th.attr('data-recept_id'));
                
            hideScroll(y);
            $('#receptConfirmBox').modal('show');         
          }
        });   
        return false;
    });
    
    $(document).on('click', '.publish-post', function () {

     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }

        var th = $(this);
        
        $.ajax({
          url: "/ajax",
          method: "POST",
          data: { publish_post: th.attr('data-recept_id') },
          success: function(ans) { 
             th.closest('.post-in-group-wrapper').remove();
          }
        });   
        return false;
    });
    
    $(document).on('click', '.jq-radio', function() {
      $(this).find('input').attr('checked','checked');
      $(this).find('.jq-radio').addClass('checked');
    });
    
    $(document).on('click', '.recept-modal-confirm-delete', function () {
    
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
    
       
       $('.filter-block').addClass('ajax-waiting');
       $('#receptConfirmBox').modal('hide');
       
       $.ajax({
         url: '/ajax',
         type: 'post',
         data: { delete_recept: $(this).attr('data-recept_id') },
         success: function() {
                         load_filtered_recepts();
                     }
       });      
      return false;
    });
    
    $(document).on('click', '.emojiPicker div.wrap > div', function(e) {
    
      var clickTarget = $(e.target);
      var emojiSpan;
      if (clickTarget.is('div')) {
        emojiSpan = clickTarget.find('span');
      } else {
        emojiSpan = clickTarget.parent().find('.emoji');
      }

      var emojiShortcode = emojiSpan.attr('smile').split('emoji-')[1];
      var emojiUnicode = toUnicode(findEmoji(emojiShortcode).unicode['apple']);

      insertAtCaret(emojiUnicode);
      
      $('.emojiPicker').hide();
      
      // For anyone who is relying on the keyup event
      /*
      $(this.element).trigger("keyup");

      // trigger change event on input
      var event = document.createEvent("HTMLEvents");
      event.initEvent("input", true, true);
      this.element.dispatchEvent(event);  
      */  
    });
    
    
    
    var bodySize = $('.container.for-size').height();
    var winSize = $(window).height();
    var scroll = $(document).scrollTop();
    
    //console.log (bodySize, winSize, scroll);
    
    $(document).scroll(function() {
      var bodySize = $('.container.for-size').height();
      var winSize = $(window).height();
      var scroll = $(document).scrollTop();
    
      //console.log (bodySize, winSize, scroll);
      
      if (bodySize > winSize + scroll - 70) {
        $(".dialog-message-form").css('position', 'fixed').css('bottom', '10px');
      } else {
        var bot = winSize*1 + scroll*1 - 70 - bodySize*1 + 10;
        $(".dialog-message-form").css('position', 'fixed').css('bottom', bot+'px');
      }
      
      if (scroll > winSize*1.5) {
        $('.back-to-top').show();
      } else {
        $('.back-to-top').hide();
      }
      
    });
    
    $(window).resize(function() {
      var bodySize = $('.container.for-size').height();
      var winSize = $(window).height();
      var scroll = $(document).scrollTop();
    
      //console.log (bodySize, winSize, scroll);
      
      if (bodySize > winSize + scroll - 70) {
        $(".dialog-message-form").css('position', 'fixed').css('bottom', '10px');
      } else {
        var bot = winSize*1 + scroll*1 - 70 - bodySize*1 + 10;
        $(".dialog-message-form").css('position', 'fixed').css('bottom', bot+'px');
      }
      
      
    });
    
    
    var w = $('.for-width').width()*1-30;
    $('.dialog-message-form').css('width', (w+10) +'px');
    $('.bottom-block').css('marginLeft', '-' + (w/2+15)+'px'); 
    
    
    $(".comment-textarea").rte({
     content_css_url: "/css/rte.css",
     media_url: "",
    });
    
    if (bodySize > winSize + scroll -70) {
        $(".dialog-message-form").css('position', 'fixed').css('bottom', '10px');
      } else {
        var bot = winSize*1 + scroll*1 - 70 - bodySize*1 + 10;
        $(".dialog-message-form").css('position', 'fixed').css('bottom', bot+'px');
      }


function placeCaretAtEnd(el) {
    el.focus();
    if (typeof window.getSelection != "undefined"
            && typeof document.createRange != "undefined") {
        var range = document.createRange();
        range.selectNodeContents(el);
        range.collapse(false);
        var sel = window.getSelection();
        sel.removeAllRanges();
        sel.addRange(range);
    } else if (typeof document.body.createTextRange != "undefined") {
        var textRange = document.body.createTextRange();
        textRange.moveToElementText(el);
        textRange.collapse(false);
        textRange.select();
    }
}      
/*    
    $(document).on('click', '.sidebar.about-me img', function() {
     if ($('.sidebar.about-me').attr('contenteditable')) {
       $('.sidebar.about-me').removeAttr('contenteditable').blur();
       var text = $('.sidebar.about-me').clone();
       text.find('img').remove();
       text = text.html();
       $.ajax({
         url: '/ajax',
         type: 'post',
         data: { set_user_status: text }
       });
     } else {
       $('.sidebar.about-me').attr('contenteditable', 'true');
       $('.sidebar.about-me').html($('.sidebar.about-me').html()).focus();
       placeCaretAtEnd( document.getElementById("about-me") );
      }
    });
 */   
    
    $(document).on('click', '.about-me-edit.active', function() {
     if ($('#profile-descriptoion-about-me').attr('contenteditable')) {
       
     } else {
       $('.about-me-edit.active').hide();
       $('.about-me-edit.nonactive').show();
       if ($(this).attr('need_empty') == 1) {
         $('#profile-descriptoion-about-me').html('&nbsp;');
       }
       $('#profile-descriptoion-about-me').attr('contenteditable', 'true');
       $('#profile-descriptoion-about-me').html($('#profile-descriptoion-about-me').html()).focus();
       placeCaretAtEnd( document.getElementById("profile-descriptoion-about-me") );
      }
    });
    
    $(document).on('blur', '#profile-descriptoion-about-me[contenteditable=true]', function() {
       $('.about-me-edit.active').show();
       $('.about-me-edit.nonactive').hide();
       $('#profile-descriptoion-about-me').removeAttr('contenteditable').blur();
       var text = $('#profile-descriptoion-about-me').clone();
       text.find('img').remove();
       text = text.html();
       $.ajax({
         url: '/ajax',
         type: 'post',
         data: { set_user_status: text },
         success: function(ans) {
           console.log(ans, ans.length);
           if (ans.length) {
             $('#profile-descriptoion-about-me').empty().append(text);
             $('.about-me-edit.active').attr('need_empty', 0);
           } else {
             $('#profile-descriptoion-about-me').empty().append('Напишите здесь немного о себе, чтобы посетители вашей страницы узнали о вас побольше');
             $('.about-me-edit.active').attr('need_empty', 1);          
           }
         }
       });
    });
    
    
    $(document).on('click', '.about-me-edit-left.active', function() {
     if ($('#about-me').attr('contenteditable')) {
       
     } else {
       $('.about-me-edit-left.active').hide();
       $('.about-me-edit-left.nonactive').show();
       $('#about-me').attr('contenteditable', 'true');
       $('#about-me').html($('#about-me').html()).focus();
       placeCaretAtEnd( document.getElementById("about-me") );
      }
    });
    
    $(document).on('blur', '#about-me[contenteditable=true]', function() {
       $('.about-me-edit-left.active').show();
       $('.about-me-edit-left.nonactive').hide();
       $('#about-me').removeAttr('contenteditable').blur();
       var text = $('#about-me').clone();
       text.find('img').remove();
       text = text.html();
       $.ajax({
         url: '/ajax',
         type: 'post',
         data: { set_user_status: text },
         success: function() {
           $('#profile-descriptoion-about-me').empty().append(text);
         }
       });
    });
    
  $(document).on('click','.ajax-load-more', function() { 
    var th = $(this);
    th.addClass('waiting-load');
    var objects = $('<div/>');
    objects.load( $(this).find('a').attr('href') + ' .object-list-page-inner', function() {
      th.closest('.row').remove();
      //console.log(objects);
      objects.find('.ad12').remove();
      $('.object-list-page').append(objects);

      lazyload();
      /*
      (adsbygoogle = window.adsbygoogle || []).push({});
      (adsbygoogle = window.adsbygoogle || []).push({});
      (adsbygoogle = window.adsbygoogle || []).push({});
      */
      
      //$('html').getNiceScroll().resize();
    });
    return false;
  });
  
   
  var need_load_rec = true;

  function load_filtered_recepts () { 

    if (need_load_rec == false) return; 

    var get = '';

    $('.select2-search.multiple, .select2-search-ingr.multiple').each(function() {
      if ( $(this).val() != '' )
        get += '&' + ( $(this).attr('data-cat_type') != 'sovet' ? $(this).attr('data-cat_type'):'category') + '=' + $(this).val();
    });
    if ( $('.recept-list-search input').length && $('.recept-list-search input').val() != '') {
      get += '&search=' + $('.recept-list-search input').val().split(' ').join(',');
    }
    if ( $('.sort-block .active').attr('data-sort') != 'date' ) {
      get += '&sort=' + $('.sort-block .active').attr('data-sort');
    }
/*  
    var cats = [];
    $('.selected_fields .selected_option').each(function() {
      cats.push($(this).attr('value'));
    });
    cats = cats.join(',');
*/
    var recepts = $('<div/>');
    var vyd = '';
    
    if ( document.location.pathname.indexOf('/search/') >= 0 ) {
      var vyd = '&vyd='+$('.search-page .top-vyd-selector.orange-outlined-button:not(.gray-outlined-button)').attr('data-vyd');            
    }

    
    recepts.load( document.location.pathname +'?ajax=1'+get+vyd+' .recept-list-page-inner', function () { 
    //console.log(recepts);


      $('.recept-list-page-inner').each(function(){ $(this).remove(); });
      $('.recept-list-page:not(.sidebar-section)').append(recepts);
      
      history.pushState(null, null,  document.location.pathname + (get!='' && get.substr(1) != '' ? '?'+ get.substr(1) :'') );
      
      //$('html').getNiceScroll().resize();
      
      $('.filter-block').removeClass('ajax-waiting');

      lazyload();
      
      (adsbygoogle = window.adsbygoogle || []).push({});
      (adsbygoogle = window.adsbygoogle || []).push({});
      (adsbygoogle = window.adsbygoogle || []).push({});
          
    });
  }
  
  $(document).on('click','.favorite-caret', function() { 
  
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
  
    var rid = $(this).attr('data-recept_id');
    var th = $(this);
    
       $.ajax({
          url: "/modal",
          method: "POST",
          data: { modal:'.booksModalBox', rid:rid},
          success: function(ans) { 
            $('.booksModalBox').empty().append(ans);
            var y = window.pageYOffset; 
            hideScroll(y);
            $('.booksModalBox').modal('show');         
          }
        });   
     
        
    return false;
  });
  
  $('.delete-all-filter').click(function() {

    need_load_rec = false;
    $('.filter-select select').val(null).trigger('change');
    $('.recept-list-search input').val('');

    $('.sort-block .sort').removeClass('active');
    $('.sort-block .sort[data-sort=date_desc]').attr('data-sort', 'date');
    $('.sort-block .sort[data-sort=date]').addClass('active').text('по дате: новые');
    
    $('.filter-block').addClass('ajax-waiting');
          
    need_load_rec = true;

    load_filtered_recepts();
    
  });
  
  var search_keyup_timer;
  $('.recept-list-search input').keyup(function() {
    
    var th = $(this);
    
    clearTimeout(search_keyup_timer);
    search_keyup_timer = setTimeout( function() {
      $('.filter-block').addClass('ajax-waiting');
       
      $.ajax({
         url: '/ajax',
         type: 'post',
         data: { recept_list_search: th.val() },
         success: function() {
           if (th.hasClass('in-group')) {
             $('.normal-post-list').load(document.location.href + ' .normal-post-list-inner', function() {        
               $('#overflow').css('opacity','1').hide();
               $('.ajax-big-loader').hide();
             });
           } else {
             load_filtered_recepts();
           }
         }
      });
    }, 1000 );
  });
  
  $('.search-page .total-serach-string').keyup(function(event) {
    var th = $(this); 

    clearTimeout(search_keyup_timer);
    search_keyup_timer = setTimeout( function() {
      
      var vyd = $('.search-page .top-vyd-selector.orange-outlined-button:not(.gray-outlined-button)').attr('data-vyd');
      
      if (th.val().length) {
        $('.filter-block').addClass('ajax-waiting');
      
        var recepts = $('<div/>');
        recepts.load( '/search/'+ encodeURIComponent(th.val()) + '?ajax=1&vyd=' + vyd + '&sort=' + $('.sort-block .active').attr('data-sort') + ' .object-list-page-inner', function () { 
          $('.object-list-page-inner').each(function(){ $(this).remove(); });
          $('.object-list-page').append(recepts);
          $('title').text(th.val() + ' - поиск рецептов на Нямкин.ру');

          $('meta[property="og:title"]').attr('content', th.val() + ' - поиск рецептов на Нямкин.ру');

          history.pushState(null, null,  '/search/' + encodeURIComponent(th.val()) + '?sort=' + $('.sort-block .active').attr('data-sort') );
          
          $('.filter-block').removeClass('ajax-waiting');
		  
		      lazyload();
        });
      } else {
        $('.object-list-page-inner').empty();
      }
    }, 1000 );
  });
  
  $(document).on('click', '.search-page .top-vyd-selector.orange-outlined-button', function() {
    var search = encodeURIComponent($('.search-page .total-serach-string').val());
    var th = $(this);

    var sort = $('.sort.active').length ? '&sort=' + $('.sort.active').attr('data-sort'): '';
    
    if ( th.hasClass('gray-outlined-button') ) {
        $('.search-page .top-vyd-selector.orange-outlined-button').addClass('gray-outlined-button');
        th.removeClass('gray-outlined-button');
        
        if ( th.attr('data-vyd') == 2 ) {
          $('.sort[data-sort=favorite]').hide();
        } else if ( th.attr('data-vyd') == 1 ) {
          $('.sort[data-sort=favorite]').show().text('в копилках советов');
        } else if ( th.attr('data-vyd') == 0 ) {
          $('.sort[data-sort=favorite]').show().text('в кулинарных книгах');
        } 
        
        
        $('#overflow').css('opacity','0.8').show();
        $('.ajax-big-loader').show();
      
        var recepts = $('<div/>');
        recepts.load( '/search/'+ search + '?ajax=1&vyd=' + th.attr('data-vyd') + sort +' .object-list-page-inner', function () { 
          $('.object-list-page-inner').each(function(){ $(this).remove(); });
          $('.object-list-page').append(recepts);
      
          $('#overflow').hide();
          $('.ajax-big-loader').hide(); 
		  
		  lazyload();
        });  
        
        $('.right-sidebar').load('/search/'+ search + '?ajax=1&vyd=' + th.attr('data-vyd') + ' .left-sidebar');
      
    }
  });
  
  $(document).on('click', '.favorite-page .top-vyd-selector.orange-outlined-button', function() {
    var th = $(this);
    
    if ( th.hasClass('gray-outlined-button') ) { 
        if ( th.attr('data-vyd') == 1 ) document.location.href = '/favorites/advices';
        if ( th.attr('data-vyd') == 0 ) document.location.href = '/favorites/recipes'; 
    }
  });

  $(document).on('click', '.sort-block .sort', function() {
    var was_active = $('.sort-block .sort.active');
    $('.sort-block .sort').removeClass('active');
    $(this).addClass('active');
    if ( (was_active.attr('data-sort') == 'date' || was_active.attr('data-sort') == 'date_desc') &&  ($(this).attr('data-sort') == 'date' || $(this).attr('data-sort') == 'date_desc') ) {
      if($(this).attr('data-sort') == 'date') $(this).attr('data-sort', 'date_desc').text('по дате: старые');
      else $(this).attr('data-sort', 'date').text('по дате: новые');
    }
    
    $('.filter-block').addClass('ajax-waiting');
    
    var sb = $(this).closest('.sort-block');  

    $.ajax({
         url: '/ajax',
         type: 'post',
         data: { recept_list_sort: $(this).attr('data-sort') },
         success: function() {
           if (sb.hasClass('group_sort')) {
             $('.friends-list-wrapper.group-list').load( document.location.href +'?ajax=1 .friends-list-inner', function () { 
               $('.filter-block').removeClass('ajax-waiting');
             });          
           } else if (sb.hasClass('in-group-sort')) {
             $('.normal-post-list').load(document.location.href + ' .normal-post-list-inner', function() {        
               $('.filter-block').removeClass('ajax-waiting');
             });         
           
           } else if (sb.hasClass('comment-sort')) {
             $('.comments-list-wrapper').load(document.location.href + ' .comments-list', function() {  
               $('.filter-block').removeClass('ajax-waiting');
             });  
             
           } else if (sb.hasClass('photo-comment-sort')) {
             
             $.ajax({
	           url: '/modal',
	           data: {'modal':'#onePhotoBox', 'photo_id':sb.attr('photo_id') },
	           type: 'post',
	           success: function(ans){  
	             var $ans = $(ans);
	             $('.comments-list-wrapper').empty().append($ans.find('.comments-list'));
	             //$(".comment-colorbox").colorbox({rel:'comment-colorbox', transition:"none" });
                 
                 $('.filter-block').removeClass('ajax-waiting');
	           }
	         });              
             
             
             
               
           } else {
             load_filtered_recepts();
           }
         }
    });

  });
  
  $('.book-sort-block .sort').click(function() {
    var was_active = $('.book-sort-block .sort.active');
    $('.book-sort-block .sort').removeClass('active');
    $(this).addClass('active');
    if ( (was_active.attr('data-sort') == 'date' || was_active.attr('data-sort') == 'date_desc') &&  ($(this).attr('data-sort') == 'date' || $(this).attr('data-sort') == 'date_desc') ) {
      if($(this).attr('data-sort') == 'date') $(this).attr('data-sort', 'date_desc').text('по дате: старые');
      else $(this).attr('data-sort', 'date').text('по дате: новые');
    }
    
    $('#overflow').css('opacity','0.8').show();
    $('.ajax-big-loader').show();
      
    $.ajax({
         url: '/ajax',
         type: 'post',
         data: { cookbook_list_sort: $(this).attr('data-sort') },
         success: function() {
           $('.object-list-page').load(document.location.href + ' .object-list-page-inner', function() {
             $('#overflow').css('opacity','1').hide();
             $('.ajax-big-loader').hide();  
           });
         }
    });
  });
  
  $('.list-cookbook-search input').keyup(function() {
  
    $.ajax({
         url: '/ajax',
         type: 'post',
         data: { list_cookbook_search: $(this).val(), vyd: $(this).attr('data-vyd') },
         success: function(ans) {
           if (ans.length) {
             $('.cookbook-search-results').empty().append(ans).show();
           } else {
             $('.cookbook-search-results').empty().hide();
           } 
         }
    });    
  });
  
  
  $(document).click(function(e) {
    $('.cookbook-search-results').empty().hide();
    if (!e.target.classList.contains('payment-logo')) {
      $('.payment-wallet').hide();
    }
  });

  $('.payment-logo').click(function() {

    var detail = $(this).closest('.payment-detail-column').find('.payment-wallet');
    
    if (detail.is(':visible')) {
      detail.hide();
    } else {
      $('.payment-wallet').hide();
      detail.show();
    }
  });
  
  $(document).on('click', '.cookbook .fa-times, .modal-cookbook-delete', function() {
  
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
          
    $('#editCookbook').modal('hide');
    
    var th = $(this);
    
    $.ajax({
      url: "/modal",
      method: "POST",
      data: { modal:'#cookbookConfirmBox' },
      success: function(ans) {
        $('#cookbookConfirmBox').empty().append(ans);
    
        $('#cookbookConfirmBox').find('.cookbook-name-del').text(th.attr('data-book-name'));
        $('#cookbookConfirmBox').find('.cookbook-id').val(th.attr('data-book_id'));
        $('#cookbookConfirmBox').find('.modal-title').text(th.attr('data-modal-title'));
    
           var y = window.pageYOffset; // запоминаем текущую прокрутку сверху
           hideScroll(y);
           
        $('#cookbookConfirmBox').modal('show');
      }
    }); 
    return false;
  });
  
  $('.profile-input-text.username').keyup(function() {
    $('.small-profile-button').show();
  });
  
  $(document).on('click', '.small-profile-button', function() {
    
    var th = $(this);
    var now = new Date().getTime();
    var login = $('.profile-input-text.username');
    
    console.log(now*1, th.attr('ch')*1, now*1 - th.attr('ch')*1);
    if( now*1 - th.attr('ch')*1000 < 180*24*60*60*1000 ) {

    var date = new Date( th.attr('ch')*1000 + 180*24*60*60*1000 );
    var options = {
      year: 'numeric',
      month: 'numeric',
      day: 'numeric',
    };

              $('.fail-action span').text('Сможете ' + date.toLocaleString("ru", options) );
              $('.fail-action').show();
              setTimeout( function() {
                $('.fail-action').fadeOut('slow');
              }, 4000);
              login.val(login.attr('old_value'));
              $('.small-profile-button').hide();
       
       return false;
    }
    if( login.val() == '') {
    
              $('.fail-action span').text('Пустой адрес');
              $('.fail-action').show();
              setTimeout( function() {
                $('.fail-action').fadeOut('slow');
              }, 4000);
              login.val(login.attr('old_value'));
              $('.small-profile-button').hide();
       
       return false;
    }
    var re=new RegExp('^[a-zA-Z0-9]+$');
    if(!re.test(login.val())) {
    
              $('.fail-action span').text('Недопустимые символы');
              $('.fail-action').show();
              setTimeout( function() {
                $('.fail-action').fadeOut('slow');
              }, 4000);
              login.val(login.attr('old_value'));
              $('.small-profile-button').hide();
       
       return false;
    }
    
    $.ajax({
      url: '/ajax',
      method: "POST",
      data: { check_uniq_login: login.val() },
      success: function(ans) {
      
        if ( ans.length > 6 ) {
      
              $('.fail-action span').text('Этот адрес занят');
              $('.fail-action').show();
              setTimeout( function() {
                $('.fail-action').fadeOut('slow');
              }, 4000);
              login.val(login.attr('old_value'));
              $('.small-profile-button').hide();
        } else {
      
      
          $.ajax({
            url: "/modal",
            method: "POST",
            data: { modal:'#requestChangeLogin' },
            success: function(ans) {
              $('#requestChangeLogin').empty().append(ans);
    
              $('#requestChangeLogin').find('.current-login').text( login.val() );
        
              var y = window.pageYOffset; // запоминаем текущую прокрутку сверху
              hideScroll(y);
           
              $('#requestChangeLogin').modal('show');
            }
          }); 
        }
      }
    });
    return false;
  });
  
  $(document).on('click', '#requestChangeLogin .send-change-login-request', function() {
    var login = $('.profile-input-text.username');
    $.ajax({
      url: '/ajax',
      method: "POST",
      data: { change_login: login.val() },
      success: function() {  
         document.location.href = '/user/'+login.val()+'/editprofile';
      }
    });  
  });
  
  $(document).on('click', '.new-cookbook, .cookbook .fa-cog, .cookbook .fa-copy.login', function() {

     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }  
    
    var th = $(this);
    var vyd = th.hasClass('kopilka') ? 1:0;
    $.ajax({
      url: "/modal",
      method: "POST",
      data: { modal:'#editCookbook', vyd:vyd },
      success: function(ans) {
        $('#editCookbook').empty().append(ans);
        
        if( th.hasClass('fa-cog') || th.hasClass('fa-copy') ) {
       
           var bg = th.closest('.cookbook').find('.img-responsive').attr('src');
           if ( bg.indexOf('no_image') >=0 || th.hasClass('fa-copy') ) bg = '';
       
           $('#editCookbook').find('.cookbook-name').val(th.attr('data-book-name'));
           $('#editCookbook').find('.cookbook-id').val(th.attr('data-book_id'));
           $('#editCookbook').find('.modal-cookbook-delete').attr('data-book-name', th.attr('data-book-name'));
           $('#editCookbook').find('.modal-cookbook-delete').attr('data-book_id', th.attr('data-book_id'));
           $('#editCookbook').find('.cookbook-image-name').val(th.attr('data-book-image'));
           $('#editCookbook').find('.cookbook-image-img').css('backgroundImage', 'url('+bg+')');
           if( th.hasClass('fa-cog') ) {
             if( th.hasClass('kopilka') ) {
               $('#editCookbook').find('.modal-title').text('Редактировать копилку советов');
               $('#editCookbook').find('#upload-instructions--2').text('Создать копилку избранных советов. Например: Все про заморозку');
               $('.modal-cookbook-delete').attr('modal-title', 'Удаление копилки советов');
             } else if( th.hasClass('podborka') ) {
               $('#editCookbook').find('.modal-title').text('Редактировать подборку постов');
               $('#editCookbook').find('#upload-instructions--2').text('Создать подборку избранных постов. Например: Гастрономические путешествия');
               $('.modal-cookbook-delete').attr('modal-title', 'Удаление подборки постов');
             } else {
               $('#editCookbook').find('.modal-title').text('Редактировать кулинарную книгу');
               $('#editCookbook').find('#upload-instructions--2').text('Создать подборку избранных рецептов. Например: К Новому Году');
               $('.modal-cookbook-delete').attr('modal-title', 'Удаление кулинарной книги');
             } 
             $('#editCookbook').find('.cookbook-modal-confirm-edit').text('Изменить');
             $('.modal-cookbook-delete').show();
           } else {   
             if( th.hasClass('kopilka') ) {
               $('#editCookbook').find('.modal-title').text('Копировать копилку советов');
               $('#editCookbook').find('#upload-instructions--2').text('Создать копилку избранных советов. Например: Все про заморозку');
             } else if( th.hasClass('podborka') ) {
               $('#editCookbook').find('.modal-title').text('Копировать подборку постов');
               $('#editCookbook').find('#upload-instructions--2').text('Создать подборку избранных постов. Например: Гастрономические путешествия');
             } else {
               $('#editCookbook').find('.modal-title').text('Копировать кулинарную книгу');
               $('#editCookbook').find('#upload-instructions--2').text('Создать подборку избранных рецептов. Например: К Новому Году');
             }
              $('#editCookbook').find('.owner-id').val('');
             $('#editCookbook').find('.cookbook-modal-confirm-edit').text('Копировать');
             $('.modal-cookbook-delete').hide();
           }
           $('#editCookbook').find('.cookbook-image-img').show();
       
         } else {
           $('#editCookbook').find('.cookbook-name').val('');
           $('#editCookbook').find('.cookbook-id').val('');
           $('#editCookbook').find('.cookbook-image-name').val('');
           $('#editCookbook').find('.cookbook-image-img').css('backgroundImage','url()');
           if( th.hasClass('kopilka') ) {
               $('#editCookbook').find('.modal-title').text('Новая копилка советов');
               $('#editCookbook').find('#upload-instructions--2').text('Создать копилку избранных советов. Например: Все про заморозку');
             } else if( th.hasClass('podborka') ) {
               $('#editCookbook').find('.modal-title').text('Новая подборка постов');
               $('#editCookbook').find('#upload-instructions--2').text('Создать подборку избранных постов. Например: Гастрономические путешествия');
             } else {
               $('#editCookbook').find('.modal-title').text('Новая кулинарная книга');
               $('#editCookbook').find('#upload-instructions--2').text('Создать подборку избранных рецептов. Например: К Новому Году');
             }
             $('#editCookbook').find('.cookbook-modal-confirm-edit').text('Создать');
           $('#editCookbook').find('.cookbook-image-img').show();
           $('.modal-cookbook-delete').hide();
         }
           
         var y = window.pageYOffset; // запоминаем текущую прокрутку сверху
         hideScroll(y);
           
         $('#editCookbook').modal('show');
       }
    });
    return false;
  });
  
  $(document).on('click', '.new-group, .settings-group', function() {
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
        
       var th = $(this);
       $.ajax({
          url: "/modal",
          method: "POST",
          data: { modal:'#editGroup', group_id: $(this).attr('data-group_id') },
          success: function(ans) { 
            $('#editGroup').empty().append(ans);
                  
            $('#editGroup input[type=radio]').styler();
                   
            var y = window.pageYOffset; 
            hideScroll(y);
            
            $('#editGroup').modal('show'); 
            $('#editGroup select').select2({width:'100%', minimumResultsForSearch:Infinity, language: "ru"});
                    
          }
        });        
  
        return false;
  });
  
  $(document).on('click','#editCookbook .cookbook-image-button', function() {
  
    $('#editCookbook .cookbook-image').click();
    
  });
  
  $(document).on('change', '#editCookbook .cookbook-image', function() {
  
        var file_data = $(this).prop('files')[0];
        console.log (file_data);
        if (file_data.size < 10000000) {
	      var form_data = new FormData();
          form_data.append('book', file_data);
          $.ajax({
            url: '/ajax',
            dataType: 'text',
            cache: false,
            contentType: false,
            processData: false,
            data: form_data,
            type: 'post',
            success: function(a){
               $('#editCookbook').find('.cookbook-image-img img').attr('src', '/images/books/'+a );
               $('#editCookbook').find('.cookbook-image-img').show();
               $('#editCookbook').find('.cookbook-image-name').val(a);
            }
          });   
        }   
      return false;
  });
  
  $(document).on('click','.cookbook-modal-confirm-delete', function(){
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
    
    var modal = $(this).closest('#cookbookConfirmBox');
    
    $('#overflow').css('opacity','0.8').show();
    $('.ajax-big-loader').show();
        
    $.ajax({
         url: '/ajax',
         type: 'post',
         data: { delete_cookbook: modal.find('.cookbook-id').val() },
         success: function() {
           modal.modal('hide');
           $('.object-list-page').load(document.location.href + ' .object-list-page-inner', function() {
             $('#overflow').css('opacity','1').hide();
             $('.ajax-big-loader').hide();  
             //$('html').getNiceScroll().resize();
           });
         }
    });       
  
  });
  
  $(document).on('click', '.group-modal-confirm-delete', function(){
  
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
          
    var modal = $(this).closest('#groupdelConfirmBox');
    
    $('#overflow').css('opacity','0.8').show();
    $('.ajax-big-loader').show();
        
    $.ajax({
         url: '/ajax',
         type: 'post',
         data: { delete_group: modal.find('.group-id').val(), code: $('.confirm-code').val() },
         success: function(ans) {
           modal.modal('hide');
           if (ans == 'success') {
             $('.friends-list-wrapper').load(document.location.href + ' .friends-list-inner', function() {
               $('#overflow').css('opacity','1').hide();
               $('.ajax-big-loader').hide();  
               //$('html').getNiceScroll().resize();
             });
           } else {
           
             $.ajax({
               url: "/modal",
               method: "POST",
               data: { modal:'#groupdelFailBox' },
               success: function(ans) { 
                 $('#groupdelFailBox').empty().append(ans);
                 var y = window.pageYOffset; 
                 hideScroll(y); 
                 $('#groupdelFailBox').modal('show');         
               }
             });  

             $('#overflow').css('opacity','1').hide();
             $('.ajax-big-loader').hide();
           }
         }
    });       
  
  });
  
  $(document).on('click', '.user-modal-confirm-delete', function(){
    var modal = $(this).closest('#userdelConfirmBox');
    
    $('#overflow').css('opacity','0.8').show();
    $('.ajax-big-loader').show();
        
    $.ajax({
         url: '/ajax',
         type: 'post',
         data: { delete_user: 1, code: $('.confirm-code').val() },
         success: function(ans) {
           modal.modal('hide');
           if (ans == 'success') {
             document.location.href = '/';
           } else {
           
             $.ajax({
               url: "/modal",
               method: "POST",
               data: { modal:'#userdelFailBox' },
               success: function(ans) { 
                 $('#userdelFailBox').empty().append(ans);
                 var y = window.pageYOffset; 
                 hideScroll(y); 
                 $('#userdelFailBox').modal('show');         
               }
             });  

             $('#overflow').css('opacity','1').hide();
             $('.ajax-big-loader').hide();
           }
         }
    });       
  
  });
  
  $(document).on('click', '.exit-group, .exit-group-menu', function(){
  
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
          
    var th = $(this);
    var in_group = $(this).hasClass('in-group'); 
    
    $.ajax({
         url: '/ajax',
         type: 'post',
         data: { exit_group: $(this).attr('data-group_id') },
         success: function() {
           if (in_group) {
             $('.only-label').addClass('in-group').addClass('member-group').removeClass('only-label').text('Вступить');
             th.remove();
           } else {
              $('.exit-group[data-group_id='+th.attr('data-group_id')+']').removeClass('exit-group').addClass('member-group').text('Вступить');
           }
         }
    });       
    return false;
  });
  
  $(document).on('click', '.member-group, .autorize', function(){
  
    if ($('.user_id').val() == 0) {
      $.ajax({
        url: '/modal',
        data: { modal: '#loginBox' },
        type: 'post',
        success: function(ans) {   
           $('#loginBox').empty().append(ans);
           $('#loginBox #loginform-rememberme').styler();
           var y = window.pageYOffset; 
           hideScroll(y);   
                   
           $('#loginBox').modal('show');
           setTimeout ( function() { document.activeElement.blur(); }, 250 );
           
        }
      }); 
      return false;
    }
    
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
    
    var th = $(this);
    var in_group = $(this).hasClass('in-group'); 
        
    $.ajax({
         url: '/ajax',
         type: 'post',
         data: { member_group: th.attr('data-group_id') },
         success: function() {
           if (in_group) {
             th.removeClass('in-group').removeClass('member-group').addClass('only-label').text('Вы в группе');
             $('.group-page-dropdown-menu-list').append('<li class="del exit-group in-group" data-group_id="'+th.attr('data-group_id')+'">Выйти</li>');
           } else {
             $('.member-group[data-group_id='+th.attr('data-group_id')+']').removeClass('member-group').addClass('exit-group').text('Выйти');
           }
         }
    });       
    return false;
  });
  
  
  $(document).on('click', '.delete-group-admin', function(){
  
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
     
    var th = $(this);
    $.ajax({
         url: '/ajax',
         type: 'post',
         data: { delete_group_admin: th.attr('data-group_id'), user_id:th.attr('user_id') },
         success: function() {
           th.closest('.act-user-group').remove();
         }
    });     
    return false;
  });
  
  
  $(document).on('click', '.del-friend, .delete-friend', function(){
    
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
            
    var th = $(this); 
    $.ajax({
         url: '/ajax',
         type: 'post',
         data: { delete_friend: $(this).attr('data-friend_id') ? $(this).attr('data-friend_id'):$(this).attr('friend_id') },
         success: function() {
           if (th.closest('.friends-list-wrapper').length) {
             $('.friends-list-wrapper').load(document.location.href + ' .friends-list-inner');
           } else {
             $('.user-menu').load(document.location.href + ' .user-menu-inner');   
             var auth = $('<div/>');
             auth.load(document.location.href + ' .ajax-body', function(){
                $('.single-dialog-menu-list').empty().append( auth.find('.single-dialog-menu-list').html() );
             });        
           }
         }
    });  
    return false;     
  });
  
  $(document).on('click', '.del-ban', function(){
    
    $('#overflow').css('opacity','0.8').show();
    $('.ajax-big-loader').show();
    
    var th = $(this); 
    $.ajax({
         url: '/ajax',
         type: 'post',
         data: { delete_ban: $(this).attr('data-friend_id') ? $(this).attr('data-friend_id'):$(this).attr('friend_id') },
         success: function() {
           if (th.closest('.friends-list-wrapper').length) {
             $('.friends-list-wrapper').load(document.location.href + ' .friends-list-inner', function() {
               $('#overflow').css('opacity','1').hide();
               $('.ajax-big-loader').hide();  
             });
           } else {
             $('.user-menu').load(document.location.href + ' .user-menu-inner', function() {
               $('#overflow').css('opacity','1').hide();
               $('.ajax-big-loader').hide();  
             });           
           }
         }
    });  
    return false;     
  });
  
  
  $(document).on('click', '.ask-friend:not(.show-login)', function(){
  
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
    
    var th = $(this); 
    $.ajax({
         url: '/ajax',
         type: 'post',
         data: { add_friend: $(this).attr('data-friend_id') ? $(this).attr('data-friend_id'):$(this).attr('friend_id') },
         success: function() {
           if (th.closest('.friends-list-wrapper').length) {
             $('.friends-list-wrapper').load(document.location.href + ' .friends-list-inner');
           } else {
             $('.user-menu').load(document.location.href + ' .user-menu-inner'); 
             var auth = $('<div/>');
             auth.load(document.location.href + ' .ajax-body', function(){
                $('.single-dialog-menu-list').empty().append( auth.find('.single-dialog-menu-list').html() );
             });          
           }
         }
    });  
    return false;     
  });
  
  $(document).on('click', '.del-vzaim, .del-subscr', function(){

     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }    
        
    $.ajax({
         url: '/ajax',
         type: 'post',
         data: { delete_subscribe: $(this).attr('data-friend_id') ? $(this).attr('data-friend_id'):$(this).attr('friend_id') },
         success: function() {
           $('.friends-list-wrapper').load(document.location.href + ' .friends-list-inner');
           var auth = $('<div/>');
           auth.load(document.location.href + ' .ajax-body', function(){
                $('.single-dialog-menu-list').empty().append( auth.find('.single-dialog-menu-list').html() );
           });
         }
    });  
    return false;     
  });
  
  $(document).on('click', '.show-only-vzaim', function(){
    if($(this).hasClass('on')) {
      $(this).removeClass('on').addClass('off');
      $('.all-subscribe').show();
    } else {
      $(this).removeClass('off').addClass('on');
      $('.all-subscribe').hide();
      $('.vzaim-subscribe').show();
    }
  });
  
  $(document).on('click', '.yes-friend', function(){
  
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
    
    $('#overflow').css('opacity','0.8').show();
    $('.ajax-big-loader').show();
    
    var th =  $(this);
        
    $.ajax({
         url: '/ajax',
         type: 'post',
         data: { yes_friend: $(this).attr('data-friend_id') ? $(this).attr('data-friend_id'):$(this).attr('friend_id') },
         success: function() {
           if (th.closest('.friends-list-wrapper').length) {
             $('.friends-list-wrapper').load(document.location.href + ' .friends-list-inner', function() {
               $('#overflow').css('opacity','1').hide();
               $('.ajax-big-loader').hide();  
             });
           } else {
             $('.user-menu').load(document.location.href + ' .user-menu-inner', function() {
               $('#overflow').css('opacity','1').hide();
               $('.ajax-big-loader').hide();  
             });           
           }
         }
    });
    return false;       
  });
  
  $(document).on('click', '.yes-subscribe', function(){
  
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
    
    $.ajax({
         url: '/ajax',
         type: 'post',
         data: { yes_subscribe: $(this).attr('data-friend_id') ? $(this).attr('data-friend_id'):$(this).attr('friend_id') },
         success: function() {
           $('.friends-list-wrapper').load(document.location.href + ' .friends-list-inner');
           var auth = $('<div/>');
           auth.load(document.location.href + ' .ajax-body', function(){
                $('.single-dialog-menu-list').empty().append( auth.find('.single-dialog-menu-list').html() );
           });
         }
    });  
    return false;     
  });
  
  
  $(document).on('click', '.delete-meask', function(){
    $.ajax({
         url: '/ajax',
         type: 'post',
         data: { delete_friend: $(this).attr('user_id') },
         success: function() {
           $('.friends-list-wrapper').load(document.location.href + ' .friends-list-inner');
           var auth = $('<div/>');
         }
    });  
    return false;     
  });
  
  $(document).on('click', '.nav-link', function() {
    $(this).parent().find('.nav-item').removeClass('active');
    $(this).addClass('active');
    var tab = $('#' + $(this).attr('tab'));
    var block = tab.parent();
    
    block.find('.tab-content').removeClass('active');
    tab.addClass('active');
  });
  
  $(document).on('click', '.cookbook-modal-confirm-edit', function(){
  
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
          

    var modal = $(this).closest('#editCookbook');
    
    //$('#overflow').css('opacity','0.8').show();
    //$('.ajax-big-loader').show();
        
    $.ajax({
         url: '/ajax',
         type: 'post',
         data: { edit_cookbook: modal.find('.cookbook-id').val(), owner_id: modal.find('.owner-id').val(), name: modal.find('.cookbook-name').val(), image: modal.find('.cookbook-image-name').val(), vyd: modal.find('.cookbook-vyd').val() },
         success: function() {
           modal.modal('hide');
                        $('.object-list-page').load(document.location.href + ' .object-list-page-inner');
                    }
    });       
  
  });
  
  
     function ajax_saved (th) {
          if ( th.hasClass('required-error')) return;
          $.ajax({
            url: '/ajax',
            data: {save_field: th.val(), item_id: $('.item_id').val(), vyd: $('.vyd').val(), name:th.prop('name')},
            type: 'post',
            success: function(aa){
              var a = aa.split(':')[0];
              $('.item_id').val(a);
              $('.btn-go-draft').show();
              $('.or').show();
              if (th.prop('name') == 'name')
                $('.predprosmotr').attr('href', '/draft/'+ ( $('.vyd').val() == 0 ? 'recipes':'advice') +'/' + aa.split(':')[1] ).css('display','block');
              $('button.end-of-edit').removeClass('end-of-edit').text('Отправить на модерацию');       
/*            
      $('.success-action span').text('Сохранено');
      $('.success-action').show();
      setTimeout( function() {
        $('.success-action').fadeOut('slow');
      }, 4000);             
*/            
                
            } 
         });  
      }
  
   $(document).on('change', 'select.ajax-saved, input.ajax-saved, textarea.ajax-saved', function() {
      var th = $(this);

      if (th.hasClass('uniqtitle')) {
          $.ajax({
            url: '/ajax',
            data: {check_title:$(this).val(), recept_id: th.closest('form').find('.item_id').val()},
            type: 'post',
            success: function(a){
              console.log(a, a.length);
              if (a.length > 5 ) {
                th.addClass('required-error');
                th.parent().find('.not-uniq').empty().append(a).show();
              } else {
                th.removeClass('required-error');
                th.parent().find('.not-uniq').hide();
                ajax_saved (th); 
              }
            } 
         });            
      } else {
        setTimeout ( ajax_saved (th), 100 );
      }              
    });
  
  $('.type-block-title').click( function() {
    var bl = $(this).closest('.type-block').find('.type-block-content');
    
    if ($(this).find('i').hasClass('fa-caret-down')) {
      bl.show('fast');
      //bl.removeClass('hidden');
      $(this).find('i').removeClass('fa-caret-down').addClass('fa-caret-up');
    } else {
      bl.hide('fast');
      //bl.addClass('hidden');
      $(this).find('i').removeClass('fa-caret-up').addClass('fa-caret-down');
    }
    setTimeout ( function() {
      //$('html').getNiceScroll().resize();
    }, 200 );
  });

  $('.category-modal-open').click( function() {
    $('#category-modal').modal('show');
  });
  
  $('.more-filter').hide();
  
  $('.show-more-filter div').click( function() {
    if ($(this).hasClass('active')) {
      $(this).removeClass('active')
      $('.more-filter').slideUp(300,'linear');
    } else {
      $(this).addClass('active')
      $('.more-filter').slideDown(300,'linear'); 
    }
  });
  
  $('.orange-outlined-button.btn-go-draft').click( function(){
    document.location.href = document.location.href +  '/' +  $('.item_id').val();
    return false;
  });
  
  $('.access_table select').change(function(){
         $.ajax({
            url: '/ajax',
            data: {save_access: $(this).attr('name'), value: $(this).val()},
            type: 'post'
         });   
  });
  
  
  $(document).on('change', '.load-new-file', function() {

        var file_data =  $(this).prop('files')[0];
        
        if ( file_data.type != 'image/png' &&  file_data.type != 'image/jpeg' && file_data.type != 'image/gif' && file_data.type != 'image/webp' ) {
              $('.fail-action span').text('Недопустимый тип файла');
              $('.fail-action').show();
              setTimeout( function() {
                $('.fail-action').fadeOut('slow');
              }, 4000);        
          return;
        }
        
        if (file_data.size < 10000000) {
    
	      var form_data = new FormData();
          form_data.append('avatar', file_data);
            
          $.ajax({
            url: '/ajax',
            dataType: 'text',
            cache: false,
            contentType: false,
            processData: false,
            data: form_data,
            type: 'post',
            success: function(image){
            
             if (image.length > 5) {
             
                $.ajax({
                  url: "/modal",
                  method: "POST",
                  data: { modal:'#cropImageBox' },
                  success: function(ans) { 
                    $('#cropImageBox').empty().append(ans);
                    var win = $(window);
                    var dlg = $('#cropImageBox .modal-dialog');
                    var xy = (win.height() - dlg.height()) / 4;
                    dlg.css('top', xy +'px').css('marginTop', '0');
             
                    $('#editable-avatar').attr('src', '/images/avatars/originals/'+image );
              
                    $('#editable-avatar').bind('load', function() {
              
                      var dim = get_dimensions( $('#editable-avatar')[0] );
                      var x1, x2, y1, y2;
                      var w = document.documentElement.clientWidth > 475 ? 400: document.documentElement.clientWidth*0.94 - 10;
                      var ratio = w/dim.real_width;
                      
                      var new_y = Math.floor(ratio*dim.real_height);
                
                      if ( dim.real_width >= dim.real_height ) {
                        y1=0; y2= new_y;
                        x1=w/2 - y2/2; x2=w/2 + y2/2;
                        
                      } else if ( dim.real_width < dim.real_height ) {
                        x1=0; x2=w;
                        y1= new_y/2 - w/2; y2=new_y/2 + w/2;
                      }
                      var y = window.pageYOffset; 
                      hideScroll(y);
                      
                      var win = $(window);
                      var dlg = $('#cropImageBox .modal-dialog');
                      new_y = (win.height() - new_y - w/2) /2;
                   
                      dlg.css('top', new_y +'px').css('marginTop', '0');
                      
                      $('#cropImageBox').modal('show');
                      //$('#cropImageBox').on('shown.bs.modal', function () {
                      setTimeout(
                        function() {
                        editable_avatar = $('#editable-avatar').imgAreaSelect({ aspectRatio: '1:1', handles: true, x1:x1, y1:y1, x2:x2, y2:y2, instance: true });
                        },500);

                      //});
                    });
                  }
                });
             
             }
            }
         });
       } else {
              $('.fail-action span').text('Большой размер файла');
              $('.fail-action').show();
              setTimeout( function() {
                $('.fail-action').fadeOut('slow');
              }, 4000);        
       }
  }); 
  
  $(document).on('change', '.grouplogo-file', function() {

        var file_data =  $(this).prop('files')[0];
        
        if ( file_data.type != 'image/png' &&  file_data.type != 'image/jpeg' && file_data.type != 'image/gif' && file_data.type != 'image/webp' ) {
              $('.fail-action span').text('Недопустимый тип файла');
              $('.fail-action').show();
              setTimeout( function() {
                $('.fail-action').fadeOut('slow');
              }, 4000);        
          return;
        }
        
        //console.log ('----', file_data);
        if (file_data.size < 10000000) {
        
          $('#overflow').css('opacity','0.8').show();
          $('.ajax-big-loader').show();
    
	      var form_data = new FormData();
          form_data.append('logo', file_data);
            
          $.ajax({
            url: '/ajax',
            dataType: 'text',
            cache: false,
            contentType: false,
            processData: false,
            data: form_data,
            type: 'post',
            success: function(image){
            
             if (image.length > 5) {
             
                $.ajax({
                  url: "/modal",
                  method: "POST",
                  data: { modal:'#cropImageBox', group:1 },
                  success: function(ans) { 
                    $('#cropImageBox').empty().append(ans);
                    var win = $(window);
                    var dlg = $('#cropImageBox .modal-dialog');
                    var xy = (win.height() - dlg.height()) / 4;
                    dlg.css('top', xy +'px').css('marginTop', '0');
             
                    $('#editable-avatar').attr('src', '/images/groups/originals/'+image );
              
                    $('#editable-avatar').bind('load', function() {
              
                      var dim = get_dimensions( $('#editable-avatar')[0] );
                      var x1, x2, y1, y2;
                      var w = document.documentElement.clientWidth > 475 ? 400: document.documentElement.clientWidth*0.94 - 30;
                      var ratio = w/dim.real_width;
                      
                      var new_y = Math.floor(ratio*dim.real_height);
                
                      if ( dim.real_width >= dim.real_height ) {
                        y1=0; y2= new_y;
                        x1=w/2 - y2/2; x2=w/2 + y2/2;
                        
                      } else if ( dim.real_width < dim.real_height ) {
                        x1=0; x2=w;
                        y1= new_y/2 - w/2; y2=new_y/2 + w/2;
                      }
                      var y = window.pageYOffset; 
                      hideScroll(y);
                      
                      var win = $(window);
                      var dlg = $('#cropImageBox .modal-dialog');
                      new_y = (win.height() - new_y - w/2) /2;
                   
                      dlg.css('top', new_y +'px').css('marginTop', '0');
                      
                      console.log (dim, x1, x2, y1, y2 );
                      $('#cropImageBox').modal('show').on('shown.bs.modal', function () {
                        editable_avatar = $('#editable-avatar').imgAreaSelect({ aspectRatio: '1:1', handles: true, x1:x1, y1:y1, x2:x2, y2:y2, instance: true });
                        $('#overflow').css('opacity','1').hide();
                        $('.ajax-big-loader').hide();
                      });
                    });
                  }
                });
             
             }
            }
         });
       } else {
              $('.fail-action span').text('Большой размер файла');
              $('.fail-action').show();
              setTimeout( function() {
                $('.fail-action').fadeOut('slow');
              }, 4000); 
       }
  });  
  
    
 
  $(document).on('click', '.list-button-letter', function() {
    var list = [$(this).attr('data-recept_id')];
    $.ajax({
      url: '/ajax',
      data: {send_product_letter: JSON.stringify(list), mode:1 },
      type: 'post',
      success: function(ans) {   
             $.ajax({
               url: "/modal",
               method: "POST",
               data: { modal:'#letterConfirmBox' },
               success: function(ans) { 
                 $('#letterConfirmBox').empty().append(ans);
                 var y = window.pageYOffset; 
                 hideScroll(y);
            
                 $('#letterConfirmBox').modal('show');         
               }
             });        
      }
    });
    return false;
  });
  
  $(document).on('click', '.list-button-letter-modal', function() {
  
    //if ( $(this).attr('mode') == 1 ) {
    var list = $(this).attr('data-recept_id').split(',');
    $.ajax({
      url: '/ajax',
      data: {send_product_letter: JSON.stringify(list), mode:$(this).attr('mode') },
      type: 'post',
      success: function(ans) {  
      
             $('#productListBox').modal('hide');
              
             $.ajax({
               url: "/modal",
               method: "POST",
               data: { modal:'#letterConfirmBox' },
               success: function(ans) { 
                 $('#letterConfirmBox').empty().append(ans);
                 var y = window.pageYOffset; 
                 hideScroll(y);
            
                 $('#letterConfirmBox').modal('show');         
               }
             });        
      }
    });    
/*    } else {
    var list = $('#productListBox .modal-body').html();
    $.ajax({
      url: '/ajax',
      data: {send_product_letter_modal: list },
      type: 'post',
      success: function(ans) {  
             $('#productListBox').modal('hide'); 
             
             $.ajax({
               url: "/modal",
               method: "POST",
               data: { modal:'#letterConfirmBox' },
               success: function(ans) { 
                 $('#letterConfirmBox').empty().append(ans);
                 var y = window.pageYOffset; 
                 hideScroll(y);
                 $('#letterConfirmBox').modal('show');         
               }
             });  
      }
    });
    } */
    return false;
  });
  
  
  $(document).on('click', '.list-button-list', function() {
    var list = [$(this).attr('data-recept_id')];
    $.ajax({
      url: '/modal',
      data: { modal: '#productListBox', load_product_list_modal: JSON.stringify(list), mode:1 },
      type: 'post',
      success: function(ans) {  
        $('#productListBox').empty().append(ans);
        var y = window.pageYOffset; 
        hideScroll(y);
        $('#productListBox').modal('show');
      }
    });
    return false;
  });

  $(document).on('click', '.my-soc-edit', function() {
    var list = [$(this).attr('data-recept_id')];
    $.ajax({
      url: '/modal',
      data: { modal: '#socBox' },
      type: 'post',
      success: function(ans) {  
        $('#socBox').empty().append(ans);
        var y = window.pageYOffset; 
        hideScroll(y);
        $('#socBox').modal('show');
      }
    });
    return false;
  });

  $(document).on('click', '.soc-input-delete', function() {
    var th = $(this);
    var h = th.parent().find('input').val();
    var type = th.parent().find('input').attr('data-type');
    $.ajax({
      url: '/ajax',
      data: { delete_soc: h },
      type: 'post',
      success: function(ans) {  
        th.parent().remove();
        $('.soc-profile .soc-link-block[href="'+h+'"]').remove();
        
        if ( $('.soc-profile .soc-link-block').length == 0 ) {
          $('.profile-soc').removeClass('not-empty-soc');
          $('.soc-profile').addClass('empty');
          $('.my-soc-edit img').attr('src','/images/add_soc.png');
        }
        
        $('.add-soc-input').show();

        $('.exist-soc[data-type='+type+']').show();
      }
    });    
  });

 /* 
  $(document).on('change', '.soc-profile-input-text', function() {
    var url = $(this).val();
    var th = $(this);
    var correct = false;
    var exist = false;

    th.attr('data-type','');

    $('.exist-soc').each(function(){
     if( url.indexOf($(this).attr('data-pattern')) >= 0 ) {
       var type = $(this).attr('data-type');
       $('.soc-profile-input-text').each(function() {
         if ($(this).attr('data-type') == type) {
           $('.fail-action span').text('Такая соцсеть уже существует');
           $('.fail-action').show();
           setTimeout( function() {
             $('.fail-action').fadeOut('slow');
           }, 4000);  
           th.val(th.attr('data-old_value'));
           exist = true;
           return false;
         } 
       });

       if (exist) return false;

       $.ajax({
          url: '/ajax',
          data: { edit_soc_profile: type, url: url },
          type: 'post',
          success: function(ans) {  
            //$('#socBox').modal('hide');
            $('.soc-profile').empty().append(ans).removeClass('empty');
            $('.profile-subtitle.profile-soc').addClass('not-empty-soc');
            th.attr('data-type',type).attr('data-old_value',url);
          }         
       });
       correct = true;
       return false;
     }
    });
    
    if (correct || exist) return;
    
    $('.soc-profile-input-text').val('');
    $('.fail-action span').text('Формат ссылки не соответствует соцсетям');
    $('.fail-action').show();
    setTimeout( function() {
      $('.fail-action').fadeOut('slow');
    }, 4000);   
  });
*/
$(document).on('focus', '.soc-profile-input-text', function() {
  $(this).parent().find('.soc-input-error').hide();
});

  $(document).on('click', '.exist-soc', function() {
     var input = $(
         "<div>"+
           "<img class='soc-profile-input-label' src='/images/soc/logo/"+$(this).attr('data-type')+"-icon.png' alt=''>"+
           "<input class='soc-profile-input-text' data-pattern='"+$(this).attr('data-pattern')+"' data-type='"+$(this).attr('data-type')+"' placeholder='Введите адрес ссылки' type='text' value='' ps='Введите адрес ссылки'>"+
           "<div class='soc-input-delete'><img alt='' src='/images/modal-close.png'></div>"+
           "<div class='soc-input-error'>Неверный адрес ссылки</div>"+
        "</div>");
     
     $('.soc-inputs-block').append(input);

     $(this).hide();

     if ($('.exist-soc:visible').length == 0) {
       $('.add-soc-input').hide();
     }
  });

  $(document).on('click', '.add-soc-profile', function() {
    
    var correct = true;
    var data = [];

    $('.soc-profile-input-text').each(function(){
      var url = $(this).val();
      data.push({type:$(this).attr('data-type'), url:url});
      if( url.indexOf($(this).attr('data-pattern')) < 0 ) {
        $(this).parent().find('.soc-input-error').show();
        correct = false;
      }
    });
    
    if (!correct) return;

    $.ajax({
          url: '/ajax',
          data: { add_soc_profile: data },
          type: 'post',
          success: function(ans) {  
            $('#socBox').modal('hide');
            $('.soc-profile').empty().append(ans).removeClass('empty');
            $('.profile-subtitle.profile-soc').addClass('not-empty-soc');
          }         
    });

  });
  

  $(document).on('click', '.list-button-print', function() {
    var list = [$(this).attr('data-recept_id')];
    $.ajax({
      url: '/modal',
      data: { modal: '#productListBox', load_product_list_modal: JSON.stringify(list), mode:1 },
      type: 'post',
      success: function(ans) {  
        $('#productListBox').empty().append(ans).addClass('in');
        $('.fail-action, .success-action').hide();
        setTimeout(function(){ window.print(); $('#productListBox').removeClass('in').empty(); }, 500 );
      }
    });
    return false;
  });
   
  
  $(document).on('change', '.product-list-menu-select', function() {
  
    if ( $(this).val() == 1 || $(this).val() == 2 ) {
      var list = [];
      var mode = $(this).val();
      $(this).val('').trigger('refresh');
    
      $('.shoping-full-list .circle-select.checked').each(function() {
        list.push($(this).attr('data-recept-id'));
      });
      
      if (list.length) {
      
      $.ajax({
        url: '/modal',
        data: { modal: '#productListBox', load_product_list_modal: JSON.stringify(list), mode: mode },
        type: 'post',
        success: function(ans) {   
           $('#productListBox').empty().append(ans);
           var y = window.pageYOffset; 
           hideScroll(y);
                 
           $('#productListBox').modal('show');
        }
      });
      } else {
              $('.fail-action span').text('Выберите список покупок');
              $('.fail-action').show();
              setTimeout( function() {
                $('.fail-action').fadeOut('slow');
              }, 4000);      
      }
    } else if ($(this).val() == 3) {
      
      if ( $('.shoping-full-list .circle-select.checked').length ) {
        $('.shoping-full-list .circle-select.checked').each(function() {
          $(this).closest('.dialog-in-list').find('.delete-list').click();
        });
              $('.success-action span').text('Выбранные удалены');
              $('.success-action').show();
              setTimeout( function() {
                $('.success-action').fadeOut('slow');
              }, 4000);       
        
      } else {
              $('.fail-action span').text('Выберите список покупок');
              $('.fail-action').show();
              setTimeout( function() {
                $('.fail-action').fadeOut('slow');
              }, 4000); 
      }
      $(this).val('').trigger('refresh');
    }
    return false;
  });
  
  $(document).on('change', '.recept-list-comment', function() {
     var text = $(this).val();
     var list_id = $(this).attr('list_id');
     $.ajax({
        url: '/ajax',
        data: {list_comment_change: text, list_id: list_id },
        type: 'post',
        success: function() {   
          $('.list-comment[list_id='+list_id+']').text(text);
        }
      }); 
  
  });
  
  $(document).on('click', '.delete-list', function() {
     var list_id = $(this).attr('list_id');
     var wrapper = $(this).closest('.shoping-in-list');
     $.ajax({
        url: '/ajax',
        data: {delete_list: list_id },
        type: 'post',
        success: function() {   
          wrapper.remove();
        }
      }); 
  
  });

  $(document).on('click', '.delete-img-button', function() {
    $.ajax({
        url: '/ajax',
        data: {delete_user_avatar: 1 },
        type: 'post',
        success: function() {   
          $('#cropImageBox').modal('hide');
          $('.passp-edit-avatar__photo-icon').removeClass('crop-image').addClass('reload-image');
          $('.passp-edit-avatar__photo-icon-pic').removeClass('crop-image').addClass('reload-image');
          $('.avatar.editable img.for-edit').attr('src', '/images/avatars/def-profile.png');
          $('.right-part-hat .user-image').attr('src', '/images/avatars/def-profile.png');
        }
    }); 
  });
  

  $(document).on('click', '#cropImageBox .crop-modal-confirm', function() {
  
    var sel = editable_avatar.getSelection();
    var src = $('#editable-avatar').attr('src');
    var rw = $('#editable-avatar').width();
    console.log(sel);
    $.ajax({
      url: '/ajax',
      data: {crop_image: $('#editable-avatar').attr('src'), x1: sel.x1, y1: sel.y1, width: sel.width, height: sel.height, cover: $('#editable-avatar').attr('groupcover'), rw: rw },
      type: 'post',
      success: function(ans) {     
  
         $('.imgareaselect-outer').hide();
         $('.imgareaselect-selection').hide();
         $('.imgareaselect-selection').parent().hide();
         $('.imgareaselect-border1').hide();
         $('.imgareaselect-border2').hide();
         $('.imgareaselect-border3').hide();
         $('.imgareaselect-border4').hide();
         $('.imgareaselect-handle').hide();
         
         if ( src.indexOf('/avatars/') + 1 ) {
         
           $('.avatar.editable .for-edit').attr('src', '/images/avatars/'+ans+'?'+ Math.floor(Math.random()*1000));
           $('.right-part-hat .user-image').attr('src', '/images/avatars/'+ans+'?'+ Math.floor(Math.random()*1000));

           $('.passp-edit-avatar__photo-icon').addClass('crop-image').removeClass('reload-image');
           $('.passp-edit-avatar__photo-icon-pic').addClass('crop-image').removeClass('reload-image');
           
         } else {
           if ( $('#editable-avatar').attr('groupcover') == '1' ) {
              var bl = $('#editGroupStep2 .group-image-img');
              bl.find('.group-image-name').val(ans);
              bl.css('background', 'url(/images/groups/'+ans+')').css('backgroundSize', 'cover').css('backgroundPosition', 'center center');
              bl.find('.form-error').hide();
              
              bl.find('.dropzone').css('backgroundImage', 'none');
              bl.find('.help-block').hide();
              bl.find('.for-hide').hide();
              
              var width = bl.width();
              bl.css('height', width*210/855 + 'px'); 
              bl.find('.dropzone').css('height', width*210/855 + 'px'); 
           
           } else {
             $('#editGroupStep2 .current-logo').attr('src', '/images/groups/'+ans);
             $('#editGroupStep2 .group-logo-name').val(ans);
           }
         }
         
         $('#cropImageBox').modal('hide');
       }
    }); 
  });     
  
  $('#cropImageBox').on('hidden.bs.modal', function () {
         $('.imgareaselect-outer').hide();
         $('.imgareaselect-selection').hide();
         $('.imgareaselect-selection').parent().hide();
         $('.imgareaselect-border1').hide();
         $('.imgareaselect-border2').hide();
         $('.imgareaselect-border3').hide();
         $('.imgareaselect-border4').hide();
         $('.imgareaselect-handle').hide();    
  });
  
  $(document).on('click', '.reload-image', function() {
     $('#cropImageBox').modal('hide');
     $('.load-new-file').click();
  });
  
  $(document).on('click', '.load-grouplogo-file', function() {
     $('.grouplogo-file').click();
  });
  
  
var token = "7705cdce3ef42f4d1e36cbecaae6954725e39c9b";

var type  = "ADDRESS";
var $city = $("#city");
/*
var $address = $("#address") ;

function enforceCity(suggestion) {
  var sgt = $("#address").suggestions();
  sgt.clear();
  sgt.setOptions({
    constraints: {
      locations: { kladr_id: suggestion.data.kladr_id }
    },
    restrict_value: true
  });
}
*/
/*
function iplocate() {
  var serviceUrl = "https://suggestions.dadata.ru/suggestions/api/4_1/rs/iplocate/address";
  var params = {
    type: "GET",
    contentType: "application/json",
    headers: {
      "Authorization": "Token " + token
    }
  };
	return $.ajax(serviceUrl, params);
}
*/
// город и населенный пункт
$city.suggestions({
  token: token,
  type: type,
  hint: false,
  bounds: "city-settlement",
  //onSelect: enforceCity
});

$city.keyup(function() {
  setTimeout( function() {
  if ($city.val() != '') {
    $.ajax({
      url: '/ajax',
      method: 'post',
      data: {load_cities: $city.val()},
      success: function(ans) {
        $('.suggestions-suggestions .another-country').remove();
        $('.suggestions-promo').remove();
        $('.suggestions-suggestions').append(ans);
        var i = 0;
        $('.suggestions-suggestions .suggestions-suggestion').each(function() {
          $(this).attr('data-index', i);
          i++;
        });
        console.log( $('.suggestions-suggestions').html());
      }
    });
  }
  }, 200);
});

$(document).on('click', '.another-country', function() {
  var name=$(this).find('.suggestions-nowrap:first').text()+', '+$(this).find('.suggestions-nowrap:last').text();
  $city.val(name);
});

  var $buffer = $('.input-buffer');

  $('.profile-autowidth').on('input', function() {
    
      $buffer.text($(this).val()).css('fontSize', $(this).css('fontSize'));
      $(this).width($buffer.width()*1+1);
    //$(this).parent().width($buffer.width()*1+45);
  });
  
  $('.profile-autowidth').on('blur', function() {
    if ($(this).val() == '') {
      $buffer.text($(this).attr('placeholder')).css('fontSize', $(this).css('fontSize'));
      $(this).width($buffer.width()*1);
    }
    //$(this).parent().width($buffer.width()*1+45);
  });
  
  $('.profile-autowidth').each(function() {
    //if($(this).val() != '') {
      $buffer.text($(this).val()).css('fontSize', $(this).css('fontSize'));
      $(this).width($buffer.width()*1+1);
    //$(this).parent().width($buffer.width()*1+45);
    //}
  });  
  
  $('.profile-autowidth-wrapper').click(function(){
    $(this).find('.profile-autowidth').focus();
  });
/*
iplocate().done(function(response) {
    var location = response.location;
    console.log(location);
    if (!location) {
      return;
    }    
    $city.suggestions().setSuggestion(location);
    //enforceCity(location);
});
*/

 $(document).on('click', '.create-album', function() {
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
          
      $.ajax({
        url: '/modal',
        data: { modal: '#createAlbumBox' },
        type: 'post',
        success: function(ans) {   
           $('#createAlbumBox').empty().append(ans);
           var y = window.pageYOffset; 
           hideScroll(y);
           
           $('#createAlbumBox').modal('show');
           $('#createAlbumBox select').select2({width:'150px', minimumResultsForSearch:Infinity, language: "ru"});
           
        }
      }); 
 });
 
  $(document).on('click', '.album .rate-circle', function() {
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
          
      var album = $(this).closest('.album');
      var th = $(this);
      $.ajax({
        url: '/modal',
        data: { modal: '#createAlbumBox' },
        type: 'post',
        success: function(ans) {   
           $('#createAlbumBox').empty().append(ans);
           $('#createAlbumBox .modal-title').text('Настроить фотоальбом');
           $('#createAlbumBox .create-album-send').text('Применить');
           $('#createAlbumBox .album-name').val(album.find('.carcass-title').text());
           $('#createAlbumBox .album-description').val(album.find('.album-description').text());
           $('#createAlbumBox .album-access').val(th.attr('album-access'));
           $('#createAlbumBox .album-id').val(th.attr('album_id'));
           var y = window.pageYOffset; 
           hideScroll(y);
           $('#createAlbumBox select').select2({width:'150px', minimumResultsForSearch:Infinity, language: "ru"});
           
           $('#createAlbumBox').modal('show');
        }
      }); 
      
      return false;
 });
 
 $(document).on('click', '.create-album-send', function() {
 
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
          
      $.ajax({
        url: '/ajax',
        data: { create_album: $('.album-id').val(), name: $('.album-name').val(), description:  $('.album-description').val(), access: $('select.album-access').val() },
        type: 'post',
        success: function(ans) {   
           var album_id = parseInt (ans);
           $('.album-list-wrapper').load(document.location.href + ' .album-list-inner');
           $('#createAlbumBox').modal('hide');
           
           if ($('#addPhotoBox').hasClass('temp-hide')) {
           
             $('#addPhotoBox .no-albums').remove();
           
             $('#addPhotoBox .modal-footer center').prepend(
               "<select class='wo-search album-to-add'>" +
                 "<option selected value='"+album_id+"'>"+$('.album-name').val()+"</option>" +
               "</select>");
             $('#addPhotoBox select').select2({width:'100%', minimumResultsForSearch:Infinity, language: "ru"});
            
             $('body').append('<div class="modal-backdrop fade in"></div>');
             $('#addPhotoBox.temp-hide').removeClass('temp-hide').show();
           }
        }
      }); 
 });
 
 $(document).on('click', '.album .favorite-circle', function() {
 
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
    
    var th = $(this);
    
    $.ajax({
      url: "/modal",
      method: "POST",
      data: { modal:'#albumConfirmBox' },
      success: function(ans) {
        $('#albumConfirmBox').empty().append(ans);
    
        $('#albumConfirmBox').find('.album-name-del').text(th.attr('album-name'));
        $('#albumConfirmBox').find('.album-id').val(th.attr('album_id'));
        
           var y = window.pageYOffset; // запоминаем текущую прокрутку сверху
           hideScroll(y);
           
        $('#albumConfirmBox').modal('show');
      }
    }); 
    return false;
  });
  
  
 $(document).on('click', '.photo .link-block', function() {
    
    var th = $(this);
    
    $.ajax({
      url: "/modal",
      method: "POST",
      data: { modal:'#onePhotoBox', photo_id: th.attr('photo_id'), username: '' },
      success: function(ans) {
         $('#onePhotoBox').empty().append(ans);
         $('#onePhotoBox').prepend(
          "<div class='prev-photo nav-photo' photo_id='"+th.attr('photo_id')+"'><img alt='' src='/images/chevron-left.png'></div>"+
          "<div class='next-photo nav-photo' photo_id='"+th.attr('photo_id')+"'><img alt='' src='/images/chevron-right.png'></div>"
         );
      
        old_photo_href = document.location.href;
        history.pushState(null, null, th.attr('href'));
         
        //$('#onePhotoBox').find('.single-photo').attr('src', '/images/albums/large/'+th.attr('photo-image'));
        $('#onePhotoBox').find(".comment-textarea").rte({content_css_url: "/css/rte.css", media_url: "",});
        
        $('#onePhotoBox .modal-body').scroll( function() { 
          var ofs = $('.photo-dropdown-menu').offset();
          ofs.top += 20;
          ofs.left -= $('.photo-menu-list').hasClass('aabuse') ? 98:72;
          $('.photo-menu-list').offset(ofs);
        });
        
        var y = window.pageYOffset; // запоминаем текущую прокрутку сверху
        hideScroll(y);
        
        $('#onePhotoBox').modal('show');
        
        //$(".comment-colorbox").colorbox({rel:'comment-colorbox', transition:"none" }); 
        $('.photo-dropdown-menu').click();
        $('.photo-menu-list').hide();
      }
    }); 
    return false;
 });  
 



  
 $(document).on('click','.album-modal-confirm-delete', function(){
 
      if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
     
    var modal = $(this).closest('#albumConfirmBox');
    
    $('#overflow').css('opacity','0.8').show();
    $('.ajax-big-loader').show();
        
    $.ajax({
         url: '/ajax',
         type: 'post',
         data: { delete_album: modal.find('.album-id').val() },
         success: function() {
           modal.modal('hide');
           $('.photo-list-wrapper').load(document.location.href + ' .photo-list-inner');
           $('.album-list-wrapper').load(document.location.href + ' .album-list-inner', function() {
             $('#overflow').css('opacity','1').hide();
             $('.ajax-big-loader').hide();  
           });
         }
    });       
  
  });
  
  $(document).on('click', '.del-photo', function() {
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
     
    $('#overflow').css('opacity','0.8').show();
    $('.ajax-big-loader').show();  
    var modal = $(this).closest('.modal');
    $.ajax({
         url: '/ajax',
         type: 'post',
         data: { delete_photo: $(this).attr('photo_id') },
         success: function() {
           modal.modal('hide');
           $('.album-list-wrapper').load(document.location.href + ' .album-list-inner');
   
           $('.photo-list-wrapper').load(document.location.href + ' .photo-list-inner', function() {
             $('#overflow').css('opacity','1').hide();
             $('.ajax-big-loader').hide();  
           }); 
         }    
    });
  });
  
  $(document).on('click', '.settings-photo', function() {
  
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
     
      $('#onePhotoBox').modal('hide');
    
      //$('#overflow').css('opacity','0.8').show();
      //$('.ajax-big-loader').show();
 
      $.ajax({
        url: '/modal',
        data: { modal: '#addPhotoBox', photo_id: $(this).attr('photo_id') },
        type: 'post',
        success: function(ans) {   
           $('#addPhotoBox').empty().append(ans);
           var y = window.pageYOffset; 
           hideScroll(y);
           
           $('#addPhotoBox').modal('show');
           $('#addPhotoBox select').select2({width:'100%', minimumResultsForSearch:Infinity, language: "ru"});
           
           //$('#overflow').css('opacity','1').hide();
           //$('.ajax-big-loader').hide(); 
        }
      }); 
  }); 
  
  
   function show_login () {
   
      var in_comment = $(this).closest('.or_signin').length ? 1:0;
      
      $.ajax({
        url: '/modal',
        data: { modal: '#loginBox', in_comment: in_comment },
        type: 'post',
        success: function(ans) {   
           $('#loginBox').empty().append(ans);
           $('#loginBox #loginform-rememberme').styler();
           var y = window.pageYOffset; 
           hideScroll(y);   
                   
           $('#loginBox').modal('show');
           setTimeout ( function() { document.activeElement.blur(); }, 250 );
        }
      }); 
      
       $('.modal').off( 'hidden.bs.modal', show_login ); 
   } 
  
  
  $(document).on('click', 'nav .not-login, .new-group-not-login, .comment-login, .add-recept-not-login, .add-sovet-not-login, .cookbook .fa-copy.not-login', function() { 
  
     $('.modal').modal('hide');
     if (document.body.clientWidth <= 768) {
       $('.close-menu-button:visible').click();
     }
      
      var in_comment = $(this).closest('.or_signin').length ? 1:0;
      var copy_book = $(this).hasClass('fa-copy') ? 1:0;
      var add_recept = $(this).hasClass('add-recept-not-login') ? 1:0;
      add_recept = $(this).hasClass('add-sovet-not-login') ? 2:add_recept;
      
      $.ajax({
        url: '/modal',
        data: { modal: '#loginBox', in_comment: in_comment, add_recept: add_recept, copy_book: copy_book },
        type: 'post',
        success: function(ans) {   
           $('#loginBox').empty().append(ans);
           $('#loginBox #loginform-rememberme').styler();
           var y = window.pageYOffset; 
           hideScroll(y);   
                   
           $('#loginBox').modal('show');
           setTimeout ( function() { document.activeElement.blur(); }, 250 );
           
        }
      }); 
      return false;
  });
  
  $(document).on('click', '.go-to-login', function() { 
  
     $('.modal').modal('hide');   ;
     $('.modal').on( 'hidden.bs.modal', show_login );
    
  });
  

  
      function show_signup () {
      
        $.ajax({
          url: '/modal',
          data: { modal: '#signupBox' },
          type: 'post',
          success: function(ans) {   
            $('#signupBox').empty().append(ans);
            var y = window.pageYOffset; 
            hideScroll(y);   
                   
            $('#signupBox').modal('show');
           
            if ( $('#login-form').hasClass('in_comment') ) {
              $('#signup-form').addClass('in_comment')
            }
            
            grecaptcha.ready(function () {
              grecaptcha.execute('6Le4PNsUAAAAAFgraWD8EGN7p76X4Qv3oxfrxfiM', { action: '' }).then(function (token) {
                $('#recaptchaResponse').val(token);
                $('.recaptchaResponse').val(token);
              });
            });
          }
        });
        
        $('.modal').off( 'hidden.bs.modal', show_signup ); 
      }
 
  $(document).on('click', '.go-to-registr', function() {
  
      $('.modal').modal('hide');
      
      $('.modal').on( 'hidden.bs.modal', show_signup );
      
      return false;
  });
  
   function show_remember () {
      $.ajax({
        url: '/modal',
        data: { modal: '#rememberBox' },
        type: 'post',
        success: function(ans) {   
           $('#rememberBox').empty().append(ans);
           var y = window.pageYOffset; 
           hideScroll(y);   
                   
           $('#rememberBox').modal('show');
           
        }
      }); 
      
      $('.modal').off( 'hidden.bs.modal', show_remember );
    }
 
  $(document).on('click', '.go-to-remember', function() { 
      $('.modal').modal('hide');  
      $('.modal').on( 'hidden.bs.modal', show_remember );
      return false;
  });

  $(document).on('click', '.dropdown-menu-recept-comands', function() { 
      $('.dropdown-menu-recept-comands-list').toggle();
      if($(document).width() < 768) {
        $('html').css('overflowY','hidden');
      }
      return false;
  });
 
  
 
 $(document).on('click', '.add-photo', function() {
      if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
      }
      $('.add-photo-input').click();
 });
 
 $(document).on('change', '.add-photo-input', function() {
 
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
     
 
     $('#overflow').css('opacity','0.8').show();
     $('.ajax-big-loader').show();
        
     var file_data = $(this).eq(0).prop('files');
     var form_data = new FormData();
	    
     for (var i=0; i<file_data.length; i++) {
        form_data.append('photo['+i+']', file_data[i]);
     }
          form_data.append('modal', '#addPhotoBox');
        
 
      $.ajax({
        url: '/modal',
        dataType: 'text',
	    cache: false,
	    contentType: false,
	    processData: false,
	    data: form_data,
        type: 'post',
        success: function(ans) {   
           $('#addPhotoBox').empty().append(ans);
           var y = window.pageYOffset; 
           hideScroll(y);
           
           $('#addPhotoBox select').select2({width:'100%', minimumResultsForSearch:Infinity, language: "ru"});   
           $('#addPhotoBox').modal('show');
           
           $('#overflow').css('opacity','1').hide();
           $('.ajax-big-loader').hide(); 
        }
      }); 
 });
 
 $(document).on('click', '#addPhotoBox .delete-photo i.fa-times', function() {
   
   $(this).closest('.add-photo-block').remove();
   
   if ( $('.add-photo-block').length == 0 ) {
     $('#addPhotoBox').modal('hide');
   }
 
 });
 
 $(document).on('change', '#addPhotoBox .add-photo-name', function() {
 
   if ( $(this).val() == '' ) {
     $(this).css('borderBottom', '1px solid red');
   } else {
     $(this).css('borderBottom', '1px solid #d5d5d5');
   }
 });
 
 
 $(document).on('click', '#addPhotoBox .no-albums div', function() {
      $.ajax({
        url: '/modal',
        data: { modal: '#createAlbumBox' },
        type: 'post',
        success: function(ans) {   
           $('#createAlbumBox').empty().append(ans);
           var y = window.pageYOffset; 
           hideScroll(y);
           $('#createAlbumBox select').select2({width:'150px', minimumResultsForSearch:Infinity, language: "ru"});
           $('#addPhotoBox').addClass('temp-hide').hide();
           $('.modal-backdrop').remove(); 
           $('#createAlbumBox').modal('show');
        }
      }); 
 });
 
 
 $('#addPhotoBox').on("hide.bs.modal", function() {
   if ($('#addPhotoBox').hasClass('temp-hide')) {
     $('body').append('<div class="modal-backdrop fade in"></div>');
     $('#addPhotoBox.temp-hide').removeClass('temp-hide').show();
   }
 });
 
 $(document).on('click', '#addPhotoBox .add-photo-modal-confirm', function() {
 
 
     if ($('.aban').length) {
       $('.ban-report').hide();
       $('.ban-report-fixed').show();
       $('.ban-report-fixed .ban-report').show();
       return false;
     }
     
        
   var album = $('#addPhotoBox select.album-to-add').val();
   
   console.log (album);
   
   if ( typeof album == "undefined") {
     $('.fail-action span').text('Создайте альбом');
     $('.fail-action').show();
     setTimeout( function() {
       $('.fail-action').fadeOut('slow');
     }, 4000);  
     return false;   
   }
   
   $('#overflow').css('opacity','0.8').show();
   $('.ajax-big-loader').show();
   
   $('.add-photo-block').each(function() {
     var name = $(this).find('.add-photo-name').val();
     var description = $(this).find('.add-photo-description').val();
     var image = $(this).find('.add-photo-filename').val();
     var photo_id = $(this).find('.photo_id').val();
     var th = $(this);
     if (name != '') {
       $.ajax({
         url: '/ajax',
         type: 'post',
         async: false,
         data: { add_photo:image, name:name, description:description, album_id:album, photo_id:photo_id},
         success: function() {
           th.remove();
         }
       }); 
     } else {
       th.find('.add-photo-name').css('borderBottom', '1px solid red');
     } 
   });
   
   if ( $('.add-photo-block').length == 0 ) {
     $('#addPhotoBox').modal('hide');
        } else {
              $('.fail-action span').text('Заполните все поля');
              $('.fail-action').show();
              setTimeout( function() {
                $('.fail-action').fadeOut('slow');
              }, 4000);     
   }
     $('.album-list-wrapper').load(document.location.href + ' .album-list-inner');
   
     $('.photo-list-wrapper').load(document.location.href + ' .photo-list-inner', function() {
       $('#overflow').css('opacity','1').hide();
       $('.ajax-big-loader').hide();  
     }); 
 });
 
    
    
$(document).on('click', '.add-new-post', function() {  
  $.ajax({
    url: '/modal',
    data: { modal: '#loginBox' },
    type: 'post',
    success: function(ans) {
      $('#loginBox').empty().append(ans);
      $('#loginBox #loginform-rememberme').styler();
      var y = window.pageYOffset;
      hideScroll(y);

      $('#loginBox').modal('show');
      setTimeout ( function() { document.activeElement.blur(); }, 250 );

    }
  });
  return false;  
});
  
  $(document).on('click', '.more-cats-show', function(){
    $(this).hide();
    $('.sequest-cat-list').css('maxHeight','unset');
  })
  
  $(document).on('click', 'nav .fa-angle-down, nav .user-image', function() {
     $('.header-dropdown-menu ul').show();
     $('.fa-angle-down').removeClass('fa-angle-down').addClass('fa-angle-up');
  });

  $(document).on('click', '.fa-angle-up, .header-dropdown-menu .close-menu-button', function() {
     $('.header-dropdown-menu ul').hide();
     $('.fa-angle-up').removeClass('fa-angle-up').addClass('fa-angle-down');
  });

  $(document).on('click', '.radio-pagination .pagination a', function() {
    if ($(this).parent().hasClass('active')) return;
    $('#overflow').css('opacity','0.8').show();
    $('.ajax-big-loader').show();
    $('.comments-list-wrapper').load( $(this).attr('href') + '? .comments-list', function(){
      $([document.documentElement, document.body]).animate({
        scrollTop: $("#comments").offset().top
      }, 500);
      $('#overflow').css('opacity','1').hide();
      $('.ajax-big-loader').hide();
    });  
    return false;
  })
  
  $(document).on('click', '.search-modal-selector', function() {
    $('.search-window-wrapper').fadeIn('fast');
    if ( $(this).hasClass('gray') ) {
      $('.to-mode2').click();
    } else {
      $('.total-serach-string').focus(); 
      $('.total-serach-string').prop('placeholder', 'Что ищем?');
      $('.to-mode1').click();
    }
  });
  
  $('.search-window-wrapper').click(function(event) {
    if (event.target.className == 'search-window-wrapper' ||  event.target.className == 'close-search-modal-img') {
      $('.search-window-wrapper').fadeOut('fast');
    }
  });
  
  $('input.search-recepts').change(function() {
    $('.search-window-results .recept-results').toggle();
  });
  
  $('input.search-sovets').change(function() {
    $('.search-window-results .sovet-results').toggle();
  });
  
  $('input.search-posts').change(function() {
    $('.search-window-results .post-results').toggle();
  });

  var global_search_keyup_timer;
  
  $('.total-serach-string').keyup(function() {
    var search = $(this).val();
    
    if(event.keyCode==13) {
      if ( search != '' )
        document.location.href = '/search/'+encodeURIComponent(search)+'?sort=relevant';
      return;
    }
      
    var ths = $(this);

    clearTimeout(global_search_keyup_timer);
    global_search_keyup_timer = setTimeout(function() {

      
      var allow_words = ['пп','  хе',];

      if (search.length >=3 || allow_words.indexOf(search.toLowerCase()) != -1) {
        $.ajax ({
          url: '/ajax',
          type: 'post',
          data: {search_string: ths.val()},
          success: function(ans) {   
            var $ans = $(ans);   
            $('.search-window-results').empty().append( $ans.html() );
            //$('.search-window-results .sovet-results').empty().append( $ans.find('.sovet-results').html() );
            //$('.search-window-results .post-results').empty().append( $ans.find('.post-results').html() );
            $('.search-window-results').show();
            $('.go-to-search-page').show();
            $('.go-to-search-page a').attr('href', '/search/'+search);
  
            if ( ! $('input.search-recepts').is(':checked')) {
              $('.search-window-results .recept-results').hide();
            }

            if ( ! $('input.search-sovets').is(':checked')) {
              $('.search-window-results .sovet-results').hide();
            }

            if ( ! $('input.search-posts').is(':checked')) {
              $('.search-window-results .post-results').hide();
            }
  
          }
        });
      } else {
        $('.search-window-results').empty();
        //$('.search-window-results .sovet-results').empty();
        //$('.search-window-results .post-results').empty();
        //$('.search-window-results').hide();
        $('.go-to-search-page').hide();
      }
    }, 500); 
  });
  
  function ingr_search () {
    var include = $('select.ingr-include option:selected');
    var exclude = $('select.ingr-exclude option:selected');
    var cats = $('select.cat-search option:selected');
    
    if ( include.length || exclude.length ) {
      var ingr_include = [];
      include.each(function() {
        ingr_include.push($(this).attr('value'));
      });
      
      var ingr_exclude = [];
      exclude.each(function() {
        ingr_exclude.push($(this).attr('value'));
      });
      
      var cat_search = [];
      cats.each(function() {
        cat_search.push($(this).attr('value'));
      });
      
       
      $.ajax ({
        url: '/ajax',
        type: 'post',
        data: { ingr_include: ingr_include,  ingr_exclude: ingr_exclude, cat_search:cat_search },
        success: function(ans) {   
          var $ans = $(ans);   
          $('.search-window-results .recept-results').empty().append( $ans.find('.recept-results').html() );
          $('.search-window-results').show();
          $('.jq-selectbox__dropdown').hide();
        }
      });
    } else {
      $('.search-window-results .recept-results').empty();
      $('.search-window-results').hide();
    }  
  
  }
  
  $(document).on('change', '.search-ingr-select-block select', function() {
     ingr_search ();
  });
  
  $(document).on('click', '.search-ingr-select-block .delete-option', function() {
     ingr_search ();
  });
  
    
  $('.to-mode1').click(function() {
    $('.mode2').hide();
    $('.mode1').show();
    $('.search-window-results .recept-results').empty().show();
    $('.search-window-results .sovet-results').empty().show();
    $('.search-window-results .post-results').empty().show();
    $('input.search-recepts').attr('checked', 'checked');
    $('input.search-sovets').attr('checked', 'checked');
    $('input.search-posts').attr('checked', 'checked');
    $('.total-serach-string').val('');
    $('.search-window-results').hide();
    $('.go-to-search-page').show();
    $('.total-serach-string').focus(); 
    $('.total-serach-string').prop('placeholder', 'Что ищем?');
  });
  
  $('.to-mode2').click(function() {
    $('.mode1').hide();
    $('.mode2').show();
    $('.search-ingr-select-block select').trigger('change');
    $('.search-ingr-select-block .selected_fields').empty();
    $('.search-window-results .recept-results').empty().show();
    $('.search-window-results .sovet-results').empty().hide();
    $('.search-window-results .post-results').empty().hide();
    $('.search-window-results').hide();
    $('.go-to-search-page').hide();
  });
  
  $('.navbar-toggle').attr('data-target', '#w0-collapse ul.navbar-nav.nav');
  
  $('.navbar-nav.nav').prepend("<div class='close-menu-button'></div>");
  
  $('.navbar-toggle').click(function() {
    $(this).toggleClass('open');
  });
  
  $(document).on('click', '.navbar-nav.nav .close-menu-button', function() {
    $('.navbar-toggle').click();
  });
  
  $(document).on('click', '.left-sidebar .close-menu-button', function() {
    $('.left-sidebar').hide();
    $('html').css('overflowY', 'auto');
  });
  
  $(document).on('click', '.modal-show-cats', function() {
    $('.left-sidebar').show();
    $('html').css('overflowY', 'hidden');
  });
  
  $(document).on('click', '.left-sidebar-wo-right-padding .close-menu-button', function() {
    $('.left-sidebar-wo-right-padding').hide();
    $('html').css('overflowY', 'auto');
  });
  
  function resize_ban_report() { $('.ban-report-fixed').css('width', $('.for-width-calc').width()); } 
  resize_ban_report();  
  
  $(window).resize(function() { 
    //console.log ($(document).width());
    if ( $(window).width() < 768 ) {
      $('.square').removeClass('square').addClass('extrawidth').addClass('square1');
      return;
    } else {
      $('.square1').addClass('square').removeClass('extrawidth').removeClass('square1');
    }
     resize_ban_report();
  });
    
    if ( $(window).width() < 768 ) {
      $('.square').removeClass('square').addClass('extrawidth').addClass('square1');
    } else {
      $('.square1').addClass('square').removeClass('extrawidth').removeClass('square1');
    }
    
  $(document).on('click', '.login-button-vkontakte', function() {
    if ( $(this).hasClass('in_comment')  ) {
      
      
      var childWindow = window.open('/verify-ajax-vk.php', 'Авторизация', 'toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=yes, resizable=no, copyhistory=no, width=600, height=400, top=100, left=100');
      
      function checkWindow() {
        if (childWindow && childWindow.closed) {
          window.clearInterval(intervalID);

          var auth = $('<div/>');
          auth.load(document.location.href + ' .ajax-body', function(){
            if ( auth.find('.ajax-body').attr('data-user_id') != 0 ) {
              $('nav.navbar').empty().append( auth.find('nav.navbar').html() );
              $('.send-comment-area').empty().append( "<div class='send-comment-button'><img alt='' src='/images/send-message.png' style='width:100%;'></div>" );
              $('.single-dialog-menu-list').empty().append( auth.find('.single-dialog-menu-list').html() );
               
              $('.modal').modal('hide');
              
              var user_id = auth.find('.ajax-body').attr('data-user_id');
              $('.ajax-body').attr('data-user_id', user_id );
              $('.user_id').val(user_id);
            }
          });

        }
      }
      var intervalID = window.setInterval(checkWindow, 500);
    
    } else if ( $(this).hasClass('add_recept')  ) {
      
      
      var childWindow = window.open('/verify-ajax-vk.php', 'Авторизация', 'toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=yes, resizable=no, copyhistory=no, width=600, height=400, top=100, left=100');
      
      function checkWindow() {
        if (childWindow && childWindow.closed) {
          window.clearInterval(intervalID);
          
          var auth = $('<div/>');
          auth.load(document.location.href + ' .ajax-body', function(){
            document.location.href = '/user/' + auth.find('.ajax-body').attr('data-username') + '/addrecipe';
          });
        }
      }
      var intervalID = window.setInterval(checkWindow, 500);
    
    } else if ( $(this).hasClass('add_sovet')  ) {
      
      
      var childWindow = window.open('/verify-ajax-vk.php', 'Авторизация', 'toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=yes, resizable=no, copyhistory=no, width=600, height=400, top=100, left=100');
      
      function checkWindow() {
        if (childWindow && childWindow.closed) {
          window.clearInterval(intervalID);
             var auth = $('<div/>');
             auth.load(document.location.href + ' .ajax-body', function(){
               document.location.href = '/user/' + auth.find('.ajax-body').attr('data-username') + '/addadvice';
             });

        }
      }
      var intervalID = window.setInterval(checkWindow, 500);
    
    } else {
      document.location.href = '/verify-vk.php';
    }
  });
  $(document).on('click', '.login-button-facebook', function() {
    document.location.href = '/verify-fb.php';
  });
  
  $(document).on('click', '.login-button-ok', function() {
    if ( $(this).hasClass('in_comment') ) {
      
      var childWindow = window.open('/verify-ajax-ok.php', 'Авторизация', 'toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=yes, resizable=no, copyhistory=no, width=600, height=400, top=100, left=100');
       
      function checkWindow() {
        if (childWindow && childWindow.closed) {
          window.clearInterval(intervalID);

          var auth = $('<div/>');
          auth.load(document.location.href + ' .ajax-body', function(){
            if ( auth.find('.ajax-body').attr('data-user_id') != 0 ) {
              $('nav.navbar').empty().append( auth.find('nav.navbar').html() );
              $('.send-comment-area').empty().append( "<div class='send-comment-button'><img alt='' src='/images/send-message.png' style='width:100%;'></div>" );
              $('.single-dialog-menu-list').empty().append( auth.find('.single-dialog-menu-list').html() );
               
              $('.modal').modal('hide');
              
              var user_id = auth.find('.ajax-body').attr('data-user_id');
              $('.ajax-body').attr('data-user_id', user_id );
              $('.user_id').val(user_id);
            }
          });

        }
      }
      var intervalID = window.setInterval(checkWindow, 500);
    
    } else if ( $(this).hasClass('add_recept') ) {
      
      var childWindow = window.open('/verify-ajax-ok.php', 'Авторизация', 'toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=yes, resizable=no, copyhistory=no, width=600, height=400, top=100, left=100');
       
      function checkWindow() {
        if (childWindow && childWindow.closed) {
          window.clearInterval(intervalID);
          
          var auth = $('<div/>');
          auth.load(document.location.href + ' .ajax-body', function(){
            document.location.href = '/user/' + auth.find('.ajax-body').attr('data-username') + '/addrecipe';
          });
        }
      }
      var intervalID = window.setInterval(checkWindow, 500);
    
    } else if ( $(this).hasClass('add_sovet') ) {
      
      var childWindow = window.open('/verify-ajax-ok.php', 'Авторизация', 'toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=yes, resizable=no, copyhistory=no, width=600, height=400, top=100, left=100');
       
      function checkWindow() {
        if (childWindow && childWindow.closed) {
          window.clearInterval(intervalID);
          
          var auth = $('<div/>');
          auth.load(document.location.href + ' .ajax-body', function(){
            document.location.href = '/user/' + auth.find('.ajax-body').attr('data-username') + '/addadvice';
          });
        }
      }
      var intervalID = window.setInterval(checkWindow, 500);
    
    } else {
      document.location.href = '/verify-ok.php';
    }
  });
  
  $(document).on('click', '.vk-relate', function() {
    document.location.href = '/relate-vk.php';
  });
  $(document).on('click', '.fb-relate', function() {
    document.location.href = '/relate-fb.php';
  });
  $(document).on('click', '.ok-relate', function() {
    document.location.href = '/relate-ok.php';
  });
  
  $(document).on('click', '.balance-info-block .show-details', function() {
    
    
     $.ajax({
        url: '/modal',
        data: { modal: '#balanceDetailsBox', vyd: $(this).attr('data-vyd') },
        type: 'post',
        success: function(ans) {   
           $('#balanceDetailsBox').empty().append(ans);
           var y = window.pageYOffset; 
           hideScroll(y); 
           $('#balanceDetailsBox').modal('show');
        }
      }); 
  });
    
    
  $('select.payment-method-selector').change(function() {
  
    $('.data-variant').hide();
    $('.data-variant[pm='+$(this).val()+']').show();
  
  });  
  
  $('.save-payment-method').click(function() {
  
    var form = $(this).closest('form');
    
    if (form.find('select').val() && $('.data-variant[pm='+form.find('select').val()+'] input').val() != '' ) {
    
       $.ajax ({
         url: '/ajax',
         data: {save_payment_method:form.find('select').val(), payment_data: $('.data-variant[pm='+form.find('select').val()+'] input').val() },
         type: 'post',
         success: function() {
              $('.success-action span').text('Изменения сохранены');
              $('.success-action').show();
              setTimeout( function() {
                $('.success-action').fadeOut('slow');
              }, 4000);
         }
       });
    } else {
              $('.fail-action span').text('Заполните все поля');
              $('.fail-action').show();
              setTimeout( function() {
                $('.fail-action').fadeOut('slow');
              }, 4000);
    }
  
  });
  
  $(document).on('click', '.delete-soc', function() {
  
    var th = $(this);
    var set = th.attr('set');
    
    $.ajax({
       url: '/ajax',
       data: {delete_soc_entry: set},
       type: 'post',
       success: function() {
         var img = th.closest('.soc-set-entry').find('.exist').attr('src');
         th.closest('.soc-set-entry').remove();
         $('.soc-set-entry-block').append('<div class="soc-set-entry"><img class="relate '+set+'-relate" alt="" src="'+img+'"></div>');
         
         if ( $('.soc-set-entry .exist').length <= 1 && $('input[name=email]').val() == '' ) {
           $('.delete-soc').remove();
         }
       }
    });
  });
  
  $(document).on('focus', '#loginform-email, #loginform-password', function() {
    $(this).parent().find('.form-error').hide();
  });
  
  $(document).on('submit', '#login-form', function() {
     var able = true;
     if ($('#loginform-email').val()=='') {
       $('.email-error').text('Вы не заполнили поле').show();   
       able = false;
     }
     
     if ($('#loginform-password').val()=='') {
       $('.password-error').text('Вы не заполнили поле').show();   
       able = false;
     }
     
     if (!able) {
       return false
     }


     var data = $(this).serialize();
     
     if ( $('#loginform-email').val() == 'admin@nyamkin.ru') {

         document.location.href = '/backend/web/moderation/recept'; 

      return false;
     }
     
     $.ajax({
       url: '/ajax',
       data: data,
       type: 'post',
       success: function(ans) {
         if (ans.length < 5 ) {
           if ($('#login-form').hasClass('in_comment')) {
             var auth = $('<div/>');
             auth.load(document.location.href + ' .ajax-body', function(){
               $('nav.navbar').empty().append( auth.find('nav.navbar').html() );
               $('.send-comment-area').empty().append( "<div class='send-comment-button'><img alt='' src='/images/send-message.png' style='width:100%;'></div>" );
               $('.single-dialog-menu-list').empty().append( auth.find('.single-dialog-menu-list').html() );
               
               $('.modal').modal('hide');
             
               var user_id = auth.find('.ajax-body').attr('data-user_id');
               var username = auth.find('.ajax-body').attr('data-username');
               $('.ajax-body').attr('data-user_id', user_id ).attr('data-username', username );
               $('.user_id').val(user_id);
             });
           } else if ($('#login-form').hasClass('copy_book')) {
             var auth = $('<div/>');
             auth.load(document.location.href + ' .ajax-body', function(){
               $('nav.navbar').empty().append( auth.find('nav.navbar').html() );
               
               $('.modal').modal('hide');
             
               var user_id = auth.find('.ajax-body').attr('data-user_id');
               var username = auth.find('.ajax-body').attr('data-username');
               $('.user_id').val(user_id);
             });
           } else if ($('#login-form').hasClass('add_recept')) {
             var auth = $('<div/>');
             auth.load(document.location.href + ' .ajax-body', function(){
               document.location.href = '/user/' + auth.find('.ajax-body').attr('data-username') + '/addrecipe';
             });
           } else if ($('#login-form').hasClass('add_sovet')) {
             var auth = $('<div/>');
             auth.load(document.location.href + ' .ajax-body', function(){
               document.location.href = '/user/' + auth.find('.ajax-body').attr('data-username') + '/addadvice';
             });
           } else {
             var auth = $('<div/>');
             auth.load(document.location.href + ' .ajax-body', function(){
               document.location.href = '/user/' + auth.find('.ajax-body').attr('data-username');
             });
           }
         
         } else {
           if ( ans.indexOf('завершите') + 1 ) {
             $('#loginBox').modal('hide');
             $('#signupConfirmBox').empty().append(ans);
             var y = window.pageYOffset; 
             hideScroll(y); 
             $('#signupConfirmBox').modal('show');
           }
           else if ( (ans.indexOf('email') + 1) || (ans.indexOf('авторизованы') + 1) ) { 
             $('.email-error').text(ans).show();
           }
           else if ( ans.indexOf('пароль') + 1 ) {
             $('.password-error').text(ans).show();
             $('#loginform-password').focus(function() {
               $('.password-error').hide();
             });
           }
         }
       }
    });  
      
    return false;
  });
  
  $(document).on('submit', '#signup-form', function() {
     
     if ( $('#signup-form .e-mail').val() == '' ) {
       $('.email-error').text('Введите e-mail').show();
     } else if ( $('#signup-form .password').val().length < 6 ) {
       $('.password-error').text('Пароль минимум 6 символов').show();
     } else if ( $('#signup-form .password').val() != $('#signup-form .password1').val() ) {
       $('.password1-error').text('Пароли не совпадают').show();
     } else if ( $('#signup-form .username').val() == '' ) {
       $('.name-error').text('Укажите имя или никнейм').show();
     } else {
      
       var data = $(this).serialize();
       $.ajax({
         url: '/ajax',
         data: data,
         type: 'post',
         success: function(ans) {
           if (ans.length < 5 ) {
/*
             if ($('#signup-form').hasClass('in_comment')) {
               var auth = $('<div/>');
               auth.load(document.location.href + ' .ajax-body', function(){
                 $('nav.navbar').empty().append( auth.find('nav.navbar').html() );
                 $('.send-comment-area').empty().append( "<div class='send-comment-button'><img alt='' src='/images/send-message.png' style='width:100%;'></div>" );
                 $('.author-recept-info').empty().append( auth.find('.author-recept-info').html() );
               
                 $('.modal').modal('hide');
             
                 var user_id = auth.find('.ajax-body').attr('data-user_id');
                 var username = auth.find('.ajax-body').attr('data-username');
                 $('.ajax-body').attr('data-user_id', user_id ).attr('data-username', username );
                 $('.user_id').val(user_id);
               });
             } else {
               var auth = $('<div/>');
               auth.load(document.location.href + ' .ajax-body', function(){
                 document.location.href = '/user/' + auth.find('.ajax-body').attr('data-username');
               });
             }
*/
             $('#signupBox').modal('hide');
             $.ajax({
               url: '/modal',
               data: {modal:'#signupConfirmBox'},
               type: 'post',
               success: function(ans) {  
                 $('#signupConfirmBox').empty().append(ans);
                 var y = window.pageYOffset; 
                 hideScroll(y); 
                 $('#signupConfirmBox').modal('show');
               }             
             });
           } else {
             $('.email-error').text(ans).show();
           }
         }
      });  
    } 
    return false;
  });
  
  
  function letter_fly_show () {
  
      $.ajax({
        url: '/modal',
        data: { modal: '#letterBox' },
        type: 'post',
        success: function(ans) {   
           $('#letterBox').empty().append(ans);
           var y = window.pageYOffset; 
           hideScroll(y);   
                   
           $('#letterBox').modal('show');
           
        }
      }); 
      
      $('.modal').off( 'hidden.bs.modal', letter_fly_show );
  } 
  
  $(document).on('submit', '#remember-form', function() {
     
     if ( $('#remember-form .e-mail').val() == '' ) {
       $('.email-error').text('Введите e-mail').show();
     } else {
      
       var data = $(this).serialize();
       $.ajax({
         url: '/ajax',
         data: data,
         type: 'post',
         success: function(ans) {
           if (ans.length < 5 ) {
              $('.modal').modal('hide');
              $('.modal').on( 'hidden.bs.modal', letter_fly_show ); 
           } else {
             $('.email-error').text(ans).show();
           }
         }
      });  
    } 
    return false;
  });
  
  $('.modal').on('shown.bs.modal', function() {
    var th = $(this);
    if ( !th.find('.scroll-modal-body').is(':hover') && !IS_TOUCH_DEVICE ) {
      th.find('.scroll-modal-body').mouseenter(function() {  
        //th.find('.scroll-modal-body').niceScroll({autohidemode: 'leave', cursorborder: '1px solid rgb(204, 204, 204)', cursorwidth:10, cursorcolor:'rgb(218, 218, 218)', railpadding:{top:0,right:5,left:0,bottom:0}});
        //$('.nicescroll-rails').eq(-1).css('marginTop',yyy+'px');
      });
    } else {
      if (!IS_TOUCH_DEVICE) {
        //th.find('.scroll-modal-body').niceScroll({autohidemode: 'leave', cursorborder: '1px solid rgb(204, 204, 204)', cursorwidth:10, cursorcolor:'rgb(218, 218, 218)', railpadding:{top:0,right:5,left:0,bottom:0}});
        //$('.nicescroll-rails').eq(-1).css('marginTop',yyy+'px');    
      } else {
        th.find('.scroll-modal-body').css('overflowY','auto');
      }
    }
  });
  
  $('.pay-recept-selector input').change(function() {
    var word = $('.vyd').val() == 1 ? 'советов':'рецептов';
    if ($(this).val() == 1) {
      $(this).closest('.form-item').find('.help-block').text('Следуйте правилам добавления платных '+word+' для успешной проверки модератором и последующей оплаты. Укажите способ выплат в настройках вашего профиля, в разделе "Баланс".').show();
    } else {
      $(this).closest('.form-item').find('.help-block').text('Следуйте правилам добавления '+word+' для успешной проверки модератором.').show();
    }
    
    $.ajax({
      url: '/ajax',
      data: { save_recept_type: $(this).val(), item_id: $('.item_id').val(), vyd: $('.vyd').val() },
      type: 'post'      
    });
  });
  
  var word = $('.vyd').val() == 1 ? 'советов':'рецептов';
  if ( $('.pay-recept-selector .jq-radio.checked input').attr('value') == 1) {
      $('.pay-recept-selector').parent().find('.help-block').text('Следуйте правилам добавления платных '+word+' для успешной проверки модератором и последующей оплаты. Укажите способ выплат в настройках вашего профиля, в разделе "Баланс".').show();
  } else if ($('.pay-recept-selector .jq-radio.checked input').attr('value') == 0) {
      $('.pay-recept-selector').parent().find('.help-block').text('Следуйте правилам добавления '+word+' для успешной проверки модератором.').show();
  }
  
  $(document).on('click', '.foto_step .colorbox', function() {
      var th = $(this);
      $.ajax({
        url: '/modal',
        data: { modal: '#colorBox', image:$(this).attr('data-href'), num_step:$(this).attr('data-num_step'), text:$(this).attr('data-description'), vyd: $('.vyd').val() },
        type: 'post',
        success: function(ans) {   
          $('#colorBox').empty().append(ans);
          $('#colorBox').prepend(
            "<div class='prev-photo nav-photo' data-num_step='"+th.attr('data-num_step')+"'><img alt='' src='/images/chevron-left.png'></div>"+
            "<div class='next-photo nav-photo' data-num_step='"+th.attr('data-num_step')+"'><img alt='' src='/images/chevron-right.png'></div>"
          );
    
          var y = window.pageYOffset; // запоминаем текущую прокрутку сверху
          hideScroll(y);
          $('#colorBox').modal('show');
        }
      }); 
      
      return false;
  });
  
  var temp_photo_hide = false;
  
  $(document).on('click', '.message-colorbox, .comment-colorbox', function() {
      var th = $(this);
      $.ajax({
        url: '/modal',
        data: { modal: '#colorBox', image:$(this).attr('href'), text:$(this).attr('title') },
        type: 'post',
        success: function(ans) {   
          if (th.closest('#onePhotoBox').length) {
            //$('#onePhotoBox .scroll-modal-body').getNiceScroll().remove();
            $('#onePhotoBox').hide();
            temp_photo_hide = true;
          }
          $('#colorBox').empty().append(ans);
          $('#colorBox').prepend(
            "<div class='prev-photo nav-photo' ><img alt='' src='/images/chevron-left.png'></div>"+
            "<div class='next-photo nav-photo' ><img alt='' src='/images/chevron-right.png'></div>"
          );
    
          var y = window.pageYOffset; // запоминаем текущую прокрутку сверху
          hideScroll(y);
          $('#colorBox').modal('show');
        }
      }); 
      
      return false;
  });
  
  $('#colorBox').on( 'hidden.bs.modal', function() {
    
    if (temp_photo_hide) {
      $('#onePhotoBox').show();
      
    if ( !$('#onePhotoBox .scroll-modal-body').is(':hover') && !IS_TOUCH_DEVICE ) {
      $('#onePhotoBox .scroll-modal-body').mouseenter(function() {  
        //$('#onePhotoBox .scroll-modal-body').niceScroll({autohidemode: 'leave', cursorborder: '1px solid rgb(204, 204, 204)', cursorwidth:10, cursorcolor:'rgb(218, 218, 218)', railpadding:{top:0,right:5,left:0,bottom:0}});
        //$('.nicescroll-rails').eq(-1).css('marginTop',yyy+'px');
      });
    } else {
      if (!IS_TOUCH_DEVICE) {
        //$('#onePhotoBox .scroll-modal-body').niceScroll({autohidemode: 'leave', cursorborder: '1px solid rgb(204, 204, 204)', cursorwidth:10, cursorcolor:'rgb(218, 218, 218)', railpadding:{top:0,right:5,left:0,bottom:0}});
        //$('.nicescroll-rails').eq(-1).css('marginTop',yyy+'px');    
      } else {
        $('#onePhotoBox .scroll-modal-body').css('overflowY','auto');
      }
    }
      
      temp_photo_hide = false;
    }
  });
  
  $(document).on('click', '#colorBox .prev-photo, #colorBox .next-photo', function(event) {

    event.stopPropagation();
  
    if ($(this).attr('data-num_step')) {
    
      var num_step = $(this).attr('data-num_step');
    
      var cur = $('.recept-step-block[data-num_step='+num_step+']');
      var goal;
      if ($(this).hasClass('prev-photo')) goal = $('.recept-step-block[data-num_step='+(num_step*1-1)+']');
      else  goal = $('.recept-step-block[data-num_step='+(num_step*1+1)+']');

      if (goal.length != 0) {
    
      //$('#overflow').css('opacity','0.8').show();
     // $('.ajax-big-loader').show();
    
        goal = goal.find('.foto_step .colorbox');
        $.ajax({
          url: "/modal",
          method: "POST",
          data: {modal: '#colorBox', image:goal.attr('data-href'), num_step:goal.attr('data-num_step'), text:goal.attr('data-description'), vyd: $('.vyd').val() },
          success: function(ans) {  
            //showScroll();
            $('#colorBox').empty().append(ans);
            $('#colorBox').prepend(
              "<div class='prev-photo nav-photo' data-num_step='"+goal.attr('data-num_step')+"'><img alt='' src='/images/chevron-left.png'></div>"+
              "<div class='next-photo nav-photo' data-num_step='"+goal.attr('data-num_step')+"'><img alt='' src='/images/chevron-right.png'></div>"
            );
            //hideScroll();
          }
        }); 
      } else if ($(this).hasClass('next-photo')) {
        $('#colorBox').modal('hide');
      }
    } else {
      var where = '.message-colorbox';
      if ($('.comment-colorbox').length) {
        where = '.comment-colorbox';
      }
      var cur = $(where+'[href="'+$('#colorBox .single-photo').attr('src')+'"]');
      var ind = $(where).index(cur);
      //console.log($('#colorBox .single-photo').attr('href'),ind);
      var goal;
      if ($(this).hasClass('prev-photo')) goal = $(where).eq(ind-1);
      else  goal = $(where).eq(ind+1);

      if (goal.length != 0) {
    
        $.ajax({
          url: "/modal",
          method: "POST",
          data: {modal: '#colorBox', image:goal.attr('href'), text:goal.attr('title') },
          success: function(ans) {  
            $('#colorBox').empty().append(ans);
            $('#colorBox').prepend(
              "<div class='prev-photo nav-photo' ><img alt='' src='/images/chevron-left.png'></div>"+
              "<div class='next-photo nav-photo' ><img alt='' src='/images/chevron-right.png'></div>"
            );
          }
        }); 
      } else if ($(this).hasClass('next-photo')) {
        $('#colorBox').modal('hide');
      }
    }
    return false;
 }); 
 
  $('.ban-report-close').click(function() {
    if($(this).closest('.ban-report-fixed').length) {
      $('.ban-report-fixed').hide();
    } else {
        $.ajax({
          url: "/ajax",
          method: "POST",
          data: {ban_report_close: 1 },
          success: function(ans) {  
              $('.ban-report').remove();
          }
        });  
    }   
  });
  
  $('.admin-report-close').click(function() {
        
        var th = $(this);
   
        $.ajax({
          url: "/ajax",
          method: "POST",
          data: {admin_report_close: th.attr('admin_id') },
          success: function(ans) {  
              th.closest('.admin-message-profile-wrapper').remove();
          }
        });  
 
  });
  
  $('.read-more-desc').click(function() {
    if ($(this).text() == 'Читать далее') {
      $('.category-desc-inpage-part2').show();
      $(this).text('Свернуть');
    } else {
      $('.category-desc-inpage-part2').hide();
      $(this).text('Читать далее');
    }
    //$('html').getNiceScroll().resize();
  });
  
  $('.support-form textarea.required').focus(function() {
    $(this).css('borderColor', '#e5e5e5');
  });
  
  $('.support-form').submit(function() {
    var able = true;
    $('.support-form .required').each(function() {
      if ($(this).val() == '') {
        $(this).css('borderColor', 'red');
        able = false;
      }
    });
  
    if (!able) return false;
  });
 
 
  $(document).on('click', '.list-button-print-modal, .print-item', function() {
    //PrintElem ('#productListBox .modal-content', '#productListBox');

    $('.dropdown-menu-recept-comands-list').hide();
    $('.fail-action, .success-action').hide();

    var num_eazy = 0;
    $('.lazyload').each(function () {     
       $(this).attr('src', $(this).attr('data-src'));
       num_eazy++;
    });

    if (num_eazy > 0) {
      $('#overflow').css('opacity','0.8').show();
      $('.ajax-big-loader').show();
    }
    setTimeout( function() { 
       $('#overflow').css('opacity','1').hide();
       $('.ajax-big-loader').hide(); 
       window.print(); 
    }, num_eazy * 300 + 300);
  });
  
  
  
  var cat_nav_width = 0;
  $('.cat-nav .cat-button').each(function() {
    cat_nav_width += $(this).outerWidth(true)*1 + 1;
  });
  cat_nav_width += 1;
  cat_nav_width = Math.max(cat_nav_width, 1200);
  $('.cat-nav').css('width', cat_nav_width + 'px');
  
  
  if ( $('#scrollx-wrapper').outerWidth(true)*1 < cat_nav_width ) {
    $('.cat-nav-right').show();
  }  

  $('.cat-nav-right').click(function() {
    var oneicon = 76+56;
    var newscroll  = (Math.floor(($('#scrollx-wrapper').outerWidth(true)/2)/oneicon)+1) * oneicon;
    
    $('#scrollx-wrapper').animate( { scrollLeft: $('#scrollx-wrapper').scrollLeft()+newscroll }, 400 );
    $('.cat-nav-left').show();
    if ( $('#scrollx-wrapper').scrollLeft() >= cat_nav_width - $('#scrollx-wrapper').outerWidth(true)*1 ) {
      $('.cat-nav-right').hide();
    }
  });
 
  $('.cat-nav-left').click(function() {
  
    var oneicon = 76+56;
    var newscroll  = (Math.floor(($('#scrollx-wrapper').outerWidth(true)/2)/oneicon)+1) * oneicon;
    
    $('#scrollx-wrapper').animate( { scrollLeft: Math.max( 0, $('#scrollx-wrapper').scrollLeft()-newscroll) }, 400 );
    $('.cat-nav-right').show();
    if ($('#scrollx-wrapper').scrollLeft() == 0) {
      $('.cat-nav-left').hide();
    }
  }); 
  
  $('#scrollx-wrapper').scroll(function() {
    if ( $('#scrollx-wrapper').scrollLeft() >= cat_nav_width - $('#scrollx-wrapper').outerWidth(true)*1 ) {
      $('.cat-nav-right').hide();
    } else {
      if ( $('#scrollx-wrapper').outerWidth(true)*1 < cat_nav_width ) {
         $('.cat-nav-right').show();
      }     
    }
    if ($('#scrollx-wrapper').scrollLeft() == 0) {
      $('.cat-nav-left').hide();
    } else {
      if ( $('#scrollx-wrapper').outerWidth(true)*1 < cat_nav_width ) {
         $('.cat-nav-left').show();
      }    
    }
  });
  
  
    
    
  $(document).on('keyup', '.measure-quantity', function(){

    var regexp = /[а-яa-z\s]+$/gi;

    if ( regexp.test( $(this).val() ) ) {
      $(this).val('');
              $('.fail-action span').text('Буквы и пробелы недопустимы');
              $('.fail-action').show();
              setTimeout( function() {
                $('.fail-action').fadeOut('slow');
              }, 4000);
    }  
  
  });
  
  $(document).on('click', '.rotaion-buttons img', function() {
    
    var direction = $(this).hasClass('rotation-left') ? 'left':'right';
    var bl = $(this).parent().parent();
    var image = bl.find('input[type=hidden]').val();
    
    var th = $(this);
    var src = th.attr('src');
    th.attr('src', '/images/loader_showmore.gif');
    
    $.ajax({
      url: "/ajax",
      method: "POST",    
      data: {rotate_image:image, direction:direction},
      success: function (ans) {    

        var img = new Image;
        img.src = ans;

        img.onload = function () {
          var bgImgWidth = img.width;
          var bgImgHeight = img.height;
          var width = bl.width();
                
          bl.css('height', width*bgImgHeight/bgImgWidth + 'px'); 
          bl.css('backgroundImage', 'url('+ans+')');
          bl.find('.dropzone').css('height', width*bgImgHeight/bgImgWidth + 'px');
          bl.find('.dropzone-step').css('height', width*bgImgHeight/bgImgWidth + 'px');
          
          th.attr('src', src);
          
          var nf = ans.split('/');
          nf = nf[nf.length - 1];
          bl.find('input.required[type=hidden]').val(nf);
        } 

      }
    });
  
  });
  
  
  $('.dropzone, .dropzone-step').each(function () {
    
    var bl = $(this).parent();
    
    if (bl.css('backgroundImage') == 'none') {
      return;
    }
    
    var img = new Image;
    img.src = bl.css('backgroundImage').slice(5, -2);
    
    var th = $(this);
    img.onload = function () {
      var bgImgWidth = img.width;
      var bgImgHeight = img.height;
      var width = bl.width();
                
      bl.css('height', width*bgImgHeight/bgImgWidth + 'px'); 
      th.css('height', width*bgImgHeight/bgImgWidth + 'px');
      
      bl.find('.rotaion-buttons').show();
    } 
  });
  
  
  $(document).on('click', '#allGroupMembers .modal-title-tab:not(.active)', function() {
  
    var nt = $(this).attr('num_tab');
    
    $('#allGroupMembers .modal-title-tab').removeClass('active');
    $(this).addClass('active');
    
    $('#allGroupMembers .tab-content').removeClass('active');
    $('#allGroupMembers .tab-content-'+nt).addClass('active');
    
    //$('.modal-body').getNiceScroll().resize(); 
  });
  
  
  $(document).on('keyup', '#allGroupMembers .member-list-search input', function() {
    if ( $(this).val() == '' ) {
      $('#allGroupMembers .act-user-group').show();
    } else {
      $('#allGroupMembers .act-user-group').hide();
      $('#allGroupMembers .act-user-group[username*="'+$(this).val().toLowerCase()+'"]').show();
    }
  });

  $(document).on('mouseenter', '.hint-block .hint-button', function() {
    
    $('.hint-block .hint-text').show();
    $(this).css('backgroundImage', 'url(/images/hint-hover.png)');

  });

  $(document).on('mouseleave', '.hint-block .hint-button', function() {
    
    $('.hint-block .hint-text').hide();
    $(this).css('backgroundImage', 'url(/images/hint-normal.png)');

  });

  
  $('.support-form input, .support-form textarea').keyup(function() {
    if ($(this).val() != '') {
      $(this).parent().find('.empty-input').show();
    } else {
      $(this).parent().find('.empty-input').hide();
    }
  });
  
  $('.empty-input').click(function() {
     $(this).parent().find('input, textarea').val('').focus();
     $(this).hide();
  });    
  
  var error_index = 0;
  
  $(document).on('click', '.form-error-finish', function() {
    var scrollTop = $('.required-error').eq(0).offset().top;
    $(document).scrollTop(scrollTop);
    error_index = 1;
  });  
  
  $(document).on('click', '.form-error:not(.form-error-finish)', function() {
    $('#receptBox .modal-body').scrollTop(0);
    var scrollTop = $('.required-error').eq(error_index).offset().top;
    $(document).scrollTop(scrollTop);
    error_index++;
  });       
              
  
  $(document).on('click','.end-of-edit', function() {
    document.location.href = $(this).attr('href');
    return false
  });
  
  $('.back-to-top').click(function() {
    $('html').scrollTop(0);
    $('.back-to-top').hide();
  });
  
  
  var is_safari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
  if ( is_safari && document.body.clientWidth > 768 ) {
    $('.recept-list-page .car-uname').css('verticalAlign','4px');
  }
  if ( is_safari ) {
    $('.flag-throbber.submit_izbr_form').css('verticalAlign','5px');
  }

  $('#overflow').hide();
  $('.filter-block').show();
  
  setTimeout( function() {
    $('.fail-action, .success-action').fadeOut('slow');
  }, 4000);
  
    document.ondragstart = function() {
      return false;
    }
    
   function PrintElem(elem, parent) {
     Popup($(elem).html(), parent);
   }
   function Popup(data, parent) {
     var mywindow = window.open('', 'my div', 'height=400,width=600');
     mywindow.document.write('<html><head><title>Список покупок</title><link href="/assets/b91b9219/css/bootstrap.css" rel="stylesheet"><link href="/css/site.css" rel="stylesheet">');
     mywindow.document.write('<style>.not-for-print{display:none;}.only-for-print{display:block;}</style>');
     mywindow.document.write('</head><body id="'+parent+'" style="background:#fff;">');
     mywindow.document.write(data);
     mywindow.document.write('</body></html>');
     mywindow.document.close(); // necessary for IE >= 10
     mywindow.focus(); // necessary for IE >= 10
     mywindow.onload = function() {
       mywindow.print();
       mywindow.close();
     }
     return true;
   } 
   
   $(document).on('keyup', '.newrecept-name', function(){
   
     var min_h = $(this).hasClass('theme-name-edit') ? 32 : 44;
	   $(this).css('height', min_h + 'px'); // min-height
	 
	   var h = this.scrollHeight < min_h ? min_h:this.scrollHeight;
	 
	   //console.log(this.scrollHeight, h);
	   $(this).css('height', h+'px');
	 
	   //$('.modal-body').getNiceScroll().resize(); 

   });

   $('.newrecept-name').keyup();
   
   $('.phone-inputmask').mask("+7 (999) 999 99 99");

   if ( $('.need_load_favorite_info').length ) {
     var recepts = [];
     var vyd;
     $('.need_load_favorite_info').each(function(){
      recepts.push($(this).attr('data-recept_id'));
      vyd = $(this).attr('data-vyd');
     });
     $.ajax({
       url: "/ajax",
       method: "POST",    
       data: { need_load_favorite_info:recepts, vyd:vyd },
       success: function (ans) { 
         ans = JSON.parse (ans);
         console.log(ans);
         $('.need_load_favorite_info').each(function(){
           $(this).attr('data-bookname', ans.bname);
           $(this).attr('data-book', ans.bid);
           if (ans.counts[$(this).attr('data-recept_id')] != 0) {
             $(this).attr('data-count', ans.counts[$(this).attr('data-recept_id')] );
             $(this).removeClass('fa-star-o').addClass('fa-star')
           } else {
             $(this).attr('title', 'Добавить в ' + ans.bname).addClass('submit_izbr_form').addClass('total-reload');
           }
         });
         //for (var key in o) {
       }
      });
   }


  
  setInterval (function(){
    if ($(document).width() > 767 ) {
      var lch = $('.content-unofeflow-column').height();
      $('.sidebar-unofeflow-column').height(lch);
    } else {
      $('.sidebar-unofeflow-column').css('height', 'auto');
    }
  }, 2000)
  
   
    
});

</script>



<!-- Rating Mail.ru counter -->
<script type="text/javascript">
var _tmr = window._tmr || (window._tmr = []);
_tmr.push({id: "3160041", type: "pageView", start: (new Date()).getTime()});
(function (d, w, id) {
  if (d.getElementById(id)) return;
  var ts = d.createElement("script"); ts.type = "text/javascript"; ts.async = true; ts.id = id;
  ts.src = "https://top-fwz1.mail.ru/js/code.js";
  var f = function () {var s = d.getElementsByTagName("script")[0]; s.parentNode.insertBefore(ts, s);};
  if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); }
})(document, window, "topmailru-code");
</script><noscript><div>
<img src="https://top-fwz1.mail.ru/counter?id=3160041;js=na" style="border:0;position:absolute;left:-9999px;" alt="Top.Mail.Ru" />
</div></noscript>
<!-- //Rating Mail.ru counter -->




<div><div class="grecaptcha-badge" data-style="bottomright" style="width: 256px; height: 60px; position: fixed; visibility: hidden; display: block; transition: right 0.3s ease 0s; bottom: 14px; right: -186px; box-shadow: gray 0px 0px 5px; border-radius: 2px; overflow: hidden;"><div class="grecaptcha-logo"><iframe title="reCAPTCHA" src="https://www.google.com/recaptcha/api2/anchor?ar=1&amp;k=6Le4PNsUAAAAAFgraWD8EGN7p76X4Qv3oxfrxfiM&amp;co=aHR0cHM6Ly9ueWFta2luLnJ1OjQ0Mw..&amp;hl=en&amp;v=tNAc29ZZrpcOCErva2nr4BS9&amp;size=invisible&amp;cb=6q0vdbkhd0ev" role="presentation" name="a-3kfzojehl55" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox allow-storage-access-by-user-activation" width="256" height="60" frameborder="0"></iframe></div><div class="grecaptcha-error"></div><textarea id="g-recaptcha-response-100000" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div><iframe style="display: none;"></iframe></div></body></html>